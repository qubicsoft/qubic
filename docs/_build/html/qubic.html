<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qubic package &mdash; Qubicsoft 5.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=ee801c84"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Qubicsoft
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">qubic package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-qubic.AnalysisMC">qubic.AnalysisMC module</a><ul>
<li><a class="reference internal" href="#qubic.AnalysisMC.Cp2Cp_prime"><code class="docutils literal notranslate"><span class="pre">Cp2Cp_prime()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.Cp2Cp_prime_viaCorr"><code class="docutils literal notranslate"><span class="pre">Cp2Cp_prime_viaCorr()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.average_pix_sig2"><code class="docutils literal notranslate"><span class="pre">average_pix_sig2()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.cov2corr"><code class="docutils literal notranslate"><span class="pre">cov2corr()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.covariance_IQU_subbands"><code class="docutils literal notranslate"><span class="pre">covariance_IQU_subbands()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.distance_square"><code class="docutils literal notranslate"><span class="pre">distance_square()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.distance_sup"><code class="docutils literal notranslate"><span class="pre">distance_sup()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_Cp"><code class="docutils literal notranslate"><span class="pre">get_Cp()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_corrections"><code class="docutils literal notranslate"><span class="pre">get_corrections()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_covcorr1pix"><code class="docutils literal notranslate"><span class="pre">get_covcorr1pix()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_covcorr_between_pix"><code class="docutils literal notranslate"><span class="pre">get_covcorr_between_pix()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_covcorr_patch"><code class="docutils literal notranslate"><span class="pre">get_covcorr_patch()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_mean_cov"><code class="docutils literal notranslate"><span class="pre">get_mean_cov()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_residuals"><code class="docutils literal notranslate"><span class="pre">get_residuals()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_rms_covar"><code class="docutils literal notranslate"><span class="pre">get_rms_covar()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_rms_covarmean"><code class="docutils literal notranslate"><span class="pre">get_rms_covarmean()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.get_weighted_correlation_average"><code class="docutils literal notranslate"><span class="pre">get_weighted_correlation_average()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.make_weighted_av"><code class="docutils literal notranslate"><span class="pre">make_weighted_av()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.plot_hist"><code class="docutils literal notranslate"><span class="pre">plot_hist()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.rms_method"><code class="docutils literal notranslate"><span class="pre">rms_method()</span></code></a></li>
<li><a class="reference internal" href="#qubic.AnalysisMC.std_profile"><code class="docutils literal notranslate"><span class="pre">std_profile()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic-datahandling-module">qubic.DataHandling module</a></li>
<li><a class="reference internal" href="#module-qubic.NamasterLib">qubic.NamasterLib module</a><ul>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster"><code class="docutils literal notranslate"><span class="pre">Namaster</span></code></a><ul>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.bin_spectra"><code class="docutils literal notranslate"><span class="pre">Namaster.bin_spectra()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.compute_master"><code class="docutils literal notranslate"><span class="pre">Namaster.compute_master()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_apodized_mask"><code class="docutils literal notranslate"><span class="pre">Namaster.get_apodized_mask()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_binning"><code class="docutils literal notranslate"><span class="pre">Namaster.get_binning()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_covariance_BB_BB"><code class="docutils literal notranslate"><span class="pre">Namaster.get_covariance_BB_BB()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_covariance_EE_EE"><code class="docutils literal notranslate"><span class="pre">Namaster.get_covariance_EE_EE()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_covariance_TE_TE"><code class="docutils literal notranslate"><span class="pre">Namaster.get_covariance_TE_TE()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_covariance_TT_TT"><code class="docutils literal notranslate"><span class="pre">Namaster.get_covariance_TT_TT()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_covariance_coeff"><code class="docutils literal notranslate"><span class="pre">Namaster.get_covariance_coeff()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_fields"><code class="docutils literal notranslate"><span class="pre">Namaster.get_fields()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_pixwin_correction"><code class="docutils literal notranslate"><span class="pre">Namaster.get_pixwin_correction()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.get_spectra"><code class="docutils literal notranslate"><span class="pre">Namaster.get_spectra()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.knox_covariance"><code class="docutils literal notranslate"><span class="pre">Namaster.knox_covariance()</span></code></a></li>
<li><a class="reference internal" href="#qubic.NamasterLib.Namaster.knox_errors"><code class="docutils literal notranslate"><span class="pre">Namaster.knox_errors()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.QubicSkySim">qubic.QubicSkySim module</a><ul>
<li><a class="reference internal" href="#qubic.QubicSkySim.Qubic_sky"><code class="docutils literal notranslate"><span class="pre">Qubic_sky</span></code></a><ul>
<li><a class="reference internal" href="#qubic.QubicSkySim.Qubic_sky.create_noise_maps"><code class="docutils literal notranslate"><span class="pre">Qubic_sky.create_noise_maps()</span></code></a></li>
<li><a class="reference internal" href="#qubic.QubicSkySim.Qubic_sky.get_fullsky_convolved_maps"><code class="docutils literal notranslate"><span class="pre">Qubic_sky.get_fullsky_convolved_maps()</span></code></a></li>
<li><a class="reference internal" href="#qubic.QubicSkySim.Qubic_sky.get_partial_sky_maps_withnoise"><code class="docutils literal notranslate"><span class="pre">Qubic_sky.get_partial_sky_maps_withnoise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.QubicSkySim.Qubic_sky.smoothing"><code class="docutils literal notranslate"><span class="pre">Qubic_sky.smoothing()</span></code></a></li>
<li><a class="reference internal" href="#qubic.QubicSkySim.Qubic_sky.theoretical_noise_maps"><code class="docutils literal notranslate"><span class="pre">Qubic_sky.theoretical_noise_maps()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.QubicSkySim.sky"><code class="docutils literal notranslate"><span class="pre">sky</span></code></a><ul>
<li><a class="reference internal" href="#qubic.QubicSkySim.sky.get_simple_sky_map"><code class="docutils literal notranslate"><span class="pre">sky.get_simple_sky_map()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.ReadMC">qubic.ReadMC module</a><ul>
<li><a class="reference internal" href="#qubic.ReadMC.get_maps"><code class="docutils literal notranslate"><span class="pre">get_maps()</span></code></a></li>
<li><a class="reference internal" href="#qubic.ReadMC.get_maps_many_files"><code class="docutils literal notranslate"><span class="pre">get_maps_many_files()</span></code></a></li>
<li><a class="reference internal" href="#qubic.ReadMC.get_patch"><code class="docutils literal notranslate"><span class="pre">get_patch()</span></code></a></li>
<li><a class="reference internal" href="#qubic.ReadMC.get_patch_many_files"><code class="docutils literal notranslate"><span class="pre">get_patch_many_files()</span></code></a></li>
<li><a class="reference internal" href="#qubic.ReadMC.get_seenmap"><code class="docutils literal notranslate"><span class="pre">get_seenmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.ReadMC.make_zones"><code class="docutils literal notranslate"><span class="pre">make_zones()</span></code></a></li>
<li><a class="reference internal" href="#qubic.ReadMC.pix2ang"><code class="docutils literal notranslate"><span class="pre">pix2ang()</span></code></a></li>
<li><a class="reference internal" href="#qubic.ReadMC.save_simu_fits"><code class="docutils literal notranslate"><span class="pre">save_simu_fits()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.SpectroImLib">qubic.SpectroImLib module</a><ul>
<li><a class="reference internal" href="#qubic.SpectroImLib.create_TOD"><code class="docutils literal notranslate"><span class="pre">create_TOD()</span></code></a></li>
<li><a class="reference internal" href="#qubic.SpectroImLib.create_acquisition_operator_REC"><code class="docutils literal notranslate"><span class="pre">create_acquisition_operator_REC()</span></code></a></li>
<li><a class="reference internal" href="#qubic.SpectroImLib.create_acquisition_operator_TOD"><code class="docutils literal notranslate"><span class="pre">create_acquisition_operator_TOD()</span></code></a></li>
<li><a class="reference internal" href="#qubic.SpectroImLib.get_hitmap"><code class="docutils literal notranslate"><span class="pre">get_hitmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.SpectroImLib.reconstruct_maps"><code class="docutils literal notranslate"><span class="pre">reconstruct_maps()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic-spectroimlib-pysm2-module">qubic.SpectroImLib_PySM2 module</a></li>
<li><a class="reference internal" href="#module-qubic.TES_evaluation">qubic.TES_evaluation module</a><ul>
<li><a class="reference internal" href="#qubic.TES_evaluation.check_goodbad"><code class="docutils literal notranslate"><span class="pre">check_goodbad()</span></code></a></li>
<li><a class="reference internal" href="#qubic.TES_evaluation.get_header_values"><code class="docutils literal notranslate"><span class="pre">get_header_values()</span></code></a></li>
<li><a class="reference internal" href="#qubic.TES_evaluation.list_goodbad"><code class="docutils literal notranslate"><span class="pre">list_goodbad()</span></code></a></li>
<li><a class="reference internal" href="#qubic.TES_evaluation.read_goodbad"><code class="docutils literal notranslate"><span class="pre">read_goodbad()</span></code></a></li>
<li><a class="reference internal" href="#qubic.TES_evaluation.write_goodbad"><code class="docutils literal notranslate"><span class="pre">write_goodbad()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.acquisition">qubic.acquisition module</a><ul>
<li><a class="reference internal" href="#qubic.acquisition.PlanckAcquisition"><code class="docutils literal notranslate"><span class="pre">PlanckAcquisition</span></code></a><ul>
<li><a class="reference internal" href="#qubic.acquisition.PlanckAcquisition.get_invntt_operator"><code class="docutils literal notranslate"><span class="pre">PlanckAcquisition.get_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.PlanckAcquisition.get_noise"><code class="docutils literal notranslate"><span class="pre">PlanckAcquisition.get_noise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.PlanckAcquisition.get_observation"><code class="docutils literal notranslate"><span class="pre">PlanckAcquisition.get_observation()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.PlanckAcquisition.get_operator"><code class="docutils literal notranslate"><span class="pre">PlanckAcquisition.get_operator()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition</span></code></a><ul>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_add_grids_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_add_grids_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_aperture_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_aperture_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_convolution_peak_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_convolution_peak_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_coverage"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_coverage()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_detector_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_detector_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_detector_response_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_detector_response_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_diag_invntt_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_diag_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_distribution_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_distribution_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_filter_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_filter_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_hitmap"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_hitmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_hwp_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_hwp_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_invntt_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_noise"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_noise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_observation"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_observation()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_polarizer_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_polarizer_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_preconditioner"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_preconditioner()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_projection_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_projection_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_subtract_grids_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_subtract_grids_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.get_unit_conversion_operator"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.get_unit_conversion_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicAcquisition.tod2map"><code class="docutils literal notranslate"><span class="pre">QubicAcquisition.tod2map()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.acquisition.QubicPlanckAcquisition"><code class="docutils literal notranslate"><span class="pre">QubicPlanckAcquisition</span></code></a><ul>
<li><a class="reference internal" href="#qubic.acquisition.QubicPlanckAcquisition.get_invntt_operator"><code class="docutils literal notranslate"><span class="pre">QubicPlanckAcquisition.get_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicPlanckAcquisition.get_noise"><code class="docutils literal notranslate"><span class="pre">QubicPlanckAcquisition.get_noise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicPlanckAcquisition.get_observation"><code class="docutils literal notranslate"><span class="pre">QubicPlanckAcquisition.get_observation()</span></code></a></li>
<li><a class="reference internal" href="#qubic.acquisition.QubicPlanckAcquisition.get_operator"><code class="docutils literal notranslate"><span class="pre">QubicPlanckAcquisition.get_operator()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.beams">qubic.beams module</a><ul>
<li><a class="reference internal" href="#qubic.beams.BeamFitted"><code class="docutils literal notranslate"><span class="pre">BeamFitted</span></code></a></li>
<li><a class="reference internal" href="#qubic.beams.BeamGaussian"><code class="docutils literal notranslate"><span class="pre">BeamGaussian</span></code></a></li>
<li><a class="reference internal" href="#qubic.beams.MultiFreqBeam"><code class="docutils literal notranslate"><span class="pre">MultiFreqBeam</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.calibration">qubic.calibration module</a><ul>
<li><a class="reference internal" href="#qubic.calibration.QubicCalibration"><code class="docutils literal notranslate"><span class="pre">QubicCalibration</span></code></a><ul>
<li><a class="reference internal" href="#qubic.calibration.QubicCalibration.get"><code class="docutils literal notranslate"><span class="pre">QubicCalibration.get()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.camb_interface">qubic.camb_interface module</a><ul>
<li><a class="reference internal" href="#qubic.camb_interface.Dl2Cl_without_monopole"><code class="docutils literal notranslate"><span class="pre">Dl2Cl_without_monopole()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.bin_camblib"><code class="docutils literal notranslate"><span class="pre">bin_camblib()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.cell_2_ctheta"><code class="docutils literal notranslate"><span class="pre">cell_2_ctheta()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.ctheta_2_cell"><code class="docutils literal notranslate"><span class="pre">ctheta_2_cell()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.get_Dl_fromlib"><code class="docutils literal notranslate"><span class="pre">get_Dl_fromlib()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.get_camb_Dl"><code class="docutils literal notranslate"><span class="pre">get_camb_Dl()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.rcamblib"><code class="docutils literal notranslate"><span class="pre">rcamblib()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.read_camblib"><code class="docutils literal notranslate"><span class="pre">read_camblib()</span></code></a></li>
<li><a class="reference internal" href="#qubic.camb_interface.simulate_correlated_map"><code class="docutils literal notranslate"><span class="pre">simulate_correlated_map()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.cl">qubic.cl module</a><ul>
<li><a class="reference internal" href="#qubic.cl.camb_spectra"><code class="docutils literal notranslate"><span class="pre">camb_spectra()</span></code></a></li>
<li><a class="reference internal" href="#qubic.cl.plot_spectra"><code class="docutils literal notranslate"><span class="pre">plot_spectra()</span></code></a></li>
<li><a class="reference internal" href="#qubic.cl.read_spectra"><code class="docutils literal notranslate"><span class="pre">read_spectra()</span></code></a></li>
<li><a class="reference internal" href="#qubic.cl.semilogy_spectra"><code class="docutils literal notranslate"><span class="pre">semilogy_spectra()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.compact_sources_sed">qubic.compact_sources_sed module</a><ul>
<li><a class="reference internal" href="#qubic.compact_sources_sed.build_catalog"><code class="docutils literal notranslate"><span class="pre">build_catalog()</span></code></a></li>
<li><a class="reference internal" href="#qubic.compact_sources_sed.build_name"><code class="docutils literal notranslate"><span class="pre">build_name()</span></code></a></li>
<li><a class="reference internal" href="#qubic.compact_sources_sed.build_sed"><code class="docutils literal notranslate"><span class="pre">build_sed()</span></code></a></li>
<li><a class="reference internal" href="#qubic.compact_sources_sed.build_sed_allfreqs"><code class="docutils literal notranslate"><span class="pre">build_sed_allfreqs()</span></code></a></li>
<li><a class="reference internal" href="#qubic.compact_sources_sed.duplicate_source"><code class="docutils literal notranslate"><span class="pre">duplicate_source()</span></code></a></li>
<li><a class="reference internal" href="#qubic.compact_sources_sed.isincatalog"><code class="docutils literal notranslate"><span class="pre">isincatalog()</span></code></a></li>
<li><a class="reference internal" href="#qubic.compact_sources_sed.name2cat"><code class="docutils literal notranslate"><span class="pre">name2cat()</span></code></a></li>
<li><a class="reference internal" href="#qubic.compact_sources_sed.source2freqs"><code class="docutils literal notranslate"><span class="pre">source2freqs()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.demodulation_lib">qubic.demodulation_lib module</a><ul>
<li><a class="reference internal" href="#qubic.demodulation_lib.CalSrcPowerMeterResponse_Vs_Nu"><code class="docutils literal notranslate"><span class="pre">CalSrcPowerMeterResponse_Vs_Nu()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.CalSrcPower_Vs_Nu"><code class="docutils literal notranslate"><span class="pre">CalSrcPower_Vs_Nu()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.MySpl"><code class="docutils literal notranslate"><span class="pre">MySpl</span></code></a><ul>
<li><a class="reference internal" href="#qubic.demodulation_lib.MySpl.get_spline"><code class="docutils literal notranslate"><span class="pre">MySpl.get_spline()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.demodulation_lib.SimSrcTOD"><code class="docutils literal notranslate"><span class="pre">SimSrcTOD</span></code></a><ul>
<li><a class="reference internal" href="#qubic.demodulation_lib.SimSrcTOD.amplitude"><code class="docutils literal notranslate"><span class="pre">SimSrcTOD.amplitude()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.SimSrcTOD.offset"><code class="docutils literal notranslate"><span class="pre">SimSrcTOD.offset()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.SimSrcTOD.phase"><code class="docutils literal notranslate"><span class="pre">SimSrcTOD.phase()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.demodulation_lib.array_info"><code class="docutils literal notranslate"><span class="pre">array_info()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.bin_image_elscans"><code class="docutils literal notranslate"><span class="pre">bin_image_elscans()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.bin_per_period"><code class="docutils literal notranslate"><span class="pre">bin_per_period()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.coadd_flatmap"><code class="docutils literal notranslate"><span class="pre">coadd_flatmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.dB"><code class="docutils literal notranslate"><span class="pre">dB()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.demodulate_JC"><code class="docutils literal notranslate"><span class="pre">demodulate_JC()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.demodulate_directory"><code class="docutils literal notranslate"><span class="pre">demodulate_directory()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.demodulate_methods"><code class="docutils literal notranslate"><span class="pre">demodulate_methods()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.demodulate_old"><code class="docutils literal notranslate"><span class="pre">demodulate_old()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.fit_ang_gauss"><code class="docutils literal notranslate"><span class="pre">fit_ang_gauss()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.fit_sb"><code class="docutils literal notranslate"><span class="pre">fit_sb()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.fit_sb_asym"><code class="docutils literal notranslate"><span class="pre">fit_sb_asym()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.fitperiod"><code class="docutils literal notranslate"><span class="pre">fitperiod()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.flattened_qubic_sb_model"><code class="docutils literal notranslate"><span class="pre">flattened_qubic_sb_model()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.flattened_qubic_sb_model_asym"><code class="docutils literal notranslate"><span class="pre">flattened_qubic_sb_model_asym()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.gauss"><code class="docutils literal notranslate"><span class="pre">gauss()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.gauss_line"><code class="docutils literal notranslate"><span class="pre">gauss_line()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.general_demodulate"><code class="docutils literal notranslate"><span class="pre">general_demodulate()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.get_spectral_response"><code class="docutils literal notranslate"><span class="pre">get_spectral_response()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.hf_noise_estimate"><code class="docutils literal notranslate"><span class="pre">hf_noise_estimate()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.hwp_fitpol"><code class="docutils literal notranslate"><span class="pre">hwp_fitpol()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.hwp_fitpol_MCMC"><code class="docutils literal notranslate"><span class="pre">hwp_fitpol_MCMC()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.hwp_sin"><code class="docutils literal notranslate"><span class="pre">hwp_sin()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.hwp_sin_sat"><code class="docutils literal notranslate"><span class="pre">hwp_sin_sat()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.interp_template"><code class="docutils literal notranslate"><span class="pre">interp_template</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.make_tod"><code class="docutils literal notranslate"><span class="pre">make_tod()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.mygauss2d"><code class="docutils literal notranslate"><span class="pre">mygauss2d()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.printnow"><code class="docutils literal notranslate"><span class="pre">printnow()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.qubic_sb_model"><code class="docutils literal notranslate"><span class="pre">qubic_sb_model()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.qubic_sb_model_asym"><code class="docutils literal notranslate"><span class="pre">qubic_sb_model_asym()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.read_cal_src_data"><code class="docutils literal notranslate"><span class="pre">read_cal_src_data()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.read_data_azel_src"><code class="docutils literal notranslate"><span class="pre">read_data_azel_src()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.renorm"><code class="docutils literal notranslate"><span class="pre">renorm()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.return_fit_period"><code class="docutils literal notranslate"><span class="pre">return_fit_period()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.return_rms_period"><code class="docutils literal notranslate"><span class="pre">return_rms_period()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.scan2ang_RMS"><code class="docutils literal notranslate"><span class="pre">scan2ang_RMS()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.scan2ang_demod"><code class="docutils literal notranslate"><span class="pre">scan2ang_demod()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.scan2ang_splfit"><code class="docutils literal notranslate"><span class="pre">scan2ang_splfit()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.scan2hpmap"><code class="docutils literal notranslate"><span class="pre">scan2hpmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.demodulation_lib.sigmoid_saturation"><code class="docutils literal notranslate"><span class="pre">sigmoid_saturation()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.fibtools">qubic.fibtools module</a><ul>
<li><a class="reference internal" href="#qubic.fibtools.Chi2Implement"><code class="docutils literal notranslate"><span class="pre">Chi2Implement</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.Chi2Minimizer"><code class="docutils literal notranslate"><span class="pre">Chi2Minimizer</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.MyChi2"><code class="docutils literal notranslate"><span class="pre">MyChi2</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.MyChi2_nocov"><code class="docutils literal notranslate"><span class="pre">MyChi2_nocov</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.butter_bandpass"><code class="docutils literal notranslate"><span class="pre">butter_bandpass()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.butter_bandpass_filter"><code class="docutils literal notranslate"><span class="pre">butter_bandpass_filter()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.calibrate"><code class="docutils literal notranslate"><span class="pre">calibrate()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.do_minuit"><code class="docutils literal notranslate"><span class="pre">do_minuit()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.exponential_filter1d"><code class="docutils literal notranslate"><span class="pre">exponential_filter1d()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.filter_data"><code class="docutils literal notranslate"><span class="pre">filter_data()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.fit_all"><code class="docutils literal notranslate"><span class="pre">fit_all()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.fit_average"><code class="docutils literal notranslate"><span class="pre">fit_average()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.fold_data"><code class="docutils literal notranslate"><span class="pre">fold_data()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.image_asics"><code class="docutils literal notranslate"><span class="pre">image_asics()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.isfloat"><code class="docutils literal notranslate"><span class="pre">isfloat()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.meancut"><code class="docutils literal notranslate"><span class="pre">meancut()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.notch_array"><code class="docutils literal notranslate"><span class="pre">notch_array()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.notch_filter"><code class="docutils literal notranslate"><span class="pre">notch_filter()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.power_spectrum"><code class="docutils literal notranslate"><span class="pre">power_spectrum()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.printnow"><code class="docutils literal notranslate"><span class="pre">printnow()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.profile"><code class="docutils literal notranslate"><span class="pre">profile()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.qgrid"><code class="docutils literal notranslate"><span class="pre">qgrid()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.qs2array"><code class="docutils literal notranslate"><span class="pre">qs2array()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.read_hkintern"><code class="docutils literal notranslate"><span class="pre">read_hkintern()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.run_asic"><code class="docutils literal notranslate"><span class="pre">run_asic()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.simsig"><code class="docutils literal notranslate"><span class="pre">simsig()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.simsig_asym"><code class="docutils literal notranslate"><span class="pre">simsig_asym()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.simsig_fringes"><code class="docutils literal notranslate"><span class="pre">simsig_fringes()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.simsig_nonorm"><code class="docutils literal notranslate"><span class="pre">simsig_nonorm()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.statstr"><code class="docutils literal notranslate"><span class="pre">statstr()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.thepolynomial"><code class="docutils literal notranslate"><span class="pre">thepolynomial()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.vec_interp"><code class="docutils literal notranslate"><span class="pre">vec_interp()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fibtools.weighted_mean"><code class="docutils literal notranslate"><span class="pre">weighted_mean()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.fringes_lib">qubic.fringes_lib module</a><ul>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis</span></code></a><ul>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.analyse_fringes"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.analyse_fringes()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.average_over_cycles_oneTES"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.average_over_cycles_oneTES()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.average_over_points_oneTES"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.average_over_points_oneTES()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.find_high_derivative_clusters"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.find_high_derivative_clusters()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.find_right_period"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.find_right_period()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.find_t0"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.find_t0()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.make_mask_bad_tes"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.make_mask_bad_tes()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.plot_TOD"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.plot_TOD()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.plot_average_over_steps"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.plot_average_over_steps()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.remove_median_allh"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.remove_median_allh()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.remove_slope_allcycles"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.remove_slope_allcycles()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.remove_slope_percycle"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.remove_slope_percycle()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.resample_fold_oneTES"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.resample_fold_oneTES()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.roll_oneTES"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.roll_oneTES()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.FringesAnalysis.sort_TES_good2bad"><code class="docutils literal notranslate"><span class="pre">FringesAnalysis.sort_TES_good2bad()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.fringes_lib.SaveFringesFitsPdf"><code class="docutils literal notranslate"><span class="pre">SaveFringesFitsPdf</span></code></a><ul>
<li><a class="reference internal" href="#qubic.fringes_lib.SaveFringesFitsPdf.save_fringes_pdf_plots"><code class="docutils literal notranslate"><span class="pre">SaveFringesFitsPdf.save_fringes_pdf_plots()</span></code></a></li>
<li><a class="reference internal" href="#qubic.fringes_lib.SaveFringesFitsPdf.write_fits_fringes"><code class="docutils literal notranslate"><span class="pre">SaveFringesFitsPdf.write_fits_fringes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.horns">qubic.horns module</a></li>
<li><a class="reference internal" href="#module-qubic.insert_point_sources_in_sky">qubic.insert_point_sources_in_sky module</a><ul>
<li><a class="reference internal" href="#qubic.insert_point_sources_in_sky.Jansky_invsr_to_K_CMB"><code class="docutils literal notranslate"><span class="pre">Jansky_invsr_to_K_CMB()</span></code></a></li>
<li><a class="reference internal" href="#qubic.insert_point_sources_in_sky.add_sources_to_sky_map"><code class="docutils literal notranslate"><span class="pre">add_sources_to_sky_map()</span></code></a></li>
<li><a class="reference internal" href="#qubic.insert_point_sources_in_sky.center_ang"><code class="docutils literal notranslate"><span class="pre">center_ang()</span></code></a></li>
<li><a class="reference internal" href="#qubic.insert_point_sources_in_sky.gaussian2D"><code class="docutils literal notranslate"><span class="pre">gaussian2D()</span></code></a></li>
<li><a class="reference internal" href="#qubic.insert_point_sources_in_sky.gaussian2D_grid"><code class="docutils literal notranslate"><span class="pre">gaussian2D_grid()</span></code></a></li>
<li><a class="reference internal" href="#qubic.insert_point_sources_in_sky.getsource"><code class="docutils literal notranslate"><span class="pre">getsource()</span></code></a></li>
<li><a class="reference internal" href="#qubic.insert_point_sources_in_sky.insert_source"><code class="docutils literal notranslate"><span class="pre">insert_source()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.instrument">qubic.instrument module</a><ul>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument"><code class="docutils literal notranslate"><span class="pre">QubicInstrument</span></code></a><ul>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_before_horns"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_before_horns()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_coldstop"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_coldstop()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_combiner"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_combiner()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_dichroic"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_dichroic()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_environment"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_environment()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_horns"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_horns()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_lastfilter"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_lastfilter()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_lowpassedge"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_lowpassedge()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_lpefilter_220"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_lpefilter_220()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.NEP_neutraldensityfilter"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.NEP_neutraldensityfilter()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.detector_subset"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.detector_subset()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_aperture_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_aperture_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_convolution_peak_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_convolution_peak_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_detector_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_detector_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_detector_response_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_detector_response_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_filter_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_filter_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_hwp_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_hwp_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_invntt_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_noise"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_noise_detector"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise_detector()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_noise_photon"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise_photon()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_polarizer_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_polarizer_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_projection_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_projection_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_synthbeam"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_synthbeam()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.get_transmission_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_transmission_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicInstrument.load_NEP_parameters"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.load_NEP_parameters()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.instrument.QubicMultibandInstrument"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument</span></code></a><ul>
<li><a class="reference internal" href="#qubic.instrument.QubicMultibandInstrument.detector_subset"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.detector_subset()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicMultibandInstrument.direct_convolution"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.direct_convolution()</span></code></a></li>
<li><a class="reference internal" href="#qubic.instrument.QubicMultibandInstrument.get_synthbeam"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.get_synthbeam()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.jchinstrument">qubic.jchinstrument module</a><ul>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument"><code class="docutils literal notranslate"><span class="pre">QubicInstrument</span></code></a><ul>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.detector_subset"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.detector_subset()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_aperture_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_aperture_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_convolution_peak_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_convolution_peak_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_detector_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_detector_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_detector_response_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_detector_response_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_filter_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_filter_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_hwp_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_hwp_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_invntt_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_noise"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_noise_detector"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise_detector()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_noise_photon"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise_photon()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_polarizer_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_polarizer_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_projection_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_projection_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_synthbeam"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_synthbeam()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicInstrument.get_transmission_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_transmission_operator()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicMultibandInstrument"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument</span></code></a><ul>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicMultibandInstrument.detector_subset"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.detector_subset()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicMultibandInstrument.direct_convolution"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.direct_convolution()</span></code></a></li>
<li><a class="reference internal" href="#qubic.jchinstrument.QubicMultibandInstrument.get_synthbeam"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.get_synthbeam()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.lin_lib">qubic.lin_lib module</a><ul>
<li><a class="reference internal" href="#qubic.lin_lib.logistic"><code class="docutils literal notranslate"><span class="pre">logistic()</span></code></a></li>
<li><a class="reference internal" href="#qubic.lin_lib.shift_src"><code class="docutils literal notranslate"><span class="pre">shift_src()</span></code></a></li>
<li><a class="reference internal" href="#qubic.lin_lib.sim_generator_power"><code class="docutils literal notranslate"><span class="pre">sim_generator_power()</span></code></a></li>
<li><a class="reference internal" href="#qubic.lin_lib.sine"><code class="docutils literal notranslate"><span class="pre">sine()</span></code></a></li>
<li><a class="reference internal" href="#qubic.lin_lib.sinesat"><code class="docutils literal notranslate"><span class="pre">sinesat()</span></code></a></li>
<li><a class="reference internal" href="#qubic.lin_lib.source_cal"><code class="docutils literal notranslate"><span class="pre">source_cal()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.mapmaking">qubic.mapmaking module</a><ul>
<li><a class="reference internal" href="#qubic.mapmaking.angular_distance_from_mask"><code class="docutils literal notranslate"><span class="pre">angular_distance_from_mask()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mapmaking.apodize_mask"><code class="docutils literal notranslate"><span class="pre">apodize_mask()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mapmaking.map2tod"><code class="docutils literal notranslate"><span class="pre">map2tod()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mapmaking.tod2map_all"><code class="docutils literal notranslate"><span class="pre">tod2map_all()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mapmaking.tod2map_each"><code class="docutils literal notranslate"><span class="pre">tod2map_each()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.mcmc">qubic.mcmc module</a><ul>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood"><code class="docutils literal notranslate"><span class="pre">LogLikelihood</span></code></a><ul>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.call4curvefit"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.call4curvefit()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.compute_sigma68"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.compute_sigma68()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.curve_fit"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.curve_fit()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.fisher_analysis"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.fisher_analysis()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.log_priors"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.log_priors()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.make_covariance_matrix"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.make_covariance_matrix()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.minuit"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.minuit()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.random_explore_guess"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.random_explore_guess()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mcmc.LogLikelihood.run"><code class="docutils literal notranslate"><span class="pre">LogLikelihood.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.mjwinstrument">qubic.mjwinstrument module</a><ul>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument"><code class="docutils literal notranslate"><span class="pre">QubicInstrument</span></code></a><ul>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.detector_subset"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.detector_subset()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_aperture_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_aperture_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_convolution_peak_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_convolution_peak_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_detector_integration_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_detector_integration_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_detector_response_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_detector_response_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_filter_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_filter_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_hwp_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_hwp_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_invntt_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_noise"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_noise_detector"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise_detector()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_noise_photon"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_noise_photon()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_polarizer_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_polarizer_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_projection_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_projection_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_synthbeam"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_synthbeam()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.get_transmission_operator"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.get_transmission_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.jchedit"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.jchedit()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.remove_significant_peaks"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.remove_significant_peaks()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicInstrument.synthbeam_file"><code class="docutils literal notranslate"><span class="pre">QubicInstrument.synthbeam_file()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicMultibandInstrument"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument</span></code></a><ul>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicMultibandInstrument.detector_subset"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.detector_subset()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicMultibandInstrument.direct_convolution"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.direct_convolution()</span></code></a></li>
<li><a class="reference internal" href="#qubic.mjwinstrument.QubicMultibandInstrument.get_synthbeam"><code class="docutils literal notranslate"><span class="pre">QubicMultibandInstrument.get_synthbeam()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.multiacquisition">qubic.multiacquisition module</a><ul>
<li><a class="reference internal" href="#qubic.multiacquisition.QubicMultibandAcquisition"><code class="docutils literal notranslate"><span class="pre">QubicMultibandAcquisition</span></code></a><ul>
<li><a class="reference internal" href="#qubic.multiacquisition.QubicMultibandAcquisition.get_operator"><code class="docutils literal notranslate"><span class="pre">QubicMultibandAcquisition.get_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.multiacquisition.QubicMultibandAcquisition.get_preconditioner"><code class="docutils literal notranslate"><span class="pre">QubicMultibandAcquisition.get_preconditioner()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition"><code class="docutils literal notranslate"><span class="pre">QubicMultibandPlanckAcquisition</span></code></a><ul>
<li><a class="reference internal" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition.get_observation"><code class="docutils literal notranslate"><span class="pre">QubicMultibandPlanckAcquisition.get_observation()</span></code></a></li>
<li><a class="reference internal" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition.get_preconditioner"><code class="docutils literal notranslate"><span class="pre">QubicMultibandPlanckAcquisition.get_preconditioner()</span></code></a></li>
<li><a class="reference internal" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition.tod2map"><code class="docutils literal notranslate"><span class="pre">QubicMultibandPlanckAcquisition.tod2map()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.plotters">qubic.plotters module</a><ul>
<li><a class="reference internal" href="#qubic.plotters.Allplots"><code class="docutils literal notranslate"><span class="pre">Allplots()</span></code></a></li>
<li><a class="reference internal" href="#qubic.plotters.FiltFreqResp"><code class="docutils literal notranslate"><span class="pre">FiltFreqResp()</span></code></a></li>
<li><a class="reference internal" href="#qubic.plotters.FoldedFiltTES"><code class="docutils literal notranslate"><span class="pre">FoldedFiltTES()</span></code></a></li>
<li><a class="reference internal" href="#qubic.plotters.FoldedTESFreeFit"><code class="docutils literal notranslate"><span class="pre">FoldedTESFreeFit()</span></code></a></li>
<li><a class="reference internal" href="#qubic.plotters.FreqResp"><code class="docutils literal notranslate"><span class="pre">FreqResp()</span></code></a></li>
<li><a class="reference internal" href="#qubic.plotters.TESvsThermo"><code class="docutils literal notranslate"><span class="pre">TESvsThermo()</span></code></a></li>
<li><a class="reference internal" href="#qubic.plotters.TimeSigPlot"><code class="docutils literal notranslate"><span class="pre">TimeSigPlot()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.polyacquisition">qubic.polyacquisition module</a><ul>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition</span></code></a><ul>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_coverage"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_coverage()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_coverage_mask"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_coverage_mask()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_invntt_operator"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_invntt_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_noise"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_noise()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_observation"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_observation()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_operator"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_operator()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_operator_to_make_TOD"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_operator_to_make_TOD()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.get_preconditioner"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.get_preconditioner()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.tod2map"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.tod2map()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition.warnings"><code class="docutils literal notranslate"><span class="pre">QubicPolyAcquisition.warnings()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition"><code class="docutils literal notranslate"><span class="pre">QubicPolyPlanckAcquisition</span></code></a><ul>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition.get_observation"><code class="docutils literal notranslate"><span class="pre">QubicPolyPlanckAcquisition.get_observation()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition.get_preconditioner"><code class="docutils literal notranslate"><span class="pre">QubicPolyPlanckAcquisition.get_preconditioner()</span></code></a></li>
<li><a class="reference internal" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition.tod2map"><code class="docutils literal notranslate"><span class="pre">QubicPolyPlanckAcquisition.tod2map()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.polyacquisition.compute_freq"><code class="docutils literal notranslate"><span class="pre">compute_freq()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.qubicdict">qubic.qubicdict module</a><ul>
<li><a class="reference internal" href="#qubic.qubicdict.ask_for"><code class="docutils literal notranslate"><span class="pre">ask_for()</span></code></a></li>
<li><a class="reference internal" href="#qubic.qubicdict.qubicDict"><code class="docutils literal notranslate"><span class="pre">qubicDict</span></code></a><ul>
<li><a class="reference internal" href="#qubic.qubicdict.qubicDict.cmp"><code class="docutils literal notranslate"><span class="pre">qubicDict.cmp()</span></code></a></li>
<li><a class="reference internal" href="#qubic.qubicdict.qubicDict.dicts_dir"><code class="docutils literal notranslate"><span class="pre">qubicDict.dicts_dir</span></code></a></li>
<li><a class="reference internal" href="#qubic.qubicdict.qubicDict.readFromFile"><code class="docutils literal notranslate"><span class="pre">qubicDict.readFromFile()</span></code></a></li>
<li><a class="reference internal" href="#qubic.qubicdict.qubicDict.read_from_file"><code class="docutils literal notranslate"><span class="pre">qubicDict.read_from_file()</span></code></a></li>
<li><a class="reference internal" href="#qubic.qubicdict.qubicDict.writeToFile"><code class="docutils literal notranslate"><span class="pre">qubicDict.writeToFile()</span></code></a></li>
<li><a class="reference internal" href="#qubic.qubicdict.qubicDict.write_to_file"><code class="docutils literal notranslate"><span class="pre">qubicDict.write_to_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.ripples">qubic.ripples module</a><ul>
<li><a class="reference internal" href="#qubic.ripples.BeamGaussianRippled"><code class="docutils literal notranslate"><span class="pre">BeamGaussianRippled</span></code></a></li>
<li><a class="reference internal" href="#qubic.ripples.ConvolutionRippledGaussianOperator"><code class="docutils literal notranslate"><span class="pre">ConvolutionRippledGaussianOperator</span></code></a><ul>
<li><a class="reference internal" href="#qubic.ripples.ConvolutionRippledGaussianOperator.direct"><code class="docutils literal notranslate"><span class="pre">ConvolutionRippledGaussianOperator.direct()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.samplings">qubic.samplings module</a><ul>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling"><code class="docutils literal notranslate"><span class="pre">QubicSampling</span></code></a><ul>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.azimuth"><code class="docutils literal notranslate"><span class="pre">QubicSampling.azimuth</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.elevation"><code class="docutils literal notranslate"><span class="pre">QubicSampling.elevation</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.pitch"><code class="docutils literal notranslate"><span class="pre">QubicSampling.pitch</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.angle_hwp"><code class="docutils literal notranslate"><span class="pre">QubicSampling.angle_hwp</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.time"><code class="docutils literal notranslate"><span class="pre">QubicSampling.time</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.date_obs"><code class="docutils literal notranslate"><span class="pre">QubicSampling.date_obs</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.period"><code class="docutils literal notranslate"><span class="pre">QubicSampling.period</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.latitude"><code class="docutils literal notranslate"><span class="pre">QubicSampling.latitude</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.longitude"><code class="docutils literal notranslate"><span class="pre">QubicSampling.longitude</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.DEFAULT_DATE_OBS"><code class="docutils literal notranslate"><span class="pre">QubicSampling.DEFAULT_DATE_OBS</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.DEFAULT_LATITUDE"><code class="docutils literal notranslate"><span class="pre">QubicSampling.DEFAULT_LATITUDE</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.DEFAULT_LONGITUDE"><code class="docutils literal notranslate"><span class="pre">QubicSampling.DEFAULT_LONGITUDE</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.DEFAULT_PERIOD"><code class="docutils literal notranslate"><span class="pre">QubicSampling.DEFAULT_PERIOD</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.cartesian_galactic2instrument"><code class="docutils literal notranslate"><span class="pre">QubicSampling.cartesian_galactic2instrument</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.cartesian_horizontal2instrument"><code class="docutils literal notranslate"><span class="pre">QubicSampling.cartesian_horizontal2instrument</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.cartesian_instrument2galactic"><code class="docutils literal notranslate"><span class="pre">QubicSampling.cartesian_instrument2galactic</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.cartesian_instrument2horizontal"><code class="docutils literal notranslate"><span class="pre">QubicSampling.cartesian_instrument2horizontal</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.QubicSampling.healpix"><code class="docutils literal notranslate"><span class="pre">QubicSampling.healpix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.samplings.create_random_pointings"><code class="docutils literal notranslate"><span class="pre">create_random_pointings()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.create_repeat_pointings"><code class="docutils literal notranslate"><span class="pre">create_repeat_pointings()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.create_sweeping_pointings"><code class="docutils literal notranslate"><span class="pre">create_sweeping_pointings()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.equ2gal"><code class="docutils literal notranslate"><span class="pre">equ2gal()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.equ2hor"><code class="docutils literal notranslate"><span class="pre">equ2hor()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.gal2equ"><code class="docutils literal notranslate"><span class="pre">gal2equ()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.gal2hor"><code class="docutils literal notranslate"><span class="pre">gal2hor()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.get_pointing"><code class="docutils literal notranslate"><span class="pre">get_pointing()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.hor2equ"><code class="docutils literal notranslate"><span class="pre">hor2equ()</span></code></a></li>
<li><a class="reference internal" href="#qubic.samplings.hor2gal"><code class="docutils literal notranslate"><span class="pre">hor2gal()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.sb_fitting">qubic.sb_fitting module</a><ul>
<li><a class="reference internal" href="#qubic.sb_fitting.SbModelIndepPeaks"><code class="docutils literal notranslate"><span class="pre">SbModelIndepPeaks</span></code></a><ul>
<li><a class="reference internal" href="#qubic.sb_fitting.SbModelIndepPeaks.print_start"><code class="docutils literal notranslate"><span class="pre">SbModelIndepPeaks.print_start()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.sb_fitting.SbModelIndepPeaksAmpFWHM"><code class="docutils literal notranslate"><span class="pre">SbModelIndepPeaksAmpFWHM</span></code></a><ul>
<li><a class="reference internal" href="#qubic.sb_fitting.SbModelIndepPeaksAmpFWHM.print_start"><code class="docutils literal notranslate"><span class="pre">SbModelIndepPeaksAmpFWHM.print_start()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.sb_fitting.SimpleSbModel"><code class="docutils literal notranslate"><span class="pre">SimpleSbModel</span></code></a><ul>
<li><a class="reference internal" href="#qubic.sb_fitting.SimpleSbModel.print_start"><code class="docutils literal notranslate"><span class="pre">SimpleSbModel.print_start()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.sb_fitting.ang_dist"><code class="docutils literal notranslate"><span class="pre">ang_dist()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.beeps"><code class="docutils literal notranslate"><span class="pre">beeps()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.fit_sb"><code class="docutils literal notranslate"><span class="pre">fit_sb()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.get_flatmap"><code class="docutils literal notranslate"><span class="pre">get_flatmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.get_hpmap"><code class="docutils literal notranslate"><span class="pre">get_hpmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.get_lines"><code class="docutils literal notranslate"><span class="pre">get_lines()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.rotate_q2m"><code class="docutils literal notranslate"><span class="pre">rotate_q2m()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.rotmatX"><code class="docutils literal notranslate"><span class="pre">rotmatX()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.rotmatY"><code class="docutils literal notranslate"><span class="pre">rotmatY()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.rotmatZ"><code class="docutils literal notranslate"><span class="pre">rotmatZ()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.show_flatmap"><code class="docutils literal notranslate"><span class="pre">show_flatmap()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.show_flatmaps_list"><code class="docutils literal notranslate"><span class="pre">show_flatmaps_list()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.show_lines"><code class="docutils literal notranslate"><span class="pre">show_lines()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.thph2uv"><code class="docutils literal notranslate"><span class="pre">thph2uv()</span></code></a></li>
<li><a class="reference internal" href="#qubic.sb_fitting.uv2thph"><code class="docutils literal notranslate"><span class="pre">uv2thph()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.scene">qubic.scene module</a><ul>
<li><a class="reference internal" href="#qubic.scene.QubicScene"><code class="docutils literal notranslate"><span class="pre">QubicScene</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.selfcal_lib">qubic.selfcal_lib module</a><ul>
<li><a class="reference internal" href="#qubic.selfcal_lib.Model_Fringes_Maynooth"><code class="docutils literal notranslate"><span class="pre">Model_Fringes_Maynooth</span></code></a><ul>
<li><a class="reference internal" href="#qubic.selfcal_lib.Model_Fringes_Maynooth.get_fringes"><code class="docutils literal notranslate"><span class="pre">Model_Fringes_Maynooth.get_fringes()</span></code></a></li>
<li><a class="reference internal" href="#qubic.selfcal_lib.Model_Fringes_Maynooth.get_fringes_from_combination"><code class="docutils literal notranslate"><span class="pre">Model_Fringes_Maynooth.get_fringes_from_combination()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft"><code class="docutils literal notranslate"><span class="pre">Model_Fringes_QubicSoft</span></code></a><ul>
<li><a class="reference internal" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft.get_all_combinations_power"><code class="docutils literal notranslate"><span class="pre">Model_Fringes_QubicSoft.get_all_combinations_power()</span></code></a></li>
<li><a class="reference internal" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft.get_fringes"><code class="docutils literal notranslate"><span class="pre">Model_Fringes_QubicSoft.get_fringes()</span></code></a></li>
<li><a class="reference internal" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft.get_fringes_from_combination"><code class="docutils literal notranslate"><span class="pre">Model_Fringes_QubicSoft.get_fringes_from_combination()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.utils">qubic.utils module</a><ul>
<li><a class="reference internal" href="#qubic.utils.progress_bar"><code class="docutils literal notranslate"><span class="pre">progress_bar()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.warnings">qubic.warnings module</a><ul>
<li><a class="reference internal" href="#qubic.warnings.QubicDeprecationWarning"><code class="docutils literal notranslate"><span class="pre">QubicDeprecationWarning</span></code></a></li>
<li><a class="reference internal" href="#qubic.warnings.QubicWarning"><code class="docutils literal notranslate"><span class="pre">QubicWarning</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic.xpol">qubic.xpol module</a><ul>
<li><a class="reference internal" href="#qubic.xpol.Xpol"><code class="docutils literal notranslate"><span class="pre">Xpol</span></code></a><ul>
<li><a class="reference internal" href="#qubic.xpol.Xpol.bin_spectra"><code class="docutils literal notranslate"><span class="pre">Xpol.bin_spectra()</span></code></a></li>
<li><a class="reference internal" href="#qubic.xpol.Xpol.get_spectra"><code class="docutils literal notranslate"><span class="pre">Xpol.get_spectra()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-qubic">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Qubicsoft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">qubic package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/qubic.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qubic-package">
<h1>qubic package<a class="headerlink" href="#qubic-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="qubic.TES.html">qubic.TES package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qubic.TES.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="qubic.TES.html#module-qubic.TES.TES_parameters">qubic.TES.TES_parameters module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="qubic.TES.html#qubic.TES.TES_parameters.TEStable_readfile"><code class="docutils literal notranslate"><span class="pre">TEStable_readfile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qubic.TES.html#module-qubic.TES">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qubic.calfiles.html">qubic.calfiles package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qubic.calfiles.html#module-qubic.calfiles">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qubic.data.html">qubic.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qubic.data.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="qubic.data.FastSimulator_version01.html">qubic.data.FastSimulator_version01 package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="qubic.data.FastSimulator_version01.html#module-qubic.data.FastSimulator_version01">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qubic.data.html#module-qubic.data">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qubic.dicts.html">qubic.dicts package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qubic.dicts.html#module-qubic.dicts">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qubic.io.html">qubic.io package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qubic.io.html#module-qubic.io">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-qubic.AnalysisMC">
<span id="qubic-analysismc-module"></span><h2>qubic.AnalysisMC module<a class="headerlink" href="#module-qubic.AnalysisMC" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.Cp2Cp_prime">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">Cp2Cp_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#Cp2Cp_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.Cp2Cp_prime" title="Link to this definition"></a></dt>
<dd><p>Average the covariance matrices over pixels. A normalization by the 00 element is done
before averaging.
:param Cp: The covariance matrices for each pixel.</p>
<blockquote>
<div><p>Shape (#bands, #bands, #stokes, #pixels)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>)  </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Cp_prime</strong>  The covariance matrices for each pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of shape (#bands, #bands, #Stokes, #pixels)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.Cp2Cp_prime_viaCorr">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">Cp2Cp_prime_viaCorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#Cp2Cp_prime_viaCorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.Cp2Cp_prime_viaCorr" title="Link to this definition"></a></dt>
<dd><p>Average the covariance matrices over pixels. A normalization is done
on pixels before the average.
:param Cp: The covariance matrices for each pixel.</p>
<blockquote>
<div><p>Shape: (#bands, #bands, #Stokes, #pixels)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>)  </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Cp_prime</strong>  The covariance matrices for each pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of shape (#bands, #bands, #Stokes, #pixels)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.average_pix_sig2">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">average_pix_sig2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang_threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#average_pix_sig2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.average_pix_sig2" title="Link to this definition"></a></dt>
<dd><p>Average the variances over pixels in a given angle.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.cov2corr">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">cov2corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#cov2corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.cov2corr" title="Link to this definition"></a></dt>
<dd><p>Converts a Covariance Matrix in a Correlation Matrix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.covariance_IQU_subbands">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">covariance_IQU_subbands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allmaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokesjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#covariance_IQU_subbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.covariance_IQU_subbands" title="Link to this definition"></a></dt>
<dd><p>Returns the mean maps, averaged over pixels and realisations and the
covariance matrices of the maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allmaps</strong> (<em>list</em>)  List of arrays of shape (nreals, nsub, npix, 3)
List of maps for each number of sub-bands.</p></li>
<li><p><strong>stokesjoint</strong> (<em>if True return Stokes parameter together</em>)  I0,I1,, Q0,Q1,, U0,U1,  . Otherwise will return
I0,Q0,U0,  I1,Q1,U1, 
Default: False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>allmean</strong> (<em>list of arrays of shape 3*nsub</em>)  mean for I, Q, U for each subband</p></li>
<li><p><strong>allcov</strong> (<em>list of arrays of shape (3*nsub, 3*nsub)</em>)  covariance matrices between stokes parameters and sub frequency bands</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.distance_square">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">distance_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#distance_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.distance_square" title="Link to this definition"></a></dt>
<dd><p>Return a distance associated to a matrix (n*n).
Sum of the square elements normalized by n**2.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.distance_sup">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">distance_sup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#distance_sup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.distance_sup" title="Link to this definition"></a></dt>
<dd><p>Return a distance associated to a matrix (n*n).
Normalized by n.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_Cp">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_Cp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_Cp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_Cp" title="Link to this definition"></a></dt>
<dd><p>Returns covariance matrices between subbands for each Stokes parameter
and each pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch</strong> (<em>ndarray</em>)  Shape (#reals, #bands, #pixels, 3)</p></li>
<li><p><strong>verbose</strong> (<em>Bool</em>)  If True makes a lot of prints.</p></li>
<li><p><strong>doplot</strong> (<em>Bool</em>)  If True, plot the mean cov and corr matrices over pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Cp</strong>  The covariance matrices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of shape (#bands, #bands, 3, #pixels)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_corrections">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_corrections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nf_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf_recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_corrections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_corrections" title="Link to this definition"></a></dt>
<dd><p>The reconstructed subbands have different widths.
Here, we compute the corrections you can applied to
the variances and covariances to take this into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nf_sub</strong> (<em>int</em>)  Number of input subbands</p></li>
<li><p><strong>nf_recon</strong> (<em>int</em>)  Number of reconstructed subbands</p></li>
<li><p><strong>band</strong> (<em>int</em>)  QUBIC frequency band, in GHz. 150 by default
Typical values: 150, 220.</p></li>
<li><p><strong>relative_bandwidth</strong> (<em>float</em>)  Ratio of the difference between the edges of the
frequency band over the average frequency of the band
Typical value: 0.25</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>corrections</strong> (<em>list</em>)  Correction coefficients for each subband.</p></li>
<li><p><strong>correction_mat</strong> (<em>array of shape (3xnf_recon, 3xnf_recon)</em>)  Matrix containing the corrections.
It can be multiplied term by term to a covariance matrix.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_covcorr1pix">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_covcorr1pix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokesjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_covcorr1pix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_covcorr1pix" title="Link to this definition"></a></dt>
<dd><p>This function return the covariance matrix for one pixel given a list of maps.
Each of the Nreal maps has the shape (nfrec, npix, 3) (see save_simu_fits() ).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maps</strong> (<em>array</em>)  Input maps with shape (nrealizations, nfrecons, npix, 3)</p></li>
<li><p><strong>ipix</strong> (<em>int</em>)  pixel where the covariance will be computed</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, print information. False by default.</p></li>
<li><p><strong>stokesjoint</strong> (<em>bool</em>)  If True return Stokes parameter together
I0,I1,, Q0,Q1,, U0, U1,  . Otherwise will return
I0,Q0,U0,  I1,Q1,U1, 
Default: False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cov1pix</strong> (<em>np.array</em>)  covariance matrix for a given pixel (ipix) with shape 3*nfrec x 3*nfrec</p></li>
<li><p><strong>corr1pix</strong> (<em>np.array</em>)  correlation matrix for a given pixel (ipix) with shape 3*nfrec x 3*nfrec</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_covcorr_between_pix">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_covcorr_between_pix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_covcorr_between_pix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_covcorr_between_pix" title="Link to this definition"></a></dt>
<dd><p>Compute the pixel covariance matrix and correlation matrix
minus the identity over many realisations. You will obtain nsub x 3
matrices of shape (npix x npix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maps</strong> (<em>array</em>)  Input maps with shape (nreal, nsub, npix, 3)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  If True, print information. False by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cov_pix</strong> (<em>array of shape (nsub, nstokes, npix, npix)</em>)  The covariance matrices for each subband and I, Q, U.</p></li>
<li><p><strong>corr_pix</strong> (<em>array of shape (nsub, nstokes, npix, npix)</em>)  The correlation matrices minus the identity (0. on the diagonal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_covcorr_patch">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_covcorr_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stokesjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_covcorr_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_covcorr_patch" title="Link to this definition"></a></dt>
<dd><p>This function computes the covariance matrix and the correlation matrix for a given patch in the sky.
It uses get_covcorr1pix() to compute the covariance and correlation matrix for each pixel (ipix).</p>
<p>Asumptions: patch.shape = (nreals, nbands, npix_patch, nstokes) &gt; to be able to use get_covcorr1pix</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>patch: np.array</dt><dd><p>Sky patch observed (see get_patch_many_files() from ReadMC module)</p>
</dd>
<dt>stokesjoint: bool</dt><dd><p>If True return Stokes parameter together
I0,I1,, Q0,Q1,, U0, U1,  . Otherwise will return
I0,Q0,U0,  I1,Q1,U1, 
Default: False</p>
</dd>
</dl>
<p>doplot: If True return a imshow plot of the matrix</p>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>covterm: np.array</dt><dd><p>Covariance matrix for each pixel in a given patch in the sky.
Shape = (3xnfreq, 3xnfreq, npix).</p>
</dd>
<dt>corrterm: np.array</dt><dd><p>Correlation matrix for each pixel in a given patch in the sky.
Shape = (3xnfreq, 3xnfreq, npix)</p>
</dd>
</dl>
<p>plot: Mean over the pixels of the covariance and correlation matrices</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_mean_cov">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_mean_cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invcov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_mean_cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_mean_cov" title="Link to this definition"></a></dt>
<dd><p>This function does the same as: get_weighted_correlation_average</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_residuals">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fits_noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fits_noiseless</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals_way</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_residuals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_residuals" title="Link to this definition"></a></dt>
<dd><p>Compute residuals in a given way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_noise</strong> (<em>list</em>)  List containing the reconstructed noisy maps (fits files)</p></li>
<li><p><strong>fits_noiseless</strong> (<em>str</em>)  Fits file containing the noiseless reconstruction</p></li>
<li><p><strong>residuals_way</strong> (<em>str</em>)  Way to compute residuals. 3 keywords : noiseless, conv or mean_recon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>residuals</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of shape (#reals, #bands, #pixels, 3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_rms_covar">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_rms_covar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsubvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seenmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allmapsout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_rms_covar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_rms_covar" title="Link to this definition"></a></dt>
<dd><p>Test done by Matthieu Tristram :
Calculate the variance map in each case accounting for the band-band covariance matrix for each pixel from the MC.
This is pretty noisy so it may be interesting to get the average matrix.
We calculate all the matrices for each pixel and normalize them to average 1
and then calculate the average matrix over the pixels.</p>
<p>variance_map : array of shape (len(nsubvals), 3, npixok)</p>
<dl class="simple">
<dt>allmeanmat<span class="classifier">list of arrays (nsub, nsub, 3)</span></dt><dd><p>Mean over pixels of the cov matrices freq-freq</p>
</dd>
<dt>allstdmat<span class="classifier">list of arrays (nsub, nsub, 3)</span></dt><dd><p>Std over pixels of the cov matrices freq-freq</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_rms_covarmean">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_rms_covarmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsubvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seenmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allmapsout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allmeanmat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_rms_covarmean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_rms_covarmean" title="Link to this definition"></a></dt>
<dd><p>RMS map and mean map over the realisations using the pixel
averaged freq-freq covariance matrix computed with get_rms_covar
meanmap_cov : array of shape (len(nsubvals), 3, npixok)</p>
<p>rmsmap_cov : array of shape (len(nsubvals), 3, npixok)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.get_weighted_correlation_average">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">get_weighted_correlation_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#get_weighted_correlation_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.get_weighted_correlation_average" title="Link to this definition"></a></dt>
<dd><p>Compute a weighted average taking into account the correlations between the variables.
The mean obtained is the one that has the minimal variance possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1D array</em>)  Values you want to average.</p></li>
<li><p><strong>cov</strong> (<em>2D array</em>)  Covariance matrix associated to the values in x.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The weighted mean and the variance on that mean.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.make_weighted_av">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">make_weighted_av</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#make_weighted_av"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.make_weighted_av" title="Link to this definition"></a></dt>
<dd><p>Average the maps over subbands using the covariance matrix between subbands.
:param patch: Shape (#reals, #bands, #pixels, #nstks)
:type patch: array
:param Cp: The covariance matrices.</p>
<blockquote>
<div><p>Shape (#bands, #bands, #nstks, #pixels)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>)  </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>weighted_av</strong> (<em>map averaged over bands</em>)</p></li>
<li><p><strong>sig2</strong> (<em>variances over realisations on the map</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.plot_hist">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">plot_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat_npix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'b'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#plot_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.plot_hist" title="Link to this definition"></a></dt>
<dd><p>Plots the histograms of each element of the matrix.
Each histogram represents the distribution of a given
term over the pixels..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat_npix</strong> (<em>array</em><em> of </em><em>shape</em><em> (</em><em>3 x nfreq</em><em>, </em><em>3 x nfreq</em><em>, </em><em>npix</em><em>)</em>)  Cov or corr matrix for each pixel.</p></li>
<li><p><strong>bins</strong> (<em>int</em>)  Numbers of bins for the histogram</p></li>
<li><p><strong>title_prefix</strong> (<em>str</em>)  Prefix for the title of the plot.</p></li>
<li><p><strong>ymax</strong> (<em>float</em>)  Limit max on the y axis (between 0 and 1)</p></li>
<li><p><strong>color</strong> (<em>str</em>)  Color of the histogram</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.rms_method">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">rms_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals_way</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zones</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#rms_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.rms_method" title="Link to this definition"></a></dt>
<dd><p>Get the std of the residuals from one simulation.
STD are computed over realisations and pixels for I, Q, U separately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>)  Simulation file.</p></li>
<li><p><strong>residuals_way</strong> (<em>str</em>)  Way to compute residuals. 3 keywords : noiseless, conv or mean_recon</p></li>
<li><p><strong>zones</strong> (<em>int</em>)  Number of zones to divide the patch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rms_I, rms_Q, rms_U</strong> (<em>dictionarys containing RMS for IQU</em>)</p></li>
<li><p><strong>setpar</strong> (<em>a dict with some parameters of the simu.</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.AnalysisMC.std_profile">
<span class="sig-prename descclassname"><span class="pre">qubic.AnalysisMC.</span></span><span class="sig-name descname"><span class="pre">std_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">many_patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seenmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/AnalysisMC.html#std_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.AnalysisMC.std_profile" title="Link to this definition"></a></dt>
<dd><p>Get the std profile of a patch over pixels and realisations
from the center to the border.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>many_patch</strong> (<em>array</em><em> of </em><em>shape</em><em> (</em><em>nreal</em><em>, </em><em>nsub</em><em>, </em><em>npixok</em><em>, </em><em>3</em><em>)</em>)  Many realisations of one patch.</p></li>
<li><p><strong>nbins</strong> (<em>int</em>)  Number of bins.</p></li>
<li><p><strong>nside</strong> (<em>int</em>)  NSIDE in the patch.</p></li>
<li><p><strong>center</strong> (<em>array</em>)  Coordinates of the center of the patch in degree (lon, lat)</p></li>
<li><p><strong>seenmap</strong> (<em>array</em>)  Array of booleans of shape #pixels,
True inside the patch and False outside.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bin_centers</strong> (<em>array with angles associated to each bin.</em>)</p></li>
<li><p><strong>ang</strong> (<em>array with angles associated to each pixel</em>)</p></li>
<li><p><strong>std_bin</strong> (<em>array of shape (nbins, nsub, 3)</em>)  Std value in each bin, for each subband and IQU.</p></li>
<li><p><strong>std_profile</strong> (<em>array of shape (npixok, nsub, 3)</em>)  Quadratic interpolation of the std_bin.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="qubic-datahandling-module">
<h2>qubic.DataHandling module<a class="headerlink" href="#qubic-datahandling-module" title="Link to this heading"></a></h2>
</section>
<section id="module-qubic.NamasterLib">
<span id="qubic-namasterlib-module"></span><h2>qubic.NamasterLib module<a class="headerlink" href="#module-qubic.NamasterLib" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.NamasterLib.</span></span><span class="sig-name descname"><span class="pre">Namaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aposize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apotype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.bin_spectra">
<span class="sig-name descname"><span class="pre">bin_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.bin_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.bin_spectra" title="Link to this definition"></a></dt>
<dd><p>Bin a spectrum.
:param input_cls: input Cls spectrum
:type input_cls: 1D array
:param nside:
:type nside: the nside of the maps</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The binned power spectrum Dl = l(l+1)*Cl.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.compute_master">
<span class="sig-name descname"><span class="pre">compute_master</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workspace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.compute_master"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.compute_master" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_a</strong> (<em>NmtField</em>)  </p></li>
<li><p><strong>field_b</strong> (<em>NmtField</em>)  </p></li>
<li><p><strong>workspace</strong> (<em>NmtWorkspace</em>)  Contains the coupling matrix</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>decoupled Cls.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_apodized_mask">
<span class="sig-name descname"><span class="pre">get_apodized_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_apodized_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_apodized_mask" title="Link to this definition"></a></dt>
<dd><p>Make an apodized mask. The pure-B formalism requires the mask to be
differentiable along the edges. The C1 and C2 apodization types
supported by mask_apodization achieve this.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_binning">
<span class="sig-name descname"><span class="pre">get_binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nside</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_binning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_binning" title="Link to this definition"></a></dt>
<dd><p>Binning informations.
:param nside:
:type nside: the nside of the maps</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The binned monopoles and the NmtBin object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_covariance_BB_BB">
<span class="sig-name descname"><span class="pre">get_covariance_BB_BB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cl_bb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_covariance_BB_BB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_covariance_BB_BB" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_covariance_EE_EE">
<span class="sig-name descname"><span class="pre">get_covariance_EE_EE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cl_ee</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_covariance_EE_EE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_covariance_EE_EE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_covariance_TE_TE">
<span class="sig-name descname"><span class="pre">get_covariance_TE_TE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cl_te</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_covariance_TE_TE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_covariance_TE_TE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_covariance_TT_TT">
<span class="sig-name descname"><span class="pre">get_covariance_TT_TT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cl_tt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_covariance_TT_TT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_covariance_TT_TT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_covariance_coeff">
<span class="sig-name descname"><span class="pre">get_covariance_coeff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_covariance_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_covariance_coeff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_fields">
<span class="sig-name descname"><span class="pre">get_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_apo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purify_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purify_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_fields" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> (<em>array</em>)  IQU maps, shape (3, #pixels)</p></li>
<li><p><strong>mask_apo</strong> (<em>array</em><em>, </em><em>optionnal</em><em> (</em><em>if not given the one used at the object's instanciation is used</em><em>)</em>)  Apodized mask.</p></li>
<li><p><strong>purify_e</strong> (<em>bool</em><em>, </em><em>optional</em>)  False by default.</p></li>
<li><p><strong>purify_b</strong> (<em>bool</em><em>, </em><em>optional</em>)  True by default.
Note that generally its not a good idea to purify both,
since youll lose sensitivity on E</p></li>
<li><p><strong>beam_correction</strong> (<em>bool</em><em>, </em><em>optional</em>)  None by default.
If True, a correction by the Qubic beam at 150GHz is applied.
You can also give the beam FWHM you want to correct for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f0, f2</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>spin-0 and spin-2 Namaster fields.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_pixwin_correction">
<span class="sig-name descname"><span class="pre">get_pixwin_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nside</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_pixwin_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_pixwin_correction" title="Link to this definition"></a></dt>
<dd><p>Return the binned pixel window function multiplied by 2pi/(l(l+1))
for temperature and polarization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.get_spectra">
<span class="sig-name descname"><span class="pre">get_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_apo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purify_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purify_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixwin_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.get_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.get_spectra" title="Link to this definition"></a></dt>
<dd><p>Get spectra from IQU maps.
:param map: IQU maps, shape (3, #pixels)
:type map: array
:param mask_apo: Apodized mask.
:type mask_apo: array, optional (if not given then the maks used at the objects instanciation is used)
:param map2: IQU maps, shape (3, #pixels) for Cross-Spectra
:type map2: array
:param purify_e: False by default.
:type purify_e: bool, optional
:param purify_b: True by default.</p>
<blockquote>
<div><p>Note that generally its not a good idea to purify both,
since youll lose sensitivity on E</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<em>list with Namaster workspace</em><em> [</em><em>w00</em><em>, </em><em>w22</em><em>, </em><em>w02</em><em>]</em>)  If None the workspaces will be created.</p></li>
<li><p><strong>beam_correction</strong> (<em>bool</em><em>, </em><em>optional</em>)  None by default.
If True, a correction by the Qubic beam at 150GHz is applied.
You can also give the beam FWHM you want to correct for.</p></li>
<li><p><strong>pixwin_correction</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, a correction for the pixel integration function is applied.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>)  True by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>ell_binned</em></p></li>
<li><p><strong>spectra</strong> (<em>TT, EE, BB, TE spectra, Dl = ell * (ell + 1) / 2 * PI * Cl</em>)</p></li>
<li><p><strong>w</strong> (<em>List containing the NmtWorkspaces [w00, w22, w02]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.knox_covariance">
<span class="sig-name descname"><span class="pre">knox_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.knox_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.knox_covariance" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.NamasterLib.Namaster.knox_errors">
<span class="sig-name descname"><span class="pre">knox_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/NamasterLib.html#Namaster.knox_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.NamasterLib.Namaster.knox_errors" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.QubicSkySim">
<span id="qubic-qubicskysim-module"></span><h2>qubic.QubicSkySim module<a class="headerlink" href="#module-qubic.QubicSkySim" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.QubicSkySim.Qubic_sky">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.QubicSkySim.</span></span><span class="sig-name descname"><span class="pre">Qubic_sky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skyconfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'qubic_sky'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#Qubic_sky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.Qubic_sky" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qubic.QubicSkySim.sky" title="qubic.QubicSkySim.sky"><code class="xref py py-class docutils literal notranslate"><span class="pre">sky</span></code></a></p>
<p>Define a sky object as seen by Qubic</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.QubicSkySim.Qubic_sky.create_noise_maps">
<span class="sig-name descname"><span class="pre">create_noise_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_sec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effective_variance_invcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_bands_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#Qubic_sky.create_noise_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.Qubic_sky.create_noise_maps" title="Link to this definition"></a></dt>
<dd><p>This returns a realization of noise maps for I, Q and U with no correlation between them, according to a
noise RMS map built according to the coverage specified as an attribute to the class
The optional effective_variance_invcov keyword is a modification law to be applied to the coverage in order to obtain
more realistic noise profile. It is a law for effective RMS as a function of inverse coverage and is 2D array
with the first one being (nx samples) inverse coverage and the second being the corresponding effective variance to be
used through interpolation when generating the noise.
The clnoise option is used to apply a convolution to the noise to obtain spatially correlated noise. This cl should be
calculated from the c(theta) of the noise that can be measured using the function ctheta_parts() below. The transformation
of this C9theta) into Cl has to be done using wrappers on camb function found in camb_interface.py of the QUBIC software:
the functions to back and forth from ctheta to cl are: cl_2_ctheta and ctheta_2_cell. The simulation of the noise itself
calls a function of camb_interface called simulate_correlated_map().
:param sigma_sec:
:param coverage:
:param Nyears:
:param verbose:
:param seed:
:param effective_variance_invcov:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.QubicSkySim.Qubic_sky.get_fullsky_convolved_maps">
<span class="sig-name descname"><span class="pre">get_fullsky_convolved_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FWHMdeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#Qubic_sky.get_fullsky_convolved_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.Qubic_sky.get_fullsky_convolved_maps" title="Link to this definition"></a></dt>
<dd><p>This returns full sky maps at each subfrequency convolved by the beam of  the  instrument at
each frequency or with another beam if FWHMdeg is provided.
when FWHMdeg is 0, the maps are not convolved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FWHMdeg</strong> (<em>float</em>)  </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.QubicSkySim.Qubic_sky.get_partial_sky_maps_withnoise">
<span class="sig-name descname"><span class="pre">get_partial_sky_maps_withnoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_FastSim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FWHMdeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nunu_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrate_into_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_covcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#Qubic_sky.get_partial_sky_maps_withnoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.Qubic_sky.get_partial_sky_maps_withnoise" title="Link to this definition"></a></dt>
<dd><p>This returns maps in the same way as with get_simple_sky_map but cut according to the coverage
and with noise added according to this coverage and the RMS in muK.sqrt(sec) given by sigma_sec
The default integration time is 4 years but can be modified with optional variable Nyears
Note that the maps are convolved with the instrument beam by default, or with FWHMdeg (can be an array)
if provided.
If seed is provided, it will be used for the noise realization. If not it will be a new realization at
each call.
The optional effective_variance_invcov keyword is a modification law to be applied to the coverage in order to obtain
more realistic noise profile. It is a law for effective RMS as a function of inverse coverage and is 2D array
with the first one being (nx samples) inverse coverage and the second being the corresponding effective variance to be
used through interpolation when generating the noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coverage</strong> (<em>array</em>)  Coverage map of the sky.
By default, we load a coverage centered on the galactic center with 10000 pointings.</p></li>
<li><p><strong>version_FastSim</strong> (<em>str</em>)  Version of the FastSimulator files: 01, 02, 03 For now, only 01 exists.</p></li>
<li><p><strong>sigma_sec</strong> (<em>float</em>)  </p></li>
<li><p><strong>Nyears</strong> (<em>float</em>)  Integration time for observation to scale the noise, by default it is 4.</p></li>
<li><p><strong>FWHMdeg</strong>  </p></li>
<li><p><strong>seed</strong>  </p></li>
<li><p><strong>noise_profile</strong>  </p></li>
<li><p><strong>spatial_noise</strong> (<em>bool</em>)  If True, spatial noise correlations are added. True by default.</p></li>
<li><p><strong>nunu_correlation</strong> (<em>bool</em>)  If True, correlations between frequency sub-bands are added. True by default.</p></li>
<li><p><strong>noise_only</strong> (<em>bool</em>)  If True, only returns the noise maps and the coverage (without the sky signal).</p></li>
<li><p><strong>integrate_into_band</strong> (<em>bool</em>)  If True, averaging input sub-band maps into reconstruction sub-bands. True by default.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>maps + noisemaps, maps, noisemaps, coverage</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.QubicSkySim.Qubic_sky.smoothing">
<span class="sig-name descname"><span class="pre">smoothing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FWHMdeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_nus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#Qubic_sky.smoothing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.Qubic_sky.smoothing" title="Link to this definition"></a></dt>
<dd><p>Convolve the maps to the FWHM at each sub-frequency or to a common beam if FWHMdeg is given.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.QubicSkySim.Qubic_sky.theoretical_noise_maps">
<span class="sig-name descname"><span class="pre">theoretical_noise_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_sec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#Qubic_sky.theoretical_noise_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.Qubic_sky.theoretical_noise_maps" title="Link to this definition"></a></dt>
<dd><p>This returns a map of the RMS noise (not an actual realization, just the expected RMS - No covariance)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_sec</strong> (<em>float</em>)  Noise level.</p></li>
<li><p><strong>coverage</strong> (<em>array</em>)  The coverage map.</p></li>
<li><p><strong>Nyears</strong> (<em>int</em>)  </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.QubicSkySim.sky">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.QubicSkySim.</span></span><span class="sig-name descname"><span class="pre">sky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skyconfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#sky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.sky" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Define a sky object as seen by an instrument.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.QubicSkySim.sky.get_simple_sky_map">
<span class="sig-name descname"><span class="pre">get_simple_sky_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/QubicSkySim.html#sky.get_simple_sky_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.QubicSkySim.sky.get_simple_sky_map" title="Link to this definition"></a></dt>
<dd><p>Create as many skies as the number of input frequencies.
Instrumental effects are not considered.
Return a vector of shape (number_of_input_subfrequencies, npix, 3)</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-qubic.ReadMC">
<span id="qubic-readmc-module"></span><h2>qubic.ReadMC module<a class="headerlink" href="#module-qubic.ReadMC" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.get_maps">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">get_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#get_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.get_maps" title="Link to this definition"></a></dt>
<dd><p>Returns the full maps of a simulation.
:param file: A fits file saved from a simulation.
:type file: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>Reconstructed maps, convolved maps and the difference between both,</em></p></li>
<li><p><em>all with a shape (#subbands, #pixels, 3).</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.get_maps_many_files">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">get_maps_many_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rep_simu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#get_maps_many_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.get_maps_many_files" title="Link to this definition"></a></dt>
<dd><p>Get all the maps you want to analyze from many fits files.
:param rep_simu: Repository where the fits files are.
:type rep_simu: str
:param name: Name of the files you are interested in.
:type name: str
:param verbose:
:type verbose: bool</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>A list with the names of all the files you took.</em></p></li>
<li><p><em>Three arrays containing the reconstructed maps, the convolved maps</em></p></li>
<li><p><em>and the difference between both.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.get_patch">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">get_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seenmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#get_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.get_patch" title="Link to this definition"></a></dt>
<dd><p>Returns the observed patch in the maps to save memory.
:param file: A fits file saved from a simulation.
:type file: str
:param seenmap: Array of booleans of shape #pixels,</p>
<blockquote>
<div><p>True inside the patch and False outside.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>Reconstructed patches, convolved patches and difference between both,</em></p></li>
<li><p><em>all with a shape (#subbands, #pixels_seen, 3).</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.get_patch_many_files">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">get_patch_many_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rep_simu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">badval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.6375e+30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#get_patch_many_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.get_patch_many_files" title="Link to this definition"></a></dt>
<dd><p>Get all the patches you want to analyze from many fits files.
:param rep_simu: Repository where the fits files are.
:type rep_simu: str
:param name: Name of the files you are interested in.
:type name: str
:param badval: The value of the pixel considered as UNSEEN
:type badval: float
:param rtol: Relative tolerance for badval
:type rtol: float
:param atol: Absolute tolerance for badval
:type atol: float
:param verbose:
:type verbose: bool</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>A list with the names of all the files you took.</em></p></li>
<li><p><em>Three arrays containing the reconstructed patches, the convolved patches</em></p></li>
<li><p><em>and the difference between both.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.get_seenmap">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">get_seenmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">badval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.6375e+30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#get_seenmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.get_seenmap" title="Link to this definition"></a></dt>
<dd><p>Returns an array with the pixels seen or not.
:param file: A fits file saved from a simulation.
:type file: str
:param badval: The value of the pixel considered as UNSEEN
:type badval: float
:param rtol: Relative tolerance for badval
:type rtol: float
:param atol: Absolute tolerance for badval
:type atol: float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seenmap</strong>  Array of booleans of shape #pixels,
True inside the patch and False outside.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.make_zones">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">make_zones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seenmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#make_zones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.make_zones" title="Link to this definition"></a></dt>
<dd><p>Mask a path to get different concentric zones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch</strong> (<em>array</em>)  Patch you want to cut of shape (#subbands, #pix_seen, 3)</p></li>
<li><p><strong>nzones</strong> (<em>int</em>)  Number of zones you want to make.</p></li>
<li><p><strong>nside</strong> (<em>int</em>)  </p></li>
<li><p><strong>center</strong> (<em>array</em>)  Coordinates of the center of the patch in degree (lon, lat)</p></li>
<li><p><strong>seenmap</strong> (<em>array</em>)  Array of booleans of shape #pixels,
True inside the patch and False outside.</p></li>
<li><p><strong>angle</strong> (<em>bool</em>)  If True, you make only 2 zones, inside and outside dtheta.</p></li>
<li><p><strong>dtheta</strong> (<em>float</em>)  Size of the patch were the pointing was done (degree),
by default it is 15.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)  </p></li>
<li><p><strong>doplot</strong> (<em>bool</em>)  If True, makes a plot with the different zones obtained.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A list with the number of pixels in each zone.</em></p></li>
<li><p><em>A list with the patch masked to get each zone.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.pix2ang">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">pix2ang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seenmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#pix2ang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.pix2ang" title="Link to this definition"></a></dt>
<dd><p>For each pixel observed, returns the angle between the pixel vector and
the central pixel vector.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.ReadMC.save_simu_fits">
<span class="sig-prename descclassname"><span class="pre">qubic.ReadMC.</span></span><span class="sig-name descname"><span class="pre">save_simu_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps_recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nus_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maps_convolved</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simu_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ReadMC.html#save_simu_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ReadMC.save_simu_fits" title="Link to this definition"></a></dt>
<dd><p>Save a complete simulation in a .fits file for one number of reconstructed subbands.
:param maps_recon: Reconstructed maps in each subband.
:type maps_recon: array
:param cov: Coverage of the sky.
:type cov: array
:param nus: Central frequencies of each subband reconstructed.
:type nus: array
:param nus_edge: Edge frequencies of each subband reconstructed.
:type nus_edge: array
:param maps_convolved: Maps convolved at the resolution of each subband.
:type maps_convolved: array
:param save_dir: Directory where the .fits is saved.
:type save_dir: str
:param simu_name: Name of the simulation.
:type simu_name: str</p>
</dd></dl>

</section>
<section id="module-qubic.SpectroImLib">
<span id="qubic-spectroimlib-module"></span><h2>qubic.SpectroImLib module<a class="headerlink" href="#module-qubic.SpectroImLib" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.SpectroImLib.create_TOD">
<span class="sig-prename descclassname"><span class="pre">qubic.SpectroImLib.</span></span><span class="sig-name descname"><span class="pre">create_TOD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/SpectroImLib.html#create_TOD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.SpectroImLib.create_TOD" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.SpectroImLib.create_acquisition_operator_REC">
<span class="sig-prename descclassname"><span class="pre">qubic.SpectroImLib.</span></span><span class="sig-name descname"><span class="pre">create_acquisition_operator_REC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pointing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf_sub_rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/SpectroImLib.html#create_acquisition_operator_REC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.SpectroImLib.create_acquisition_operator_REC" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.SpectroImLib.create_acquisition_operator_TOD">
<span class="sig-prename descclassname"><span class="pre">qubic.SpectroImLib.</span></span><span class="sig-name descname"><span class="pre">create_acquisition_operator_TOD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pointing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/SpectroImLib.html#create_acquisition_operator_TOD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.SpectroImLib.create_acquisition_operator_TOD" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.SpectroImLib.get_hitmap">
<span class="sig-prename descclassname"><span class="pre">qubic.SpectroImLib.</span></span><span class="sig-name descname"><span class="pre">get_hitmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/SpectroImLib.html#get_hitmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.SpectroImLib.get_hitmap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.SpectroImLib.reconstruct_maps">
<span class="sig-prename descclassname"><span class="pre">qubic.SpectroImLib.</span></span><span class="sig-name descname"><span class="pre">reconstruct_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TOD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf_sub_rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forced_tes_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/SpectroImLib.html#reconstruct_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.SpectroImLib.reconstruct_maps" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="qubic-spectroimlib-pysm2-module">
<h2>qubic.SpectroImLib_PySM2 module<a class="headerlink" href="#qubic-spectroimlib-pysm2-module" title="Link to this heading"></a></h2>
</section>
<section id="module-qubic.TES_evaluation">
<span id="qubic-tes-evaluation-module"></span><h2>qubic.TES_evaluation module<a class="headerlink" href="#module-qubic.TES_evaluation" title="Link to this heading"></a></h2>
<p>$Id: TES_evaluation.py
$auth: Steve Torchinsky &lt;<a class="reference external" href="mailto:satorchi&#37;&#52;&#48;apc&#46;in2p3&#46;fr">satorchi<span>&#64;</span>apc<span>&#46;</span>in2p3<span>&#46;</span>fr</a>&gt;
$created: Tue 17 May 2022 16:57:19 CEST
$license: GPLv3 or later, see <a class="reference external" href="https://www.gnu.org/licenses/gpl-3.0.txt">https://www.gnu.org/licenses/gpl-3.0.txt</a></p>
<blockquote>
<div><p>This is free software: you are free to change and
redistribute it.  There is NO WARRANTY, to the extent
permitted by law.</p>
</div></blockquote>
<p>write a fits file with a boolean array for all TES good/bad
The FITS header had info about how the determination was made including:</p>
<blockquote>
<div><p>dataset name
analysis type (I-V, NEP, timeconstant, carbon fibre, linearity,)
analyser (person who did the analysis)
elog entry (link to elog entry for the data set)
wiki page (link to the wiki page with more information)</p>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.TES_evaluation.check_goodbad">
<span class="sig-prename descclassname"><span class="pre">qubic.TES_evaluation.</span></span><span class="sig-name descname"><span class="pre">check_goodbad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">goodbad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/TES_evaluation.html#check_goodbad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.TES_evaluation.check_goodbad" title="Link to this definition"></a></dt>
<dd><p>check that the given array is an array of boolean</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.TES_evaluation.get_header_values">
<span class="sig-prename descclassname"><span class="pre">qubic.TES_evaluation.</span></span><span class="sig-name descname"><span class="pre">get_header_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wikipage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/TES_evaluation.html#get_header_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.TES_evaluation.get_header_values" title="Link to this definition"></a></dt>
<dd><p>get the descriptive information</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.TES_evaluation.list_goodbad">
<span class="sig-prename descclassname"><span class="pre">qubic.TES_evaluation.</span></span><span class="sig-name descname"><span class="pre">list_goodbad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/TES_evaluation.html#list_goodbad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.TES_evaluation.list_goodbad" title="Link to this definition"></a></dt>
<dd><p>list all the available TES good/bad files</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.TES_evaluation.read_goodbad">
<span class="sig-prename descclassname"><span class="pre">qubic.TES_evaluation.</span></span><span class="sig-name descname"><span class="pre">read_goodbad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/TES_evaluation.html#read_goodbad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.TES_evaluation.read_goodbad" title="Link to this definition"></a></dt>
<dd><p>read a FITS file with good/bad information</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.TES_evaluation.write_goodbad">
<span class="sig-prename descclassname"><span class="pre">qubic.TES_evaluation.</span></span><span class="sig-name descname"><span class="pre">write_goodbad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">goodbad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wikipage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/TES_evaluation.html#write_goodbad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.TES_evaluation.write_goodbad" title="Link to this definition"></a></dt>
<dd><p>write a FITS file with a good/bad info</p>
</dd></dl>

</section>
<section id="module-qubic.acquisition">
<span id="qubic-acquisition-module"></span><h2>qubic.acquisition module<a class="headerlink" href="#module-qubic.acquisition" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.acquisition.PlanckAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.acquisition.</span></span><span class="sig-name descname"><span class="pre">PlanckAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_sky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution_operator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#PlanckAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.PlanckAcquisition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.PlanckAcquisition.get_invntt_operator">
<span class="sig-name descname"><span class="pre">get_invntt_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#PlanckAcquisition.get_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.PlanckAcquisition.get_invntt_operator" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.PlanckAcquisition.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#PlanckAcquisition.get_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.PlanckAcquisition.get_noise" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.PlanckAcquisition.get_observation">
<span class="sig-name descname"><span class="pre">get_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#PlanckAcquisition.get_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.PlanckAcquisition.get_observation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.PlanckAcquisition.get_operator">
<span class="sig-name descname"><span class="pre">get_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#PlanckAcquisition.get_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.PlanckAcquisition.get_operator" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.acquisition.</span></span><span class="sig-name descname"><span class="pre">QubicAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Acquisition</span></code></p>
<p>The QubicAcquisition class, which combines the instrument, sampling and
scene models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_add_grids_operator">
<span class="sig-name descname"><span class="pre">get_add_grids_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_add_grids_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_add_grids_operator" title="Link to this definition"></a></dt>
<dd><p>Return operator to add signal from detector pairs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_aperture_integration_operator">
<span class="sig-name descname"><span class="pre">get_aperture_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_aperture_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_aperture_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in the telescope aperture.
Convert signal from W / m^2 / Hz into W / Hz.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_convolution_peak_operator">
<span class="sig-name descname"><span class="pre">get_convolution_peak_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_convolution_peak_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_convolution_peak_operator" title="Link to this definition"></a></dt>
<dd><p>Return an operator that convolves the Healpix sky by the gaussian
kernel that, if used in conjonction with the peak sampling operator,
best approximates the synthetic beam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_coverage">
<span class="sig-name descname"><span class="pre">get_coverage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_coverage" title="Link to this definition"></a></dt>
<dd><p>Return the acquisition scene coverage as given by H.T(1), normalized
so that its integral over the sky is the number of detectors times
the duration of the acquisition.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_detector_integration_operator">
<span class="sig-name descname"><span class="pre">get_detector_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_detector_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_detector_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in detector solid angles.
Convert W / sr into W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_detector_response_operator">
<span class="sig-name descname"><span class="pre">get_detector_response_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_detector_response_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_detector_response_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator for the bolometer responses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_diag_invntt_operator">
<span class="sig-name descname"><span class="pre">get_diag_invntt_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_diag_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_diag_invntt_operator" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_distribution_operator">
<span class="sig-name descname"><span class="pre">get_distribution_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_distribution_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_distribution_operator" title="Link to this definition"></a></dt>
<dd><p>Return the MPI distribution operator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_filter_operator">
<span class="sig-name descname"><span class="pre">get_filter_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_filter_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_filter_operator" title="Link to this definition"></a></dt>
<dd><p>Return the filter operator.
Convert units from W/Hz to W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_hitmap">
<span class="sig-name descname"><span class="pre">get_hitmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nside</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_hitmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_hitmap" title="Link to this definition"></a></dt>
<dd><p>Return a healpy map whose values are the number of times a pointing
hits the pixel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_hwp_operator">
<span class="sig-name descname"><span class="pre">get_hwp_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_hwp_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_hwp_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator for the bolometer responses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_invntt_operator">
<span class="sig-name descname"><span class="pre">get_invntt_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_invntt_operator" title="Link to this definition"></a></dt>
<dd><p>Return the inverse time-time noise correlation matrix as an Operator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_noise" title="Link to this definition"></a></dt>
<dd><p>Return the noise realization according the instruments noise model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Placeholder for the output noise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_observation">
<span class="sig-name descname"><span class="pre">get_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_observation" title="Link to this definition"></a></dt>
<dd><p>tod = map2tod(acquisition, map)
tod, convolved_map = map2tod(acquisition, map, convolution=True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> (<em>I</em><em>, </em><em>QU</em><em> or </em><em>IQU maps</em>)  Temperature, QU or IQU maps of shapes npix, (npix, 2), (npix, 3)
with npix = 12 * nside**2</p></li>
<li><p><strong>noiseless</strong> (<em>boolean</em><em>, </em><em>optional</em>)  If True, no noise is added to the observation.</p></li>
<li><p><strong>convolution</strong> (<em>boolean</em><em>, </em><em>optional</em>)  Set to True to convolve the input map by a gaussian and return it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tod</strong> (<em>array</em>)  The Time-Ordered-Data of shape (ndetectors, ntimes).</p></li>
<li><p><strong>convolved_map</strong> (<em>array, optional</em>)  The convolved map, if the convolution keyword is set.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_operator">
<span class="sig-name descname"><span class="pre">get_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator of the acquisition. Note that the operator is only
linear if the scene temperature is differential (absolute=False).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_polarizer_operator">
<span class="sig-name descname"><span class="pre">get_polarizer_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_polarizer_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_polarizer_operator" title="Link to this definition"></a></dt>
<dd><p>Return operator for the polarizer grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_preconditioner">
<span class="sig-name descname"><span class="pre">get_preconditioner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_preconditioner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_preconditioner" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_projection_operator">
<span class="sig-name descname"><span class="pre">get_projection_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_projection_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_projection_operator" title="Link to this definition"></a></dt>
<dd><p>Return the projection operator for the peak sampling.
Convert units from W to W/sr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>)  If true, display information about the memory allocation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_subtract_grids_operator">
<span class="sig-name descname"><span class="pre">get_subtract_grids_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_subtract_grids_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_subtract_grids_operator" title="Link to this definition"></a></dt>
<dd><p>Return operator to subtract signal from detector pairs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.get_unit_conversion_operator">
<span class="sig-name descname"><span class="pre">get_unit_conversion_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.get_unit_conversion_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.get_unit_conversion_operator" title="Link to this definition"></a></dt>
<dd><p>Convert sky temperature into W / m^2 / Hz.</p>
<p>If the scene has been initialised with the absolute keyword, the
scene is assumed to include the CMB background and the fluctuations
(in Kelvin) and the operator follows the non-linear Planck law.
Otherwise, the scene only includes the fluctuations (in microKelvin)
and the operator is linear (i.e. the output also corresponds to power
fluctuations).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicAcquisition.tod2map">
<span class="sig-name descname"><span class="pre">tod2map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicAcquisition.tod2map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicAcquisition.tod2map" title="Link to this definition"></a></dt>
<dd><p>Reconstruct map from tod</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.acquisition.QubicPlanckAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.acquisition.</span></span><span class="sig-name descname"><span class="pre">QubicPlanckAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planck</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicPlanckAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicPlanckAcquisition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The QubicPlanckAcquisition class, which combines the Qubic and Planck
acquisitions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicPlanckAcquisition.get_invntt_operator">
<span class="sig-name descname"><span class="pre">get_invntt_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicPlanckAcquisition.get_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicPlanckAcquisition.get_invntt_operator" title="Link to this definition"></a></dt>
<dd><p>Return the inverse covariance matrix of the fused observation
as an operator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicPlanckAcquisition.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicPlanckAcquisition.get_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicPlanckAcquisition.get_noise" title="Link to this definition"></a></dt>
<dd><p>Return a noise realization compatible with the fused noise
covariance matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicPlanckAcquisition.get_observation">
<span class="sig-name descname"><span class="pre">get_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicPlanckAcquisition.get_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicPlanckAcquisition.get_observation" title="Link to this definition"></a></dt>
<dd><p>Return the fused observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>noiseless</strong> (<em>boolean</em><em>, </em><em>optional</em>)  If set, return a noiseless observation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.acquisition.QubicPlanckAcquisition.get_operator">
<span class="sig-name descname"><span class="pre">get_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/acquisition.html#QubicPlanckAcquisition.get_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.acquisition.QubicPlanckAcquisition.get_operator" title="Link to this definition"></a></dt>
<dd><p>Return the fused observation as an operator.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-qubic.beams">
<span id="qubic-beams-module"></span><h2>qubic.beams module<a class="headerlink" href="#module-qubic.beams" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.beams.BeamFitted">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.beams.</span></span><span class="sig-name descname"><span class="pre">BeamFitted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/beams.html#BeamFitted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.beams.BeamFitted" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Beam</span></code></p>
<dl class="simple">
<dt>Axisymmetric fitted beam.</dt><dd><p>Warning: The nu dependence of the beam and the solid angle are not well approximated in the 220 GHz band</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.beams.BeamGaussian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.beams.</span></span><span class="sig-name descname"><span class="pre">BeamGaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/beams.html#BeamGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.beams.BeamGaussian" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Beam</span></code></p>
<p>Axisymmetric gaussian beam.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.beams.MultiFreqBeam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.beams.</span></span><span class="sig-name descname"><span class="pre">MultiFreqBeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parfr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parbeam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xspl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/beams.html#MultiFreqBeam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.beams.MultiFreqBeam" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Beam</span></code></p>
<p>spline fitted multifrequency beam</p>
</dd></dl>

</section>
<section id="module-qubic.calibration">
<span id="qubic-calibration-module"></span><h2>qubic.calibration module<a class="headerlink" href="#module-qubic.calibration" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.calibration.QubicCalibration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.calibration.</span></span><span class="sig-name descname"><span class="pre">QubicCalibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/donnachao/miniconda3/envs/venv-qubic/lib/python3.9/site-packages/qubic/calfiles/'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/calibration.html#QubicCalibration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.calibration.QubicCalibration" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class representing the QUBIC calibration tree. It stores the calibration
file names and hardcoded values and provides access to them.
If the path name of a calibration file is relative, it is first searched
relatively to the working directory and if not found, in the calibration
path.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.calibration.QubicCalibration.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/calibration.html#QubicCalibration.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.calibration.QubicCalibration.get" title="Link to this definition"></a></dt>
<dd><p>Access calibration files.
:param name:</p>
<blockquote>
<div><dl class="simple">
<dt>One of the following:</dt><dd><ul class="simple">
<li><p>detarray</p></li>
<li><p>hornarray</p></li>
<li><p>optics</p></li>
<li><p>primbeam</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qubic.camb_interface">
<span id="qubic-camb-interface-module"></span><h2>qubic.camb_interface module<a class="headerlink" href="#module-qubic.camb_interface" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.Dl2Cl_without_monopole">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">Dl2Cl_without_monopole</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">totDL</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#Dl2Cl_without_monopole"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.Dl2Cl_without_monopole" title="Link to this definition"></a></dt>
<dd><p>Go from Dls to Cls.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.bin_camblib">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">bin_camblib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Namaster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_unbinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#bin_camblib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.bin_camblib" title="Link to this definition"></a></dt>
<dd><p>Bin the spectra using Namaster.
:param Namaster:
:param filename:
:param nside:
:param verbose:
:param return_unbinned:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.cell_2_ctheta">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">cell_2_ctheta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#cell_2_ctheta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.cell_2_ctheta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.ctheta_2_cell">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">ctheta_2_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#ctheta_2_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.ctheta_2_cell" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.get_Dl_fromlib">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">get_Dl_fromlib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlensed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#get_Dl_fromlib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.get_Dl_fromlib" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.get_camb_Dl">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">get_camb_Dl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">67.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ombh2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.022</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omch2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.122</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">As</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2e-09</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.965</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#get_camb_Dl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.get_camb_Dl" title="Link to this definition"></a></dt>
<dd><p>Inspired from: <a class="reference external" href="https://camb.readthedocs.io/en/latest/CAMBdemo.html">https://camb.readthedocs.io/en/latest/CAMBdemo.html</a>
NB: this returns Dl = l(l+1)Cl/2pi
Python CL arrays are all zero based (starting at l=0), Note l=0,1 entries will be zero by default.
The different DL are always in the order TT, EE, BB, TE (with BB=0 for unlensed scalar results).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.rcamblib">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">rcamblib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rvalues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#rcamblib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.rcamblib" title="Link to this definition"></a></dt>
<dd><p>Make CAMB library</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.read_camblib">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">read_camblib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#read_camblib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.read_camblib" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.camb_interface.simulate_correlated_map">
<span class="sig-prename descclassname"><span class="pre">qubic.camb_interface.</span></span><span class="sig-name descname"><span class="pre">simulate_correlated_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signoise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax_nside</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_alm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">myiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synfast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/camb_interface.html#simulate_correlated_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.camb_interface.simulate_correlated_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-qubic.cl">
<span id="qubic-cl-module"></span><h2>qubic.cl module<a class="headerlink" href="#module-qubic.cl" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.cl.camb_spectra">
<span class="sig-prename descclassname"><span class="pre">qubic.cl.</span></span><span class="sig-name descname"><span class="pre">camb_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmax</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/cl.html#camb_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.cl.camb_spectra" title="Link to this definition"></a></dt>
<dd><p>Wrapper around <cite>pycamb.camb</cite>. Return Cl_TT, Cl_EE, Cl_BB, Cl_EB
non-weighted by l(l+1)/2pi, starting from l=0.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.cl.plot_spectra">
<span class="sig-prename descclassname"><span class="pre">qubic.cl.</span></span><span class="sig-name descname"><span class="pre">plot_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/cl.html#plot_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.cl.plot_spectra" title="Link to this definition"></a></dt>
<dd><p>Plot Cl power spectra as l(l+1)Cl/2pi Cl.</p>
<p>plot_spectra([ell,] spectra)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ell</strong> (<em>integer array</em><em>, </em><em>optional</em>)  The l values of the spectra. If not provided, it is assumed that
the Cls start from 0 and are not binned.</p></li>
<li><p><strong>spectra</strong> (<em>array-like</em><em>, </em><em>4-tuple</em><em> or </em><em>6-tuple</em>)  The Cl spectrum or the TT, EE, BB and TE or TT, EE, BB, TE, EB, TB
Cl spectra.</p></li>
<li><p><strong>Dl</strong> (<em>boolean</em><em>, </em><em>optional</em>)  Use <cite>D_l</cite> as label instead of <cite>l(l+1)Cl/2pi</cite>.</p></li>
<li><p><strong>lmax</strong> (<em>integer</em>)  Plot upper x limit.</p></li>
<li><p><strong>xerr</strong> (<em>array-like</em>)  If set, the function <cite>errorbar</cite> is called instead of <cite>plot</cite>.</p></li>
<li><p><strong>yerr</strong> (<em>array-like</em>)  If set, the function <cite>errorbar</cite> is called instead of <cite>plot</cite>.</p></li>
<li><p><strong>loc</strong> (<em>string</em>)  keyword passed to <cite>legend</cite> if there is more than one input spectrum.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.cl.read_spectra">
<span class="sig-prename descclassname"><span class="pre">qubic.cl.</span></span><span class="sig-name descname"><span class="pre">read_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/cl.html#read_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.cl.read_spectra" title="Link to this definition"></a></dt>
<dd><p>Read a camb-generated Cl file using the parameters from
Planck 2013 results XV. CMB Power spectra, table 8, Planck+WP,
Archiv 1303.5075:</p>
<blockquote>
<div><p>H0=67.04
omegab=0.022032 / (H0 / 100)**2
omegac=0.12038 / (H0 / 100)**2
omegak=0
scalar_index=0.9624
reion__use_optical_depth=True
reion__optical_depth=0.0925
WantTensors=True
scalar_amp=np.exp(3.098) * 1e-10
DoLensing=False</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> (<em>float</em>)  The tensor-to-scalar ratio (available values are: 0, 0.001, 0.002,
0.005, 0.01, 0.02, 0.05, 0.1, 0.2).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>C_TT, C_EE, C_BB, C_TE</strong>  The power spectra for the T-T, E-E, T-E and T-E correlations,
not weighted by l(l+1)/2pi, starting from l=0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>4-tuple of ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.cl.semilogy_spectra">
<span class="sig-prename descclassname"><span class="pre">qubic.cl.</span></span><span class="sig-name descname"><span class="pre">semilogy_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/cl.html#semilogy_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.cl.semilogy_spectra" title="Link to this definition"></a></dt>
<dd><p>Plot Cl power spectra as sqrt(l(l+1)Cl/2pi) Cl with log scaling
on the y axis.</p>
<p>semilogy_spectra([ell,] spectra)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ell</strong> (<em>integer array</em><em>, </em><em>optional</em>)  The l values of the spectra. If not provided, it is assumed that
the Cls start from 0 and are not binned.</p></li>
<li><p><strong>spectra</strong> (<em>array-like</em><em>, </em><em>4-tuple</em><em> or </em><em>6-tuple</em>)  The Cl spectrum or the TT, EE, BB and TE or TT, EE, BB, TE, EB, TB
Cl spectra.</p></li>
<li><p><strong>Dl</strong> (<em>boolean</em><em>, </em><em>optional</em>)  Use <cite>D_l</cite> as label instead of <cite>l(l+1)Cl/2pi</cite>.</p></li>
<li><p><strong>lmax</strong> (<em>integer</em>)  Plot upper x limit.</p></li>
<li><p><strong>loc</strong> (<em>string</em>)  keyword passed to <cite>legend</cite> if there is more than one input spectrum.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-qubic.compact_sources_sed">
<span id="qubic-compact-sources-sed-module"></span><h2>qubic.compact_sources_sed module<a class="headerlink" href="#module-qubic.compact_sources_sed" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.build_catalog">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">build_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'All'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs_ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'All'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#build_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.build_catalog" title="Link to this definition"></a></dt>
<dd><p>This function builds a dictionary containing the main parameters of the compact sources
contained in the PCCS</p>
<p>Input
freqs       - LIST  - List of frequencies in the catalog (Default</p>
<blockquote>
<div><p>[030,044,070,100,143,217,353])</p>
</div></blockquote>
<dl class="simple">
<dt>freqs_ex     - LIST - List of frequencies of excluded catalogs (Default</dt><dd><p>[100,143,217,353])</p>
</dd>
</dl>
<p>excluded     - BOOL - Whether to include the excluded catalogs (Default: True)</p>
<p>Output
catalog      - DICT - Dictionary containing the data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.build_name">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">build_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#build_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.build_name" title="Link to this definition"></a></dt>
<dd><p>This function builds a source name from the PCCS name by rounding l and b to the first decimal place</p>
<p>Input
name         - STRING - source name as defined in the PCCS (Glll.llbb.bb)</p>
<p>Output
new_name     - STRING - source new name defined as lll.lbb.b</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.build_sed">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">build_sed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#build_sed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.build_sed" title="Link to this definition"></a></dt>
<dd><p>This function builds the SED of a given source</p>
<p>Input
source       - STRING - The source name, either in the stanard lll.llbb.bb format or in the common</p>
<blockquote>
<div><p>name format if a translation is available (e.g. Crab)</p>
</div></blockquote>
<p>catalog      - DICT - The dictionary with the source catalog</p>
<p>plot         - BOOL - Whether to plot intensity and polarized fluxes. Default: False</p>
<p>polyfit      - INT  - Order of the polynomial fit. Default: 3</p>
<p>Output
SED          - DICT - Dictionary containing the SED (frequencies, measured I_flux, measured P_flux</p>
<blockquote>
<div><p>4th order polinomial fits to measured I_flux and P_flux</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.build_sed_allfreqs">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">build_sed_allfreqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['030',</span> <span class="pre">'044',</span> <span class="pre">'070',</span> <span class="pre">'100',</span> <span class="pre">'143',</span> <span class="pre">'217',</span> <span class="pre">'353']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#build_sed_allfreqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.build_sed_allfreqs" title="Link to this definition"></a></dt>
<dd><p>This function builds the SED of the sources in the catalog using data across frequencies specified
in freqs</p>
<p>Input
catalog      - DICT - The dictionary with the source catalog</p>
<p>freqs        - LIST - List of frequencies (Default [030, 044, 070, 100,143,217,353])</p>
<p>Output
SED          - DICT - Dictionary containing the SED (frequencies, measured I_flux, measured P_flux</p>
<blockquote>
<div><p>4th order polinomial fits to measured I_flux and P_flux</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.duplicate_source">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">duplicate_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_namelist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#duplicate_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.duplicate_source" title="Link to this definition"></a></dt>
<dd><p>This function finds if a given source is a duplicate of others already found in catalogs
relative to other frequencies by checking the distance in GLON and GLAT</p>
<p>Input
name                   - STRING       - source name modified by the catalog building routine</p>
<blockquote>
<div><p>(Glll.lbb.b)</p>
</div></blockquote>
<dl class="simple">
<dt>global_namelist        - LIST         - list of modified names of sources already loaded from other</dt><dd><p>frequency catalogs</p>
</dd>
<dt>threshold              - FLOAT        - maximum distance in degrees to decide whether two sources</dt><dd><p>coincide (Default threshold = 0.1)</p>
</dd>
</dl>
<p>Output
isduplicate, new_name  - BOOL, STRING - whether a duplicate has been found, new name</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.isincatalog">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">isincatalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#isincatalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.isincatalog" title="Link to this definition"></a></dt>
<dd><p>This function checks if a certain source is in the catalog and returns the list of
frequencies where the source has data</p>
<p>INPUT
source     -  STR - The source name. It can be in human-comprehensible form (e.g.</p>
<blockquote>
<div><p>Crab) or in the catalog format (e.g. 209.0-19.4)</p>
</div></blockquote>
<p>catalog    - DICT - The dictionary with point source catalog</p>
<p>OUTPUT
isincatalog, source, freqs - BOOL, STR, LIST -</p>
<blockquote>
<div><ul class="simple">
<li><p>isincatalog tells if the source is present (True) or not (False)</p></li>
<li><p>source is the source name in the catalog format</p></li>
<li><p>freqs is the list of frequencies where the source is present
in the catalog</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.name2cat">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">name2cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altnames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#name2cat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.name2cat" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.compact_sources_sed.source2freqs">
<span class="sig-prename descclassname"><span class="pre">qubic.compact_sources_sed.</span></span><span class="sig-name descname"><span class="pre">source2freqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'Crab':</span> <span class="pre">'184.5-05.8',</span> <span class="pre">'Orion':</span> <span class="pre">'209.0-19.4',</span> <span class="pre">'RCW38':</span> <span class="pre">'267.9-01.1'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/compact_sources_sed.html#source2freqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.compact_sources_sed.source2freqs" title="Link to this definition"></a></dt>
<dd><p>This function return the list of frequencies in the catalog given a certain source</p>
<p>Input
source       - STRING - The source name, either in the stanard lll.llbb.bb format or in the common</p>
<blockquote>
<div><p>name format if a translation is available (e.g. Crab)</p>
</div></blockquote>
<p>catalog      - DICT   - The PCCS in Qubic format</p>
<dl class="simple">
<dt>altnames     - DICT   - The correspondence between common name and catalog standard name (Defaults to</dt><dd><p>altnames defined at the top of the notebook)</p>
</dd>
</dl>
<p>Output
freqlist     - LIST - List of frequencies where a source is found</p>
</dd></dl>

</section>
<section id="module-qubic.demodulation_lib">
<span id="qubic-demodulation-lib-module"></span><h2>qubic.demodulation_lib module<a class="headerlink" href="#module-qubic.demodulation_lib" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.CalSrcPowerMeterResponse_Vs_Nu">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">CalSrcPowerMeterResponse_Vs_Nu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#CalSrcPowerMeterResponse_Vs_Nu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.CalSrcPowerMeterResponse_Vs_Nu" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.CalSrcPower_Vs_Nu">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">CalSrcPower_Vs_Nu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#CalSrcPower_Vs_Nu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.CalSrcPower_Vs_Nu" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.demodulation_lib.MySpl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">MySpl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbspl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#MySpl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.MySpl" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A spline class to be used for fitting
Example:
npts = 55
xx = np.random.rand(npts)*10
yy = 2*xx**3 - 1*xx**2 +7*xx - 1
dy = np.zeros(npts)+30
errorbar(xx, yy,yerr=dy, fmt=ro)</p>
<p>xxx = np.linspace(0,10,1000)
nx = 10
myspl = MySpl(xxx,nx)</p>
<p>guess = guess=np.zeros(myspl.nbspl)
res = ft.do_minuit(xx, yy, dy, guess,</p>
<blockquote>
<div><p>functname=myspl, verbose=False,nohesse=True, force_chi2_ndf=False)</p>
</div></blockquote>
<p>plot(xxx, myspl(xxx, res[1]))</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.demodulation_lib.MySpl.get_spline">
<span class="sig-name descname"><span class="pre">get_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#MySpl.get_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.MySpl.get_spline" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.demodulation_lib.SimSrcTOD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">SimSrcTOD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbspl_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbspl_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbspl_phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#SimSrcTOD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.SimSrcTOD" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to simulate the TOD signal when modulating with the source
The main signal will be that of the source (simulated)
It is modulated by a slowly varying spline for amplitude, offset and phase
each with a given number of spline nodes</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.demodulation_lib.SimSrcTOD.amplitude">
<span class="sig-name descname"><span class="pre">amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#SimSrcTOD.amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.SimSrcTOD.amplitude" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.demodulation_lib.SimSrcTOD.offset">
<span class="sig-name descname"><span class="pre">offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#SimSrcTOD.offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.SimSrcTOD.offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.demodulation_lib.SimSrcTOD.phase">
<span class="sig-name descname"><span class="pre">phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#SimSrcTOD.phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.SimSrcTOD.phase" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.array_info">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">array_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#array_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.array_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.bin_image_elscans">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">bin_image_elscans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TESIndex</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#bin_image_elscans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.bin_image_elscans" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.bin_per_period">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">bin_per_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#bin_per_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.bin_per_period" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.coadd_flatmap">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">coadd_flatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_eltrend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#coadd_flatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.coadd_flatmap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.dB">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">dB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#dB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.dB" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.demodulate_JC">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">demodulate_JC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indata_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#demodulate_JC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.demodulate_JC" title="Link to this definition"></a></dt>
<dd><p>Proper demodulation with quadrature method as an option: <a class="reference external" href="http://web.mit.edu/6.02/www/s2012/handouts/14.pdf">http://web.mit.edu/6.02/www/s2012/handouts/14.pdf</a>
In the case of quadrature demodulation, the HF noise RMS/sqrt(2) adds to the demodulated.
The option remove_noise=True
estimates the HF noise in the TODs and removes it from the estimate in order to attempt to debias.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.demodulate_directory">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">demodulate_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thedir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ppp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TESmask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srcshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rms'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#demodulate_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.demodulate_directory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.demodulate_methods">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">demodulate_methods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fourier_cuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_data_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'demod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#demodulate_methods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.demodulate_methods" title="Link to this definition"></a></dt>
<dd><p>Various demodulation methods
Others is a list of other vectors (with similar time sampling as the data to demodulate)
that we need to sample the same way as the data.
____
To filter the data before demodulation give the array fourier_cuts = [lowcut, highcut, notch].
If both lowcut and highcut are given, a bandpass filter is applied.
If lowcut is given but highcut = None, a highpass filter at f_cut = lowcut is applied.
If highcut is given but lowcut = None, a lowpass filter at f_cut = highcut is applied.
If none of them is given, no cut frequency filter is applied.
In any case notch filter can still be used. If notch = None, notch filter is not applied.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.demodulate_old">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">demodulate_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#demodulate_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.demodulate_old" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.fit_ang_gauss">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">fit_ang_gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#fit_ang_gauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.fit_ang_gauss" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.fit_sb">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">fit_sb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TESNum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirfiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">140000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#fit_sb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.fit_sb" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.fit_sb_asym">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">fit_sb_asym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TESNum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirfiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">140000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#fit_sb_asym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.fit_sb_asym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.fitperiod">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">fitperiod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fct</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#fitperiod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.fitperiod" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.flattened_qubic_sb_model">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">flattened_qubic_sb_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#flattened_qubic_sb_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.flattened_qubic_sb_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.flattened_qubic_sb_model_asym">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">flattened_qubic_sb_model_asym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#flattened_qubic_sb_model_asym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.flattened_qubic_sb_model_asym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.gauss">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#gauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.gauss" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.gauss_line">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">gauss_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#gauss_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.gauss_line" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.general_demodulate">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">general_demodulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'demod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">renormalize_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#general_demodulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.general_demodulate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.get_spectral_response">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">get_spectral_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allmm_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allss_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'demod'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TESNum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/hamilton/Qubic/Calib-TD/SpectralResponse/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#get_spectral_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.get_spectral_response" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.hf_noise_estimate">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">hf_noise_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#hf_noise_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.hf_noise_estimate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.hwp_fitpol">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">hwp_fitpol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ampvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ampvals_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saturation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">myguess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_chi2_ndf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#hwp_fitpol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.hwp_fitpol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.hwp_fitpol_MCMC">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">hwp_fitpol_MCMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ampvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ampvals_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saturation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">myguess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_chi2_ndf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">myrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upperlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savecontour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#hwp_fitpol_MCMC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.hwp_fitpol_MCMC" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.hwp_sin">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">hwp_sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#hwp_sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.hwp_sin" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.hwp_sin_sat">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">hwp_sin_sat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#hwp_sin_sat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.hwp_sin_sat" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.demodulation_lib.interp_template">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">interp_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#interp_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.interp_template" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Allows to interpolate a template applying an amplitude, offset and phase
This si to be used in order to fit this template in each epriod of some pseudo-periodic signal
For instance for demodulation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.make_tod">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">make_tod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#make_tod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.make_tod" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.mygauss2d">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">mygauss2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#mygauss2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.mygauss2d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.printnow">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">printnow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">truc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#printnow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.printnow" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.qubic_sb_model">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">qubic_sb_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#qubic_sb_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.qubic_sb_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.qubic_sb_model_asym">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">qubic_sb_model_asym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#qubic_sb_model_asym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.qubic_sb_model_asym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.read_cal_src_data">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">read_cal_src_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#read_cal_src_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.read_cal_src_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.read_data_azel_src">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">read_data_azel_src</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AsicNum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TESNum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calsource_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/qubic/Data/Calib-TD/calsource/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#read_data_azel_src"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.read_data_azel_src" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.renorm">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">renorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#renorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.renorm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.return_fit_period">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">return_fit_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#return_fit_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.return_fit_period" title="Link to this definition"></a></dt>
<dd><p>Returns the amplitude, offset and phase of a template fit to the data in each period
the parameter called others contains a (n,nsamples) array of vectors to be averaged in each new bin (convenient
if you also have azimuth, elevation or any other stuff).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.return_rms_period">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">return_rms_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#return_rms_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.return_rms_period" title="Link to this definition"></a></dt>
<dd><p>Returns the RMS in each period - not such a good proxy for demondulation but robust and does not need the
modulation signal as an input.
Main drawback: you end up with a combination of the noise + signal =&gt; more an upper-limit to the signal
the parameter called others contains a (n, nsamples) array of vectors to be averaged in each new bin (convenient
if you also have azimuth, elevation or any other stuff).
The option remove_noise, if true measures the HF noise in the TODs and removes it from the RMS in order to
attempt to debias the result from HF noise</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.scan2ang_RMS">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">scan2ang_RMS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#scan2ang_RMS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.scan2ang_RMS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.scan2ang_demod">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">scan2ang_demod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#scan2ang_demod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.scan2ang_demod" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.scan2ang_splfit">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">scan2ang_splfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elevation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superbinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#scan2ang_splfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.scan2ang_splfit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.scan2hpmap">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">scan2hpmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azdeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eldeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#scan2hpmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.scan2hpmap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.demodulation_lib.sigmoid_saturation">
<span class="sig-prename descclassname"><span class="pre">qubic.demodulation_lib.</span></span><span class="sig-name descname"><span class="pre">sigmoid_saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/demodulation_lib.html#sigmoid_saturation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.demodulation_lib.sigmoid_saturation" title="Link to this definition"></a></dt>
<dd><p>This si the common sigmoid function modified to have a slope equals to 1 at zero whatever the value
of the lambda parameter. Then if lambda =</p>
</dd></dl>

</section>
<section id="module-qubic.fibtools">
<span id="qubic-fibtools-module"></span><h2>qubic.fibtools module<a class="headerlink" href="#module-qubic.fibtools" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.fibtools.Chi2Implement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">Chi2Implement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covarin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#Chi2Implement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.Chi2Implement" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qubic.fibtools.Chi2Minimizer" title="qubic.fibtools.Chi2Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chi2Minimizer</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.fibtools.Chi2Minimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">Chi2Minimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covarin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#Chi2Minimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.Chi2Minimizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parent classes with the model to minimize</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.fibtools.MyChi2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">MyChi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covarin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#MyChi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.MyChi2" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining the minimizer and the data</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.fibtools.MyChi2_nocov">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">MyChi2_nocov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invcovarin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#MyChi2_nocov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.MyChi2_nocov" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining the minimizer and the data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.butter_bandpass">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">butter_bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lowcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#butter_bandpass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.butter_bandpass" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lowcut</strong> (<em>scalar</em>)  </p></li>
<li><p><strong>highcut</strong> (<em>scalar</em>)  </p></li>
<li><p><strong>fs</strong>  </p></li>
<li><p><strong>order</strong> (<em>int</em>)  order of the filter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>b, a</strong>  Numerator (b) and denominator (a) polynomials of the IIR filter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ndarray, ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.butter_bandpass_filter">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">butter_bandpass_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#butter_bandpass_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.butter_bandpass_filter" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array like</em>)  </p></li>
<li><p><strong>lowcut</strong>  </p></li>
<li><p><strong>highcut</strong>  </p></li>
<li><p><strong>fs</strong>  </p></li>
<li><p><strong>order</strong>  </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong>  The output of the digital filter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.calibrate">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">calibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow_maynooth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allok</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuterr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.calibrate" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fib</strong>  </p></li>
<li><p><strong>pow_maynooth</strong>  </p></li>
<li><p><strong>allparams</strong>  </p></li>
<li><p><strong>allerr</strong>  </p></li>
<li><p><strong>allok</strong>  </p></li>
<li><p><strong>cutparam</strong>  </p></li>
<li><p><strong>cuterr</strong>  </p></li>
<li><p><strong>bootstrap</strong>  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.do_minuit">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">do_minuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covarin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functname=&lt;function</span> <span class="pre">thepolynomial&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixpars=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi2=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rangepars=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nohesse=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_chi2_ndf=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minos=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_level=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_diag=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsplit=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncallmax=10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#do_minuit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.do_minuit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.exponential_filter1d">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">exponential_filter1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#exponential_filter1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.exponential_filter1d" title="Link to this definition"></a></dt>
<dd><p>One-dimensional Exponential filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong>  </p></li>
<li><p><strong>sigma</strong> (<em>scalar</em>)  Tau of exponential kernel</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  The axis of input along which to calculate.
Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>)  The array in which to place the output, or the dtype of the returned array.
By default an array of the same dtype as input will be created.</p></li>
<li><p><strong>mode</strong> (<em>{reflect</em><em>, </em><em>constant</em><em>, </em><em>nearest</em><em>, </em><em>mirror</em><em>, </em><em>wrap}</em><em>, </em><em>optional</em>)  The mode parameter determines how the input array is extended beyond its boundaries.
Default is reflect.</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>)  Value to fill past edges of input if mode is constant. Default is 0.0.</p></li>
<li><p><strong>truncate</strong> (<em>float</em>)  Truncate the filter at this many standard deviations.
Default is 4.0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.filter_data">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">filter_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#filter_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.filter_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.fit_all">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">fit_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">t,</span> <span class="pre">folded,</span> <span class="pre">av,</span> <span class="pre">initpars=None,</span> <span class="pre">fixpars=[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">stop_each=False,</span> <span class="pre">functname=&lt;function</span> <span class="pre">simsig&gt;,</span> <span class="pre">rangepars=None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#fit_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.fit_all" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong>  </p></li>
<li><p><strong>folded</strong>  </p></li>
<li><p><strong>av</strong>  </p></li>
<li><p><strong>initpars</strong>  </p></li>
<li><p><strong>fixpars</strong>  </p></li>
<li><p><strong>stop_each</strong>  </p></li>
<li><p><strong>functname</strong>  </p></li>
<li><p><strong>rangepars</strong>  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.fit_average">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">fit_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">t,</span> <span class="pre">folded,</span> <span class="pre">fff,</span> <span class="pre">dc,</span> <span class="pre">fib,</span> <span class="pre">Vtes,</span> <span class="pre">initpars=None,</span> <span class="pre">fixpars=[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">doplot=True,</span> <span class="pre">functname=&lt;function</span> <span class="pre">simsig&gt;,</span> <span class="pre">clear=True,</span> <span class="pre">name='fib'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#fit_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.fit_average" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong>  </p></li>
<li><p><strong>folded</strong>  </p></li>
<li><p><strong>fff</strong> (<em>float</em>)  Modulation frequency of the external source.</p></li>
<li><p><strong>dc</strong> (<em>float</em>)  Duty cycle of the modulation.</p></li>
<li><p><strong>fib</strong>  </p></li>
<li><p><strong>Vtes</strong>  </p></li>
<li><p><strong>initpars</strong>  </p></li>
<li><p><strong>fixpars</strong>  </p></li>
<li><p><strong>doplot</strong> (<em>bool</em>)  If true make the plot.</p></li>
<li><p><strong>functname</strong>  </p></li>
<li><p><strong>clear</strong> (<em>bool</em>)  If true, clear the window before plotting.</p></li>
<li><p><strong>name</strong>  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.fold_data">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">fold_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_noise_harmonics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#fold_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.fold_data" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>array</em>)  </p></li>
<li><p><strong>dd</strong> (<em>array</em>)  Data signal.</p></li>
<li><p><strong>period</strong> (<em>float</em>)  Data will be folded on this period.</p></li>
<li><p><strong>lowcut</strong> (<em>If highcut is given but no</em>)  Low cut for the filter.</p></li>
<li><p><strong>highcut</strong> (<em>If lowcut is given but no</em>)  High cut for the filter.</p></li>
<li><p><strong>given</strong> (<em>If none</em><em> of </em><em>them is</em>)  </p></li>
<li><p><strong>applied.</strong> (<em>no cut frequency filter is</em>)  </p></li>
<li><p><strong>highcut</strong>  </p></li>
<li><p><strong>applied.</strong>  </p></li>
<li><p><strong>lowcut</strong>  </p></li>
<li><p><strong>applied.</strong>  </p></li>
<li><p><strong>given</strong>  </p></li>
<li><p><strong>applied.</strong>  </p></li>
<li><p><strong>used.</strong> (<em>In any case notch filter can still be</em>)  </p></li>
<li><p><strong>nbins</strong>  </p></li>
<li><p><strong>notch</strong>  </p></li>
<li><p><strong>return_error</strong>  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.image_asics">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">image_asics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#image_asics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.image_asics" title="Link to this definition"></a></dt>
<dd><p>Return an image of detectors on the focal plane.
Each asic has 124 TES and 4 thermometers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong>  </p></li>
<li><p><strong>data2</strong>  </p></li>
<li><p><strong>all1</strong> (<em>array</em>)  signal from 2 asics (256 detectors)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.isfloat">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">isfloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#isfloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.isfloat" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.meancut">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">meancut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">med</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#meancut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.meancut" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array like</em>)  </p></li>
<li><p><strong>nsig</strong> (<em>float</em>)  Lower and upper bound factor of sigma clipping.</p></li>
<li><p><strong>med</strong> (<em>bool</em>)  If True, perform the median and not the mean.</p></li>
<li><p><strong>disp</strong> (<em>bool</em>)  If True, return the dispersion (STD),
if False, return the error on the mean (STD/sqrt(N))</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean/median and the dispersion/error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.notch_array">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">notch_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#notch_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.notch_array" title="Link to this definition"></a></dt>
<dd><p>Returns array to be used with notch_filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freqs</strong> (<em>list</em>)  Frequencies to filter</p></li>
<li><p><strong>bw</strong> (<em>scalar</em>)  The filter bandwidth</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.notch_filter">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">notch_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#notch_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.notch_filter" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong>  </p></li>
<li><p><strong>f0</strong>  </p></li>
<li><p><strong>bw</strong>  </p></li>
<li><p><strong>fs</strong>  </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong>  Output of the notch filter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.power_spectrum">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#power_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.power_spectrum" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.printnow">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">printnow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">truc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#printnow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.printnow" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.profile">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutbad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin_as_well</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.profile" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.qgrid">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">qgrid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#qgrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.qgrid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.qs2array">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">qs2array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FREQ_SAMPLING</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timerange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#qs2array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.qs2array" title="Link to this definition"></a></dt>
<dd><p>Loads qubic instance to create dd which is TOD for each TES
Also normalises raw data
Also returns time which is linear time array
Can also specify a timerange</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>directory containing the QubicStudio dataset</em>)  </p></li>
<li><p><strong>FREQ_SAMPLING</strong> (<em>this argument is kept for backwards compatibility</em>)  frequency sampling is given by the qubicpack qubicfp object</p></li>
<li><p><strong>timerange</strong> (<em>array</em>)  Time range, low and high boundaries</p></li>
<li><p><strong>Returns</strong> (<em>time array</em><em>, </em><em>data array</em><em>, </em><em>qubicfp object</em>)  </p></li>
<li><p><strong>-------</strong>  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.read_hkintern">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">read_hkintern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basedir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thefieldname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#read_hkintern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.read_hkintern" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basedir</strong> (<em>str</em>)  directory of the file</p></li>
<li><p><strong>thefieldname</strong> (<em>str</em>)  </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>newdate</strong> (<em>array</em>)  New time array of te measurement</p></li>
<li><p><strong>hk</strong> (<em>array</em>)  Angle position given by the encoder (number of encoder steps).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.run_asic">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">run_asic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vtes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reselect_ok</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nointeractive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lastpassallfree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fib'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">okfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timerange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removesat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_each</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rangepars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#run_asic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.run_asic" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpobj</strong> (<em>a qubicpack.qubicfp object</em>)  </p></li>
<li><p><strong>idnum</strong> (<em>fibre number</em>)  </p></li>
<li><p><strong>Vtes</strong> (<em>bias voltage</em><em> (</em><em>this is normally accessible in the qubicfp object</em><em>, </em><em>but maybe not for old data</em><em>)</em>)  </p></li>
<li><p><strong>fff</strong> (<em>float</em>)  Modulation frequency of the external source</p></li>
<li><p><strong>dc</strong> (<em>float</em>)  Duty cycle of the modulation</p></li>
<li><p><strong>asic</strong> (<em>the asic number</em><em> (</em><em>1</em><em> or </em><em>2</em><em>)</em>)  </p></li>
<li><p><strong>reselect_ok</strong> (<em>bool</em>)  If true, you will select the good TES one by one, if False, you will use the file created before.</p></li>
<li><p><strong>lowcut</strong>  </p></li>
<li><p><strong>highcut</strong>  </p></li>
<li><p><strong>nbins</strong>  </p></li>
<li><p><strong>nointeractive</strong>  </p></li>
<li><p><strong>doplot</strong>  </p></li>
<li><p><strong>notch</strong>  </p></li>
<li><p><strong>lastpassallfree</strong>  </p></li>
<li><p><strong>name</strong>  </p></li>
<li><p><strong>okfile</strong>  </p></li>
<li><p><strong>initpars</strong>  </p></li>
<li><p><strong>timerange</strong>  </p></li>
<li><p><strong>removesat</strong>  </p></li>
<li><p><strong>stop_each</strong>  </p></li>
<li><p><strong>rangepars</strong>  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.simsig">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">simsig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#simsig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.simsig" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>list</em>)  </p></li>
<li><p><strong>pars</strong> (<em>list</em>)  List with 4 parameters: cycle, ctime, initial time, amplitude</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A simulated signal.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.simsig_asym">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">simsig_asym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#simsig_asym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.simsig_asym" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.simsig_fringes">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">simsig_fringes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stable_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#simsig_fringes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.simsig_fringes" title="Link to this definition"></a></dt>
<dd><p>Simulate a TOD signal obtained during the fringe measurement.
This function was done to make a fit.
:param time: Time sampling.
:type time: array
:param stable_time: Stable time [s] on each step.
:type stable_time: float
:param params: ctime (constant time response of the detector), starting time, the 6 amplitudes.
:type params: list</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The simulated signal.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.simsig_nonorm">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">simsig_nonorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#simsig_nonorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.simsig_nonorm" title="Link to this definition"></a></dt>
<dd><p>Same as simsig but without normalisation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.statstr">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">statstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#statstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.statstr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.thepolynomial">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">thepolynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#thepolynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.thepolynomial" title="Link to this definition"></a></dt>
<dd><p>Generic polynomial function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.vec_interp">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">vec_interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yin</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#vec_interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.vec_interp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.fibtools.weighted_mean">
<span class="sig-prename descclassname"><span class="pre">qubic.fibtools.</span></span><span class="sig-name descname"><span class="pre">weighted_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fibtools.html#weighted_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fibtools.weighted_mean" title="Link to this definition"></a></dt>
<dd><p>Calculated the weighted mean of data, errors
If dispersion is True (default) the error on the mean comes from the RMS of the data, otherwise
the error on the weighted mean is analytically calculated from input errors</p>
</dd></dl>

</section>
<section id="module-qubic.fringes_lib">
<span id="qubic-fringes-lib-module"></span><h2>qubic.fringes_lib module<a class="headerlink" href="#module-qubic.fringes_lib" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.fringes_lib.</span></span><span class="sig-name descname"><span class="pre">FringesAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafolder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stable_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refTESnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refASICnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">False,</span> <span class="pre">False,</span> <span class="pre">True,</span> <span class="pre">False,</span> <span class="pre">True]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsp_per</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">240</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[1.724e+00,</span> <span class="pre">5.000e-03,</span> <span class="pre">1.000e+01]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction_bad_TES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_conv_astropy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_TES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.analyse_fringes">
<span class="sig-name descname"><span class="pre">analyse_fringes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_median_allh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ncycles_to_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_slope_percycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplotTESsort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.analyse_fringes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.analyse_fringes" title="Link to this definition"></a></dt>
<dd><p>Full analysis to get fringes from the TODs.
:param median:
:type median: bool
:param remove_median_allh:
:type remove_median_allh: bool
:param Ncycles_to_use: Number of cycles to use. If None, all cycles will be used.
:type Ncycles_to_use: int
:param rm_slope_percycle: If True, for each cycle, a slope on the steps where all horns are open is fit</p>
<blockquote>
<div><p>and removed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_period</strong> (<em>float</em>)  If None, the period is determined automatically but the period can be forced using this argument.</p></li>
<li><p><strong>force_t0</strong> (<em>float</em>)  If None, t0 is determined on the best TES but it can be given using this argument.</p></li>
<li><p><strong>doplotTESsort</strong> (<em>int</em>)  TES index once they are ordered from the best to the worst for which plots are made.
By default, it is 0, so plots are made for the best TES.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.average_over_cycles_oneTES">
<span class="sig-name descname"><span class="pre">average_over_cycles_oneTES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ncycles_to_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.average_over_cycles_oneTES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.average_over_cycles_oneTES" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m_points</strong> (<em>float</em>)  Mean and errors on each step for one TES.</p></li>
<li><p><strong>err_m_points</strong> (<em>float</em>)  Mean and errors on each step for one TES.</p></li>
<li><p><strong>median</strong> (<em>bool</em>)  If True, takes the median and not the mean on each folded step.</p></li>
<li><p><strong>Ncycles_to_use</strong> (<em>int</em>)  Number of cycles to use. If None, all cycles will be used.</p></li>
<li><p><strong>speak</strong> (<em>bool</em>)  </p></li>
<li><p><strong>doplot</strong> (<em>bool</em>)  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.average_over_points_oneTES">
<span class="sig-name descname"><span class="pre">average_over_points_oneTES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tfold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">droll</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_fall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_slope_percycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.average_over_points_oneTES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.average_over_points_oneTES" title="Link to this definition"></a></dt>
<dd><p>Average on each step in the cycle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.find_high_derivative_clusters">
<span class="sig-name descname"><span class="pre">find_high_derivative_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tfold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.find_high_derivative_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.find_high_derivative_clusters" title="Link to this definition"></a></dt>
<dd><p>Find clusters of high derivatives: each time we take the first high derivative element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.find_right_period">
<span class="sig-name descname"><span class="pre">find_right_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ASIC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.find_right_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.find_right_period" title="Link to this definition"></a></dt>
<dd><p>Determine the true period of one cycle.
:param TES: TES and ASIC numbers.
:type TES: int
:param ASIC: TES and ASIC numbers.
:type ASIC: int
:param filtering: If True, data are filtered.
:type filtering: bool
:param delta:
:type delta: float
:param nb:
:type nb: int</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.find_t0">
<span class="sig-name descname"><span class="pre">find_t0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.find_t0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.find_t0" title="Link to this definition"></a></dt>
<dd><p>Find time where configuration change in the square modulation using the reference TES.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.make_mask_bad_tes">
<span class="sig-name descname"><span class="pre">make_mask_bad_tes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detectors_sort</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.make_mask_bad_tes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.make_mask_bad_tes" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detectors_sort</strong> (<em>array</em>)  TES numbers ordered from the best to the worst.
It is a 2D array containing the TES and the ASIC index.</p></li>
<li><p><strong>fraction</strong> (<em>float</em>)  Fraction between 0 and 1 to set a threshold for bad TES.
For example, if fraction=0.75, 1/4 of the detectors will be masked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mask</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1 for good TES and NAN for bad TES.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.plot_TOD">
<span class="sig-name descname"><span class="pre">plot_TOD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ASIC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.plot_TOD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.plot_TOD" title="Link to this definition"></a></dt>
<dd><p>Plot the TODs for a given TES. if TES is None, the plot is done for the reference TES.
:param ASIC: ASIC number, 1 or 2 for the TD.
:type ASIC: int
:param TES: TES index, between 1 and 128.
:type TES: int
:param xlim: Upper abscissa limit.
:type xlim: float
:param figsize: Size of the figure, as in matplotlib.
:type figsize: bytearray</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.plot_average_over_steps">
<span class="sig-name descname"><span class="pre">plot_average_over_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mcycles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_Mcycles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">10)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.plot_average_over_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.plot_average_over_steps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.remove_median_allh">
<span class="sig-name descname"><span class="pre">remove_median_allh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tfold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">droll</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_fall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.remove_median_allh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.remove_median_allh" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.remove_slope_allcycles">
<span class="sig-name descname"><span class="pre">remove_slope_allcycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.remove_slope_allcycles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.remove_slope_allcycles" title="Link to this definition"></a></dt>
<dd><p>Fit a slope between the all horns open configurations and remove it.
Finally this function is not used for the fringes analysis, I prefer removing the slope cycle by cycle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.remove_slope_percycle">
<span class="sig-name descname"><span class="pre">remove_slope_percycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_m_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.remove_slope_percycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.remove_slope_percycle" title="Link to this definition"></a></dt>
<dd><p>Fit a slope between the all horns open configurations (3 points) and remove it.
Do it for each cycle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.resample_fold_oneTES">
<span class="sig-name descname"><span class="pre">resample_fold_oneTES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.resample_fold_oneTES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.resample_fold_oneTES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.roll_oneTES">
<span class="sig-name descname"><span class="pre">roll_oneTES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.roll_oneTES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.roll_oneTES" title="Link to this definition"></a></dt>
<dd><p>Shift the folded data in order to have t0=0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.FringesAnalysis.sort_TES_good2bad">
<span class="sig-name descname"><span class="pre">sort_TES_good2bad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">median</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#FringesAnalysis.sort_TES_good2bad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.FringesAnalysis.sort_TES_good2bad" title="Link to this definition"></a></dt>
<dd><p>Make a fit on the TODs, fit the steps of the cycle with time constants.
The residuals are used to order the TES from the best to the worst.
:param median: If True, a median and not a mean is done when folding the data using a function from fibtools.
:type median: bool
:param doplot: If True, a plot is made for the 5 best TES.
:type doplot: bool</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>Time, folded signal, the 8 parameters estimated with the fit,</em></p></li>
<li><p><em>the combination of the amplitudes, the period and the residuals</em></p></li>
<li><p><em>between the fit and the signal. They are computed for each TES.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.fringes_lib.SaveFringesFitsPdf">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.fringes_lib.</span></span><span class="sig-name descname"><span class="pre">SaveFringesFitsPdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allBLs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allstable_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allNcycles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allfringes1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allerr_fringes1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allmask_bad_TES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecosorb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'yes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ONAFP'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#SaveFringesFitsPdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.SaveFringesFitsPdf" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.SaveFringesFitsPdf.save_fringes_pdf_plots">
<span class="sig-name descname"><span class="pre">save_fringes_pdf_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#SaveFringesFitsPdf.save_fringes_pdf_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.SaveFringesFitsPdf.save_fringes_pdf_plots" title="Link to this definition"></a></dt>
<dd><p>Save all the fringe plots (all baselines) in a pdf file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.fringes_lib.SaveFringesFitsPdf.write_fits_fringes">
<span class="sig-name descname"><span class="pre">write_fits_fringes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/fringes_lib.html#SaveFringesFitsPdf.write_fits_fringes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.fringes_lib.SaveFringesFitsPdf.write_fits_fringes" title="Link to this definition"></a></dt>
<dd><p>Save a .fits with the fringes data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-qubic.horns">
<span id="qubic-horns-module"></span><h2>qubic.horns module<a class="headerlink" href="#module-qubic.horns" title="Link to this heading"></a></h2>
</section>
<section id="module-qubic.insert_point_sources_in_sky">
<span id="qubic-insert-point-sources-in-sky-module"></span><h2>qubic.insert_point_sources_in_sky module<a class="headerlink" href="#module-qubic.insert_point_sources_in_sky" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.insert_point_sources_in_sky.Jansky_invsr_to_K_CMB">
<span class="sig-prename descclassname"><span class="pre">qubic.insert_point_sources_in_sky.</span></span><span class="sig-name descname"><span class="pre">Jansky_invsr_to_K_CMB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/insert_point_sources_in_sky.html#Jansky_invsr_to_K_CMB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.insert_point_sources_in_sky.Jansky_invsr_to_K_CMB" title="Link to this definition"></a></dt>
<dd><p>This function converts flux density from Jansy/sr to K_CMB using the astropy units.equivalencies
class</p>
<p>Input
frequency        - FLOAT - the frequency in hertz at which we the conversion is needed</p>
<p>Output
Jysr2K_CMB.value - TUPLE - the conversion factor from 1 Jy to K_CMB</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.insert_point_sources_in_sky.add_sources_to_sky_map">
<span class="sig-prename descclassname"><span class="pre">qubic.insert_point_sources_in_sky.</span></span><span class="sig-name descname"><span class="pre">add_sources_to_sky_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('Auto',</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'143'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/insert_point_sources_in_sky.html#add_sources_to_sky_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.insert_point_sources_in_sky.add_sources_to_sky_map" title="Link to this definition"></a></dt>
<dd><p>This function takes a PySM map array and adds point sources with a frequency behaviour
consistent with their SED as derived from the PCCS catalog. The point source is added in total intensity
and polarization (Q and U). Stokes parameters Q and U are derived using the polarization angle present in
the catalog</p>
<p>Input
input_map        - NDARRAY         - An array shaped (nfreq, npix, 3) containing sky maps in the</p>
<blockquote>
<div><p>frequencies defined in the QUBIC dictionary (n_sub is the number
of frequencies, filter_nu is the center frequency,
filter_relative_bandwidth is the relative bandwidth</p>
</div></blockquote>
<p>frequencies      - LIST or NDARRAY - list of frequencies in Hz
sources          - LIST or NDARRAY - list of sources ad defined in the QUBIC pccs
fwhm_deg         - TUPLE           - The fwhm in degrees of the gaussian used to smooth the source.</p>
<blockquote>
<div><p>fwhm_deg is specified as a tuple. If fwhm_deg[0] == Auto then
the fwhm is derived automatically by the pixel size multiplying it
by the factor specified in fwhm_deg[1]. If fwhm_deg[0] == Man then
the fwhm is specified directly, in degrees, in fwhm_deg[1]. Default
is fwhm_deg = (Auto, 1)</p>
</div></blockquote>
<dl class="simple">
<dt>catalog_file        - STRING       - the catalog filename (in pickle format) If catalog_file = Auto</dt><dd><p>(Default) then catalog_file = qubic.data.PATH + qubic_pccs2.pickle</p>
</dd>
<dt>reference_frequency - STRING       - the reference frequency in GHz in the catalog to derive the source</dt><dd><p>coordinates. It defaults to 143 GHz. Can be left to this value also
for 220 GHz, as the source location is weakly dependent on the
frequency</p>
</dd>
</dl>
<p>Output
output_map       - NDARRAY         - An array shaped (nfreq, npix, 3) containing sky + point</p>
<blockquote>
<div><p>sources maps</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.insert_point_sources_in_sky.center_ang">
<span class="sig-prename descclassname"><span class="pre">qubic.insert_point_sources_in_sky.</span></span><span class="sig-name descname"><span class="pre">center_ang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/insert_point_sources_in_sky.html#center_ang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.insert_point_sources_in_sky.center_ang" title="Link to this definition"></a></dt>
<dd><p>This function centers a pair of (theta,phi) angles so that it lies in the [-180,180]
and [-90,90] degrees ranges</p>
<p>Input
angle                  - TUPLE   - the angle pair to be centered
degree                 - BOOL    - whether the angles are in degree or radians</p>
<p>Output
new_angle              - TUPLE   - the centered angle pair</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.insert_point_sources_in_sky.gaussian2D">
<span class="sig-prename descclassname"><span class="pre">qubic.insert_point_sources_in_sky.</span></span><span class="sig-name descname"><span class="pre">gaussian2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/insert_point_sources_in_sky.html#gaussian2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.insert_point_sources_in_sky.gaussian2D" title="Link to this definition"></a></dt>
<dd><p>This the 2D gaussian function centered in theta0, phi0</p>
<p>Input
theta        - FLOAT - angle theta in radians
theta0       - FLOAT - center angle theta in radians
phi          - FLOAT - angle phi in radians
phi0         - FLOAT - center angle phi in radians
fwhm         - FLOAT - fwhm of the gaussian in radians</p>
<p>Output
The gaussian function defined as:
1/(np.pi * sigma**2) * np.exp(-((theta-theta0)**2 + (phi-phi0)**2) / sigma**2) (Normalized to unit
integral)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.insert_point_sources_in_sky.gaussian2D_grid">
<span class="sig-prename descclassname"><span class="pre">qubic.insert_point_sources_in_sky.</span></span><span class="sig-name descname"><span class="pre">gaussian2D_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_center_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm_deg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/insert_point_sources_in_sky.html#gaussian2D_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.insert_point_sources_in_sky.gaussian2D_grid" title="Link to this definition"></a></dt>
<dd><p>This generates the grid for the gaussian smoothing around the source
center. The grid is generated in an interval of 4 times the fwhm</p>
<p>Input
source_center_deg      - TUPLE - the LonLat coordinates of the source in degrees
fwhm_deg               - FLOAT - fwhm of the gaussian in degrees</p>
<p>Output
theta_range, phi_range - NDARRAYS - Two arrays containing the theta and phi ranges in degrees</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.insert_point_sources_in_sky.getsource">
<span class="sig-prename descclassname"><span class="pre">qubic.insert_point_sources_in_sky.</span></span><span class="sig-name descname"><span class="pre">getsource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/insert_point_sources_in_sky.html#getsource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.insert_point_sources_in_sky.getsource" title="Link to this definition"></a></dt>
<dd><p>This function gets a source from the compact source database and returnts its inputs</p>
<p>Input
source     - STRING - the source name in the convention of the database or with the common name
frequency  - FLOAT  - the frequency in GHz
catalog    - DICT   - the QUBIC PCCS catalog</p>
<p>Output
out_source - DICT   - the source parameters</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.insert_point_sources_in_sky.insert_source">
<span class="sig-prename descclassname"><span class="pre">qubic.insert_point_sources_in_sky.</span></span><span class="sig-name descname"><span class="pre">insert_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_center_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_Jy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uK_CMB'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/insert_point_sources_in_sky.html#insert_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.insert_point_sources_in_sky.insert_source" title="Link to this definition"></a></dt>
<dd><p>This function smooth a source with a given flux with a gaussian and returns a map
with the source in its position</p>
<p>Input
source_center_deg      - TUPLE   - the LonLat coordinates of the source in degrees
fwhm_deg               - FLOAT   - fwhm of the gaussian in degrees
flux_Jy                - FLOAT   - source flux in Jy
nside                  - INT     - output map NSIDE
units                  - STRING  - the units we want the map to be produced. Can be Flux</p>
<blockquote>
<div><p>[Jy/sr], K_CMB or uK_CMB</p>
</div></blockquote>
<dl class="simple">
<dt>input_map              - NDARRAY - An input map that may be used to add the point source to. Default</dt><dd><p>is input_map = None, which means that the map will be initialized
at the desired NSIDE</p>
</dd>
</dl>
<p>frequency              - FLOAT   - the frequency at which we want the conversion to take place</p>
<p>Output
return_map             - NDARRAY - The HEALPix map</p>
</dd></dl>

</section>
<section id="module-qubic.instrument">
<span id="qubic-instrument-module"></span><h2>qubic.instrument module<a class="headerlink" href="#module-qubic.instrument" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.instrument.</span></span><span class="sig-name descname"><span class="pre">QubicInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FRBW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></p>
<p>The QubicInstrument class. It represents the instrument setup.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_before_horns">
<span class="sig-name descname"><span class="pre">NEP_before_horns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_before_horns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_before_horns" title="Link to this definition"></a></dt>
<dd><p>This method computes the noise for all the components before
back-to-back array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>nu</strong>  frequency</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot_nobunch
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_coldstop">
<span class="sig-name descname"><span class="pre">NEP_coldstop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_coldstop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_coldstop" title="Link to this definition"></a></dt>
<dd><p>This method calculates the noise of the cold stop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_combiner">
<span class="sig-name descname"><span class="pre">NEP_combiner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_combiner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_combiner" title="Link to this definition"></a></dt>
<dd><p>This method calculates the noise of the optical combiner (consider 2 mirrors).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_dichroic">
<span class="sig-name descname"><span class="pre">NEP_dichroic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_dichroic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_dichroic" title="Link to this definition"></a></dt>
<dd><p>This method calculates the noise of the dichroic. Its only accounted for the FI configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_environment">
<span class="sig-name descname"><span class="pre">NEP_environment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_environment" title="Link to this definition"></a></dt>
<dd><p>This method calculates the environment noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>names</strong>  (noise.names attribute)
names of the components considered in the instrument model for the noise.</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2_env &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_horns">
<span class="sig-name descname"><span class="pre">NEP_horns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_horns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_horns" title="Link to this definition"></a></dt>
<dd><p>This method calculates the noise of the array of horns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_lastfilter">
<span class="sig-name descname"><span class="pre">NEP_lastfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_lastfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_lastfilter" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_lowpassedge">
<span class="sig-name descname"><span class="pre">NEP_lowpassedge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_lowpassedge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_lowpassedge" title="Link to this definition"></a></dt>
<dd><p>This method calculates the noise of the low pass edge filter.
In the case of the 220GHz the ndf is considered in an independent method called NEP_lastfilters_220.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>i</strong>  index for the low pass edge filters (lpe1 or lpe2 attr of noise)</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_lpefilter_220">
<span class="sig-name descname"><span class="pre">NEP_lpefilter_220</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_lpefilter_220"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_lpefilter_220" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>i</strong>  noise component index</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.NEP_neutraldensityfilter">
<span class="sig-name descname"><span class="pre">NEP_neutraldensityfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.NEP_neutraldensityfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.NEP_neutraldensityfilter" title="Link to this definition"></a></dt>
<dd><p>This method calculates the noise of the neutral density filter for 150GHz band.
In the case of the 220GHz the ndf is considered in an independent method called NEP_lastfilters_220.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong>  parameters for the computation of the noise. It is loaded from
load_NEP_parameters method</p></li>
<li><p><strong>return_only</strong>  if True, the method returns a dictionary with the components of the noise
sampled using sampling in Instrument.get_noise() method from pysimulators
if False, the method just load the components of the photon noise in the noise argument</p></li>
<li><p><strong>sampling</strong>  qubic.get_sampling(dict) object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>power &gt; photon power
NEP_phot2 &gt; NEP squared. shape = (#det,)
NEP_array &gt; NEP array sampled. shape = (#det,#samples)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>if return_only &gt; dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.detector_subset">
<span class="sig-name descname"><span class="pre">detector_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.detector_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.detector_subset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_aperture_integration_operator">
<span class="sig-name descname"><span class="pre">get_aperture_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_aperture_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_aperture_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in the telescope aperture.
Convert signal from W / m^2 / Hz into W / Hz.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_convolution_peak_operator">
<span class="sig-name descname"><span class="pre">get_convolution_peak_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_convolution_peak_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_convolution_peak_operator" title="Link to this definition"></a></dt>
<dd><p>Return an operator that convolves the Healpix sky by the gaussian
kernel that, if used in conjonction with the peak sampling operator,
best approximates the synthetic beam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_detector_integration_operator">
<span class="sig-name descname"><span class="pre">get_detector_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_detector_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_detector_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in detector solid angles and take into account
the secondary beam transmission.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_detector_response_operator">
<span class="sig-name descname"><span class="pre">get_detector_response_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_detector_response_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_detector_response_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator for the bolometer responses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_filter_operator">
<span class="sig-name descname"><span class="pre">get_filter_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_filter_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_filter_operator" title="Link to this definition"></a></dt>
<dd><p>Return the filter operator.
Convert units from W/Hz to W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_hwp_operator">
<span class="sig-name descname"><span class="pre">get_hwp_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_hwp_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_hwp_operator" title="Link to this definition"></a></dt>
<dd><p>Return the rotation matrix for the half-wave plate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_invntt_operator">
<span class="sig-name descname"><span class="pre">get_invntt_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_invntt_operator" title="Link to this definition"></a></dt>
<dd><p>Return the inverse time-time noise correlation matrix as an Operator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">photon_noise=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation=&lt;function</span> <span class="pre">operation_assignment&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_noise" title="Link to this definition"></a></dt>
<dd><p>Return a noisy timeline.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_noise_detector">
<span class="sig-name descname"><span class="pre">get_noise_detector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_noise_detector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_noise_detector" title="Link to this definition"></a></dt>
<dd><p>Return the detector noise (#det, #sampling).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_noise_photon">
<span class="sig-name descname"><span class="pre">get_noise_photon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_noise_photon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_noise_photon" title="Link to this definition"></a></dt>
<dd><p>Return the photon noise (#det, #sampling).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_polarizer_operator">
<span class="sig-name descname"><span class="pre">get_polarizer_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_polarizer_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_polarizer_operator" title="Link to this definition"></a></dt>
<dd><p>Return operator for the polarizer grid.
When the polarizer is not present a transmission of 1 is assumed
for the detectors on the first focal plane and of 0 for the other.
Otherwise, the signal is split onto the focal planes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_projection_operator">
<span class="sig-name descname"><span class="pre">get_projection_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_projection_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_projection_operator" title="Link to this definition"></a></dt>
<dd><p>Return the peak sampling operator.
Convert units from W to W/sr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampling</strong> (<a class="reference internal" href="#qubic.samplings.QubicSampling" title="qubic.samplings.QubicSampling"><em>QubicSampling</em></a>)  The pointing information.</p></li>
<li><p><strong>scene</strong> (<a class="reference internal" href="#qubic.scene.QubicScene" title="qubic.scene.QubicScene"><em>QubicScene</em></a>)  The observed scene.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>)  If true, display information about the memory allocation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_synthbeam">
<span class="sig-name descname"><span class="pre">get_synthbeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwp_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_integrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_synthbeam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_synthbeam" title="Link to this definition"></a></dt>
<dd><p>Return the detector synthetic beams, computed from the superposition
of the electromagnetic fields.</p>
<p>The synthetic beam B_d = (B_d,i) of a given detector d is such that
the power I_d in [W] collected by this detector observing a sky S=(S_i)
in [W/m^2/Hz] is:</p>
<blockquote>
<div><p>I_d = (S | B_d) = sum_i S_i * B_d,i.</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span> <span class="o">=</span> <span class="n">QubicScene</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inst</span> <span class="o">=</span> <span class="n">QubicInstrument</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sb</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">get_synthbeam</span><span class="p">(</span><span class="n">scene</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The power collected by the bolometers in W, given a sky in W/m/Hz is:
&gt;&gt;&gt; sb = inst.get_synthbeam(scene)
&gt;&gt;&gt; sky = scene.ones()   # [W/m/Hz]
&gt;&gt;&gt; P = np.dot(sb, sky)  # [W]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scene</strong> (<a class="reference internal" href="#qubic.scene.QubicScene" title="qubic.scene.QubicScene"><em>QubicScene</em></a>)  The scene.</p></li>
<li><p><strong>idet</strong> (<em>int</em><em>, </em><em>optional</em>)  The detector number. By default, the synthetic beam is computed for
all detectors.</p></li>
<li><p><strong>theta_max</strong> (<em>float</em><em>, </em><em>optional</em>)  The maximum zenithal angle above which the synthetic beam is
assumed to be zero, in degrees.</p></li>
<li><p><strong>external_A</strong> (<em>list</em><em> of </em><em>tables describing the phase and amplitude at each point</em><em> of </em><em>the focal</em>)  plane for each of the horns:
[0] : array, X coordinates with shape (n) in GRF [m]
[1] : array, Y coordinates with shape (n) in GRF [m]
[2] : array, amplitude on X with shape (n, nhorns)
[3] : array, amplitude on Y with shape (n, nhorns)
[4] : array, phase on X with shape (n, nhorns) [rad]
[5] : array, phase on Y with shape (n, nhorns) [rad]</p></li>
<li><p><strong>hwp_position</strong> (<em>int</em>)  HWP position from 0 to 7.</p></li>
<li><p><strong>detector_integrate</strong> (<em>Optional</em><em>, </em><em>number</em><em> of </em><em>subpixels in x direction for integration over detectors</em>)  default (None) is no integration =&gt; uses the center of the pixel</p></li>
<li><p><strong>detpos</strong> (<em>Optional</em><em>, </em><em>position in the focal plane at which the Synthesized Beam is desired as np.array</em><em>(</em><em>[</em><em>x</em><em>,</em><em>y</em><em>,</em><em>z</em><em>]</em><em>)</em>)  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.get_transmission_operator">
<span class="sig-name descname"><span class="pre">get_transmission_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.get_transmission_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.get_transmission_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator that multiplies by the cumulative instrumental
transmission.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicInstrument.load_NEP_parameters">
<span class="sig-name descname"><span class="pre">load_NEP_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicInstrument.load_NEP_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicInstrument.load_NEP_parameters" title="Link to this definition"></a></dt>
<dd><p>This method loads the parameters for the photon noise (NEP) computation.
The attributes are loaded into a Noise() class. The attributes are:</p>
<p>temperatures, transmissions, emissivities, gp (polarization) of each component of the instrument,
names: name of each component,
tr_prod: cumulative multiplication of the transmissions of each components,
dnu: bandwidth,
S_det: detector area,
omega_det: solid angle sustained by a given detector on the sky,
S_horns: physical horn area,
S_horns_eff: effective horn area,
sec_beam: secondary beam QubicInstrument.secondary_beam,</p>
<p>P_phot, NEP_phot: empty arrays to be loaded by NEP-like methods (below),
indexes for each component,</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.instrument.QubicMultibandInstrument">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.instrument.</span></span><span class="sig-name descname"><span class="pre">QubicMultibandInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicMultibandInstrument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicMultibandInstrument" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The QubicMultibandInstrument class
Represents the QUBIC multiband features
as an array of QubicInstrumet objects</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicMultibandInstrument.detector_subset">
<span class="sig-name descname"><span class="pre">detector_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicMultibandInstrument.detector_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicMultibandInstrument.detector_subset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicMultibandInstrument.direct_convolution">
<span class="sig-name descname"><span class="pre">direct_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicMultibandInstrument.direct_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicMultibandInstrument.direct_convolution" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.instrument.QubicMultibandInstrument.get_synthbeam">
<span class="sig-name descname"><span class="pre">get_synthbeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_integrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/instrument.html#QubicMultibandInstrument.get_synthbeam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.instrument.QubicMultibandInstrument.get_synthbeam" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.jchinstrument">
<span id="qubic-jchinstrument-module"></span><h2>qubic.jchinstrument module<a class="headerlink" href="#module-qubic.jchinstrument" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.jchinstrument.</span></span><span class="sig-name descname"><span class="pre">QubicInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FRBW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></p>
<p>The QubicInstrument class. It represents the instrument setup.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.detector_subset">
<span class="sig-name descname"><span class="pre">detector_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.detector_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.detector_subset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_aperture_integration_operator">
<span class="sig-name descname"><span class="pre">get_aperture_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_aperture_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_aperture_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in the telescope aperture.
Convert signal from W / m^2 / Hz into W / Hz.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_convolution_peak_operator">
<span class="sig-name descname"><span class="pre">get_convolution_peak_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_convolution_peak_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_convolution_peak_operator" title="Link to this definition"></a></dt>
<dd><p>Return an operator that convolves the Healpix sky by the gaussian
kernel that, if used in conjonction with the peak sampling operator,
best approximates the synthetic beam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_detector_integration_operator">
<span class="sig-name descname"><span class="pre">get_detector_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_detector_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_detector_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in detector solid angles and take into account
the secondary beam transmission.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_detector_response_operator">
<span class="sig-name descname"><span class="pre">get_detector_response_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_detector_response_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_detector_response_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator for the bolometer responses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_filter_operator">
<span class="sig-name descname"><span class="pre">get_filter_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_filter_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_filter_operator" title="Link to this definition"></a></dt>
<dd><p>Return the filter operator.
Convert units from W/Hz to W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_hwp_operator">
<span class="sig-name descname"><span class="pre">get_hwp_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_hwp_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_hwp_operator" title="Link to this definition"></a></dt>
<dd><p>Return the rotation matrix for the half-wave plate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_invntt_operator">
<span class="sig-name descname"><span class="pre">get_invntt_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_invntt_operator" title="Link to this definition"></a></dt>
<dd><p>Return the inverse time-time noise correlation matrix as an Operator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">photon_noise=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation=&lt;function</span> <span class="pre">operation_assignment&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_noise" title="Link to this definition"></a></dt>
<dd><p>Return a noisy timeline.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_noise_detector">
<span class="sig-name descname"><span class="pre">get_noise_detector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_noise_detector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_noise_detector" title="Link to this definition"></a></dt>
<dd><p>Return the detector noise (#det, #sampling).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_noise_photon">
<span class="sig-name descname"><span class="pre">get_noise_photon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_noise_photon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_noise_photon" title="Link to this definition"></a></dt>
<dd><p>Return the photon noise (#det, #sampling).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_polarizer_operator">
<span class="sig-name descname"><span class="pre">get_polarizer_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_polarizer_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_polarizer_operator" title="Link to this definition"></a></dt>
<dd><p>Return operator for the polarizer grid.
When the polarizer is not present a transmission of 1 is assumed
for the detectors on the first focal plane and of 0 for the other.
Otherwise, the signal is split onto the focal planes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_projection_operator">
<span class="sig-name descname"><span class="pre">get_projection_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_projection_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_projection_operator" title="Link to this definition"></a></dt>
<dd><p>Return the peak sampling operator.
Convert units from W to W/sr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampling</strong> (<a class="reference internal" href="#qubic.samplings.QubicSampling" title="qubic.samplings.QubicSampling"><em>QubicSampling</em></a>)  The pointing information.</p></li>
<li><p><strong>scene</strong> (<a class="reference internal" href="#qubic.scene.QubicScene" title="qubic.scene.QubicScene"><em>QubicScene</em></a>)  The observed scene.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>)  If true, display information about the memory allocation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_synthbeam">
<span class="sig-name descname"><span class="pre">get_synthbeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwp_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_integrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_synthbeam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_synthbeam" title="Link to this definition"></a></dt>
<dd><p>Return the detector synthetic beams, computed from the superposition
of the electromagnetic fields.</p>
<p>The synthetic beam B_d = (B_d,i) of a given detector d is such that
the power I_d in [W] collected by this detector observing a sky S=(S_i)
in [W/m^2/Hz] is:</p>
<blockquote>
<div><p>I_d = (S | B_d) = sum_i S_i * B_d,i.</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span> <span class="o">=</span> <span class="n">QubicScene</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inst</span> <span class="o">=</span> <span class="n">QubicInstrument</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sb</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">get_synthbeam</span><span class="p">(</span><span class="n">scene</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The power collected by the bolometers in W, given a sky in W/m/Hz is:
&gt;&gt;&gt; sb = inst.get_synthbeam(scene)
&gt;&gt;&gt; sky = scene.ones()   # [W/m/Hz]
&gt;&gt;&gt; P = np.dot(sb, sky)  # [W]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scene</strong> (<a class="reference internal" href="#qubic.scene.QubicScene" title="qubic.scene.QubicScene"><em>QubicScene</em></a>)  The scene.</p></li>
<li><p><strong>idet</strong> (<em>int</em><em>, </em><em>optional</em>)  The detector number. By default, the synthetic beam is computed for
all detectors.</p></li>
<li><p><strong>theta_max</strong> (<em>float</em><em>, </em><em>optional</em>)  The maximum zenithal angle above which the synthetic beam is
assumed to be zero, in degrees.</p></li>
<li><p><strong>external_A</strong> (<em>list</em><em> of </em><em>tables describing the phase and amplitude at each point</em><em> of </em><em>the focal</em>)  plane for each of the horns:
[0] : array, X coordinates with shape (n) in GRF [m]
[1] : array, Y coordinates with shape (n) in GRF [m]
[2] : array, amplitude on X with shape (n, nhorns)
[3] : array, amplitude on Y with shape (n, nhorns)
[4] : array, phase on X with shape (n, nhorns) [rad]
[5] : array, phase on Y with shape (n, nhorns) [rad]</p></li>
<li><p><strong>hwp_position</strong> (<em>int</em>)  HWP position from 0 to 7.</p></li>
<li><p><strong>detector_integrate</strong> (<em>Optional</em><em>, </em><em>number</em><em> of </em><em>subpixels in x direction for integration over detectors</em>)  default (None) is no integration =&gt; uses the center of the pixel</p></li>
<li><p><strong>detpos</strong> (<em>Optional</em><em>, </em><em>position in the focal plane at which the Synthesized Beam is desired as np.array</em><em>(</em><em>[</em><em>x</em><em>,</em><em>y</em><em>,</em><em>z</em><em>]</em><em>)</em>)  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicInstrument.get_transmission_operator">
<span class="sig-name descname"><span class="pre">get_transmission_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicInstrument.get_transmission_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicInstrument.get_transmission_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator that multiplies by the cumulative instrumental
transmission.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicMultibandInstrument">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.jchinstrument.</span></span><span class="sig-name descname"><span class="pre">QubicMultibandInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicMultibandInstrument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicMultibandInstrument" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The QubicMultibandInstrument class
Represents the QUBIC multiband features
as an array of QubicInstrumet objects</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicMultibandInstrument.detector_subset">
<span class="sig-name descname"><span class="pre">detector_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicMultibandInstrument.detector_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicMultibandInstrument.detector_subset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicMultibandInstrument.direct_convolution">
<span class="sig-name descname"><span class="pre">direct_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicMultibandInstrument.direct_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicMultibandInstrument.direct_convolution" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.jchinstrument.QubicMultibandInstrument.get_synthbeam">
<span class="sig-name descname"><span class="pre">get_synthbeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_integrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/jchinstrument.html#QubicMultibandInstrument.get_synthbeam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.jchinstrument.QubicMultibandInstrument.get_synthbeam" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.lin_lib">
<span id="qubic-lin-lib-module"></span><h2>qubic.lin_lib module<a class="headerlink" href="#module-qubic.lin_lib" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.lin_lib.logistic">
<span class="sig-prename descclassname"><span class="pre">qubic.lin_lib.</span></span><span class="sig-name descname"><span class="pre">logistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/lin_lib.html#logistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.lin_lib.logistic" title="Link to this definition"></a></dt>
<dd><p>This function is the logistic function to be used in Minuit fitting</p>
<p>INPUTS
x      - FLOAT - The x values
pars   - FLOAT ARRAY - the parameters</p>
<blockquote>
<div><p>pars[0] : Amplitude in Y of the efficiency curve
pars[1] : central value in x of the efficiency curve
pars[2] : width in x of the efficiency curve
pars[3] : offset in y of the efficiency curve</p>
</div></blockquote>
<p>OUTPUTS
result  - the logistic function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.lin_lib.shift_src">
<span class="sig-prename descclassname"><span class="pre">qubic.lin_lib.</span></span><span class="sig-name descname"><span class="pre">shift_src</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/lin_lib.html#shift_src"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.lin_lib.shift_src" title="Link to this definition"></a></dt>
<dd><p>This function returns a shifted version of an array supposed to be periodic and scaled in amplitude and offset.
the array to be shifted is supposed to be in a global variable called array_to_shift
The result is interpolated on the x array abscissas
This function is to be used for fitting with Minuit</p>
<p>INPUT
xyper    - LIST  - the input array and period to be shifted</p>
<blockquote>
<div><p>xyper[0] : the array of x
xyper[1] : the array of y
xyper[2] : the periodicity of the signal</p>
</div></blockquote>
<dl class="simple">
<dt>pars     - FLOAT - the parameters of the shift</dt><dd><p>pars[0] : amplitude
pars[1] : offset
pars[2] : shift in x</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.lin_lib.sim_generator_power">
<span class="sig-prename descclassname"><span class="pre">qubic.lin_lib.</span></span><span class="sig-name descname"><span class="pre">sim_generator_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finterp_Vin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finterp_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/lin_lib.html#sim_generator_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.lin_lib.sim_generator_power" title="Link to this definition"></a></dt>
<dd><p>This function simulates the power output of the source
taking into account the source calibration curve</p>
<p>INPUTS
time      - FLOAT - the current time [s]
amplitude - FLOAT - the p2p amplitude of the signal in the UCA stage of the generator [V]
offset    - FLOAT - the offset of the signal in the UCA stage of the generator [V]
frequency - FLOAT - the modulation frequency [Hz]
phase     - FLOAT - the wave initial phase
rf_freq   - FLOAT - the RF frequency (chosen to select the right calibration curve, defaults to 150 GHz)
finterp_Vin  - MIXED - the interpolating function that returns the fraction of power</p>
<blockquote>
<div><p>as a function of Vin. If it is provided externally then it is of type
scipy.interpolate.interp2d. Default is an empty string, in this case the interpolation
is carried out internally</p>
</div></blockquote>
<dl class="simple">
<dt>finterp_freq - MIXED - the interpolating function that returns the maximum power</dt><dd><p>as a function of the frequency in GHz. If it is provided externally then it is of type
scipy.interpolate.interp1d. Default is an empty string, in this case the interpolation
is carried out internally</p>
</dd>
</dl>
<p>OUTPUTS
cal_signal  - FLOAT - the calibrated signal</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.lin_lib.sine">
<span class="sig-prename descclassname"><span class="pre">qubic.lin_lib.</span></span><span class="sig-name descname"><span class="pre">sine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/lin_lib.html#sine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.lin_lib.sine" title="Link to this definition"></a></dt>
<dd><p>This function is just a wrapper to a sine function to be used for fitting with Minuit. It returns a sine modulation
of a given amplitude around a given offset</p>
<p>INPUT
x        - FLOAT - the array of x for which we want the sine
pars     - FLOAT - the parameters of the sine</p>
<blockquote>
<div><p>pars[0] : Peak-to-peak amplitude
pars[1] : Modulation frequency (in Hz)
pars[2] : phase (in seconds)
pars[3] : offset</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.lin_lib.sinesat">
<span class="sig-prename descclassname"><span class="pre">qubic.lin_lib.</span></span><span class="sig-name descname"><span class="pre">sinesat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/lin_lib.html#sinesat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.lin_lib.sinesat" title="Link to this definition"></a></dt>
<dd><p>This function returns the model of the source signal for a given modulation configuration (amp, offset, freq, phase) and then
multiplies it by a global amplitude (calibration factor) and adds a offset.
This is to be used in fitting with Minuit</p>
<p>INPUT
x        - FLOAT - the input x
pars     - FLOAT - the parameters of the source</p>
<blockquote>
<div><p>- Calib Params 
pars[0] : calibration amplitude
pars[1] : calibration offset
- Modulation Params -
pars[2] : peak to peak amplitude of the source modulation in Volts
pars[3] : Period of the modulation [s]
pars[4] : the wave initial phase
pars[5] : the offset of the signal in the UCA stage of the generator [V]</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.lin_lib.source_cal">
<span class="sig-prename descclassname"><span class="pre">qubic.lin_lib.</span></span><span class="sig-name descname"><span class="pre">source_cal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Vin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finterp_Vin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finterp_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/lin_lib.html#source_cal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.lin_lib.source_cal" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-qubic.mapmaking">
<span id="qubic-mapmaking-module"></span><h2>qubic.mapmaking module<a class="headerlink" href="#module-qubic.mapmaking" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.mapmaking.angular_distance_from_mask">
<span class="sig-prename descclassname"><span class="pre">qubic.mapmaking.</span></span><span class="sig-name descname"><span class="pre">angular_distance_from_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mapmaking.html#angular_distance_from_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mapmaking.angular_distance_from_mask" title="Link to this definition"></a></dt>
<dd><p>For each pixel of a Healpix map, return the smallest angular distance
to a set of masked pixels (of value True), in degrees.</p>
<section id="parameter">
<h3>Parameter<a class="headerlink" href="#parameter" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>maskok<span class="classifier">boolean Healpix map</span></dt><dd><p>The Healpix mask that defines the set of masked pixels (of value True)
whose smallest angular distance to each pixel of a Healpix map of same
nside is computed.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.mapmaking.apodize_mask">
<span class="sig-prename descclassname"><span class="pre">qubic.mapmaking.</span></span><span class="sig-name descname"><span class="pre">apodize_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maskok</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm_deg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mapmaking.html#apodize_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mapmaking.apodize_mask" title="Link to this definition"></a></dt>
<dd><p>Apodize a mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maskok</strong> (<em>boolean Healpix map</em>)  The mask to be apodized (of value True).</p></li>
<li><p><strong>fwhm_deg</strong> (<em>float</em>)  The FWHM of the apodization function, counted from the mask edges,
in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.mapmaking.map2tod">
<span class="sig-prename descclassname"><span class="pre">qubic.mapmaking.</span></span><span class="sig-name descname"><span class="pre">map2tod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nbytes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mapmaking.html#map2tod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mapmaking.map2tod" title="Link to this definition"></a></dt>
<dd><p>tod = map2tod(acquisition, map)
tod, convolved_map = map2tod(acquisition, map, convolution=True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acq</strong> (<a class="reference internal" href="#qubic.acquisition.QubicAcquisition" title="qubic.acquisition.QubicAcquisition"><em>QubicAcquisition</em></a>)  The QUBIC acquisition.</p></li>
<li><p><strong>map</strong> (<em>I</em><em>, </em><em>QU</em><em> or </em><em>IQU maps</em>)  Temperature, QU or IQU maps of shapes npix, (npix, 2), (npix, 3)
with npix = 12 * nside**2</p></li>
<li><p><strong>convolution</strong> (<em>boolean</em><em>, </em><em>optional</em>)  Set to True to convolve the input map by a gaussian and return it.</p></li>
<li><p><strong>max_nbytes</strong> (<em>int</em>)  Maximum number of bytes for the pointing matrix. If the actual size
is greater than this number, the computation of the pointing matrix
will be performed on the fly at each iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tod</strong> (<em>array</em>)  The Time-Ordered-Data of shape (ndetectors, ntimes).</p></li>
<li><p><strong>convolved_map</strong> (<em>array</em>)  The convolved map, if the convolution keyword is set.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.mapmaking.tod2map_all">
<span class="sig-prename descclassname"><span class="pre">qubic.mapmaking.</span></span><span class="sig-name descname"><span class="pre">tod2map_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acquisition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nbytes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mapmaking.html#tod2map_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mapmaking.tod2map_all" title="Link to this definition"></a></dt>
<dd><p>Compute map using all detectors.</p>
<dl class="simple">
<dt>map, coverage = tod2map_all(acquisition, tod, [coverage_threshold,</dt><dd><p>max_nbytes, callback, disp, tol])</p>
</dd>
</dl>
<p>map, coverage, pcg = tod2map_all(acquisition, tod, [], full_output=True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acquisition</strong> (<a class="reference internal" href="#qubic.acquisition.QubicAcquisition" title="qubic.acquisition.QubicAcquisition"><em>QubicAcquisition</em></a>)  The QUBIC acquisition.</p></li>
<li><p><strong>tod</strong> (<em>array-like</em>)  The Time-Ordered-Data of shape (ndetectors, ntimes).</p></li>
<li><p><strong>coverage_threshold</strong> (<em>float</em><em>, </em><em>optional</em>)  The low-coverage sky pixels whose cumulative coverage is below a
fraction of the total coverage are rejected. This keyword speficies
this fraction (between 0 and 1]).</p></li>
<li><p><strong>max_nbytes</strong> (<em>int</em>)  Maximum number of bytes for the pointing matrix. If the actual size
is greater than this number, the computation of the pointing matrix
will be performed on the fly at each iteration.</p></li>
<li><p><strong>callback</strong> (<em>function</em><em>, </em><em>optional</em>)  User-supplied function to call after each iteration.  It is called
as callback(solver), where solver is an Algorithm instance.</p></li>
<li><p><strong>disp</strong> (<em>boolean</em><em>, </em><em>optional</em>)  Display of solvers iterations.</p></li>
<li><p><strong>maxiter</strong> (<em>integer</em><em>, </em><em>optional</em>)  Maximum number of iterations.  Iteration will stop after maxiter
steps even if the specified tolerance has not been achieved.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>)  Solver tolerance.</p></li>
<li><p><strong>criterion</strong> (<em>boolean</em><em>, </em><em>optional</em>)  If True, also display the criterion at each iteration. It slows down
the solving process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>map</strong>  Temperature, QU or IQU maps of shapes npix, (npix, 2), (npix, 3)
with npix = 12 * nside**2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>I, QU or IQU maps</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.mapmaking.tod2map_each">
<span class="sig-prename descclassname"><span class="pre">qubic.mapmaking.</span></span><span class="sig-name descname"><span class="pre">tod2map_each</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acquisition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nbytes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mapmaking.html#tod2map_each"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mapmaking.tod2map_each" title="Link to this definition"></a></dt>
<dd><p>Compute average map from each detector.</p>
<dl class="simple">
<dt>map, coverage = tod2map_each(acquisition, tod, [coverage_threshold,</dt><dd><p>max_nbytes, callback, disp, tol])</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acquisition</strong> (<a class="reference internal" href="#qubic.acquisition.QubicAcquisition" title="qubic.acquisition.QubicAcquisition"><em>QubicAcquisition</em></a>)  The QUBIC acquisition.</p></li>
<li><p><strong>tod</strong> (<em>array-like</em>)  The Time-Ordered-Data of shape (ndetectors, ntimes).</p></li>
<li><p><strong>coverage_threshold</strong> (<em>float</em><em>, </em><em>optional</em>)  The coverage threshold used to reject map pixels from
the reconstruction.</p></li>
<li><p><strong>max_nbytes</strong> (<em>int</em>)  Maximum number of bytes for the pointing matrix. If the actual size
is greater than this number, the computation of the pointing matrix
will be performed on the fly at each iteration.</p></li>
<li><p><strong>callback</strong> (<em>function</em><em>, </em><em>optional</em>)  User-supplied function to call after each iteration.  It is called
as callback(solver), where solver is an Algorithm instance.</p></li>
<li><p><strong>disp</strong> (<em>boolean</em><em>, </em><em>optional</em>)  Display of solvers iterations.</p></li>
<li><p><strong>maxiter</strong> (<em>integer</em><em>, </em><em>optional</em>)  Maximum number of iterations.  Iteration will stop after maxiter
steps even if the specified tolerance has not been achieved.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>)  Solver tolerance.</p></li>
<li><p><strong>criterion</strong> (<em>boolean</em><em>, </em><em>optional</em>)  If True, also display the criterion at each iteration. It slows down
the solving process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>map</strong>  Temperature, QU or IQU maps of shapes npix, (npix, 2), (npix, 3)
with npix = 12 * nside**2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>I, QU or IQU maps</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-qubic.mcmc">
<span id="qubic-mcmc-module"></span><h2>qubic.mcmc module<a class="headerlink" href="#module-qubic.mcmc" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.mcmc.</span></span><span class="sig-name descname"><span class="pre">LogLikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsiginit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsigprior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatprior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixedpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance_model_funct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.call4curvefit">
<span class="sig-name descname"><span class="pre">call4curvefit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.call4curvefit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.call4curvefit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.compute_sigma68">
<span class="sig-name descname"><span class="pre">compute_sigma68</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logLLH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rvalues</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.compute_sigma68"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.compute_sigma68" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.curve_fit">
<span class="sig-name descname"><span class="pre">curve_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.curve_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.curve_fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.fisher_analysis">
<span class="sig-name descname"><span class="pre">fisher_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.fisher_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.fisher_analysis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.log_priors">
<span class="sig-name descname"><span class="pre">log_priors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.log_priors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.log_priors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.make_covariance_matrix">
<span class="sig-name descname"><span class="pre">make_covariance_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.make_covariance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.make_covariance_matrix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.minuit">
<span class="sig-name descname"><span class="pre">minuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncallmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsplit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_chi2fct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.minuit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.minuit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.random_explore_guess">
<span class="sig-name descname"><span class="pre">random_explore_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ntry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.random_explore_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.random_explore_guess" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mcmc.LogLikelihood.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbmc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mcmc.html#LogLikelihood.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mcmc.LogLikelihood.run" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.mjwinstrument">
<span id="qubic-mjwinstrument-module"></span><h2>qubic.mjwinstrument module<a class="headerlink" href="#module-qubic.mjwinstrument" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.mjwinstrument.</span></span><span class="sig-name descname"><span class="pre">QubicInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FRBW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></p>
<p>The QubicInstrument class. It represents the instrument setup.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.detector_subset">
<span class="sig-name descname"><span class="pre">detector_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.detector_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.detector_subset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_aperture_integration_operator">
<span class="sig-name descname"><span class="pre">get_aperture_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_aperture_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_aperture_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in the telescope aperture.
Convert signal from W / m^2 / Hz into W / Hz.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_convolution_peak_operator">
<span class="sig-name descname"><span class="pre">get_convolution_peak_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_convolution_peak_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_convolution_peak_operator" title="Link to this definition"></a></dt>
<dd><p>Return an operator that convolves the Healpix sky by the gaussian
kernel that, if used in conjonction with the peak sampling operator,
best approximates the synthetic beam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_detector_integration_operator">
<span class="sig-name descname"><span class="pre">get_detector_integration_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_detector_integration_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_detector_integration_operator" title="Link to this definition"></a></dt>
<dd><p>Integrate flux density in detector solid angles and take into account
the secondary beam transmission.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_detector_response_operator">
<span class="sig-name descname"><span class="pre">get_detector_response_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_detector_response_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_detector_response_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator for the bolometer responses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_filter_operator">
<span class="sig-name descname"><span class="pre">get_filter_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_filter_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_filter_operator" title="Link to this definition"></a></dt>
<dd><p>Return the filter operator.
Convert units from W/Hz to W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_hwp_operator">
<span class="sig-name descname"><span class="pre">get_hwp_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_hwp_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_hwp_operator" title="Link to this definition"></a></dt>
<dd><p>Return the rotation matrix for the half-wave plate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_invntt_operator">
<span class="sig-name descname"><span class="pre">get_invntt_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_invntt_operator" title="Link to this definition"></a></dt>
<dd><p>Return the inverse time-time noise correlation matrix as an Operator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">photon_noise=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation=&lt;function</span> <span class="pre">operation_assignment&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_noise" title="Link to this definition"></a></dt>
<dd><p>Return a noisy timeline.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_noise_detector">
<span class="sig-name descname"><span class="pre">get_noise_detector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_noise_detector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_noise_detector" title="Link to this definition"></a></dt>
<dd><p>Return the detector noise (#det, #sampling).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_noise_photon">
<span class="sig-name descname"><span class="pre">get_noise_photon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_noise_photon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_noise_photon" title="Link to this definition"></a></dt>
<dd><p>Return the photon noise (#det, #sampling).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_polarizer_operator">
<span class="sig-name descname"><span class="pre">get_polarizer_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_polarizer_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_polarizer_operator" title="Link to this definition"></a></dt>
<dd><p>Return operator for the polarizer grid.
When the polarizer is not present a transmission of 1 is assumed
for the detectors on the first focal plane and of 0 for the other.
Otherwise, the signal is split onto the focal planes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_projection_operator">
<span class="sig-name descname"><span class="pre">get_projection_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_projection_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_projection_operator" title="Link to this definition"></a></dt>
<dd><p>Return the peak sampling operator.
Convert units from W to W/sr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampling</strong> (<a class="reference internal" href="#qubic.samplings.QubicSampling" title="qubic.samplings.QubicSampling"><em>QubicSampling</em></a>)  The pointing information.</p></li>
<li><p><strong>scene</strong> (<a class="reference internal" href="#qubic.scene.QubicScene" title="qubic.scene.QubicScene"><em>QubicScene</em></a>)  The observed scene.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>)  If true, display information about the memory allocation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_synthbeam">
<span class="sig-name descname"><span class="pre">get_synthbeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwp_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_integrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_synthbeam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_synthbeam" title="Link to this definition"></a></dt>
<dd><p>Return the detector synthetic beams, computed from the superposition
of the electromagnetic fields.</p>
<p>The synthetic beam B_d = (B_d,i) of a given detector d is such that
the power I_d in [W] collected by this detector observing a sky S=(S_i)
in [W/m^2/Hz] is:</p>
<blockquote>
<div><p>I_d = (S | B_d) = sum_i S_i * B_d,i.</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span> <span class="o">=</span> <span class="n">QubicScene</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inst</span> <span class="o">=</span> <span class="n">QubicInstrument</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sb</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">get_synthbeam</span><span class="p">(</span><span class="n">scene</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The power collected by the bolometers in W, given a sky in W/m/Hz is:
&gt;&gt;&gt; sb = inst.get_synthbeam(scene)
&gt;&gt;&gt; sky = scene.ones()   # [W/m/Hz]
&gt;&gt;&gt; P = np.dot(sb, sky)  # [W]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scene</strong> (<a class="reference internal" href="#qubic.scene.QubicScene" title="qubic.scene.QubicScene"><em>QubicScene</em></a>)  The scene.</p></li>
<li><p><strong>idet</strong> (<em>int</em><em>, </em><em>optional</em>)  The detector number. By default, the synthetic beam is computed for
all detectors.</p></li>
<li><p><strong>theta_max</strong> (<em>float</em><em>, </em><em>optional</em>)  The maximum zenithal angle above which the synthetic beam is
assumed to be zero, in degrees.</p></li>
<li><p><strong>external_A</strong> (<em>list</em><em> of </em><em>tables describing the phase and amplitude at each point</em><em> of </em><em>the focal</em>)  plane for each of the horns:
[0] : array, X coordinates with shape (n) in GRF [m]
[1] : array, Y coordinates with shape (n) in GRF [m]
[2] : array, amplitude on X with shape (n, nhorns)
[3] : array, amplitude on Y with shape (n, nhorns)
[4] : array, phase on X with shape (n, nhorns) [rad]
[5] : array, phase on Y with shape (n, nhorns) [rad]</p></li>
<li><p><strong>hwp_position</strong> (<em>int</em>)  HWP position from 0 to 7.</p></li>
<li><p><strong>detector_integrate</strong> (<em>Optional</em><em>, </em><em>number</em><em> of </em><em>subpixels in x direction for integration over detectors</em>)  default (None) is no integration =&gt; uses the center of the pixel</p></li>
<li><p><strong>detpos</strong> (<em>Optional</em><em>, </em><em>position in the focal plane at which the Synthesized Beam is desired as np.array</em><em>(</em><em>[</em><em>x</em><em>,</em><em>y</em><em>,</em><em>z</em><em>]</em><em>)</em>)  </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.get_transmission_operator">
<span class="sig-name descname"><span class="pre">get_transmission_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.get_transmission_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.get_transmission_operator" title="Link to this definition"></a></dt>
<dd><p>Return the operator that multiplies by the cumulative instrumental
transmission.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.jchedit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jchedit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthbeam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_beam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpeaks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.jchedit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.jchedit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.remove_significant_peaks">
<span class="sig-name descname"><span class="pre">remove_significant_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthbeam</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.remove_significant_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.remove_significant_peaks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicInstrument.synthbeam_file">
<span class="sig-name descname"><span class="pre">synthbeam_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicInstrument.synthbeam_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicInstrument.synthbeam_file" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicMultibandInstrument">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.mjwinstrument.</span></span><span class="sig-name descname"><span class="pre">QubicMultibandInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicMultibandInstrument"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicMultibandInstrument" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The QubicMultibandInstrument class
Represents the QUBIC multiband features
as an array of QubicInstrumet objects</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicMultibandInstrument.detector_subset">
<span class="sig-name descname"><span class="pre">detector_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicMultibandInstrument.detector_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicMultibandInstrument.detector_subset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicMultibandInstrument.direct_convolution">
<span class="sig-name descname"><span class="pre">direct_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicMultibandInstrument.direct_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicMultibandInstrument.direct_convolution" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.mjwinstrument.QubicMultibandInstrument.get_synthbeam">
<span class="sig-name descname"><span class="pre">get_synthbeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_integrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/mjwinstrument.html#QubicMultibandInstrument.get_synthbeam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.mjwinstrument.QubicMultibandInstrument.get_synthbeam" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.multiacquisition">
<span id="qubic-multiacquisition-module"></span><h2>qubic.multiacquisition module<a class="headerlink" href="#module-qubic.multiacquisition" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.multiacquisition.QubicMultibandAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.multiacquisition.</span></span><span class="sig-name descname"><span class="pre">QubicMultibandAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiinstrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/multiacquisition.html#QubicMultibandAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.multiacquisition.QubicMultibandAcquisition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qubic.polyacquisition.QubicPolyAcquisition" title="qubic.polyacquisition.QubicPolyAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubicPolyAcquisition</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.multiacquisition.QubicMultibandAcquisition.get_operator">
<span class="sig-name descname"><span class="pre">get_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/multiacquisition.html#QubicMultibandAcquisition.get_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.multiacquisition.QubicMultibandAcquisition.get_operator" title="Link to this definition"></a></dt>
<dd><p>Return an sum of operators for subacquisitions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.multiacquisition.QubicMultibandAcquisition.get_preconditioner">
<span class="sig-name descname"><span class="pre">get_preconditioner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/multiacquisition.html#QubicMultibandAcquisition.get_preconditioner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.multiacquisition.QubicMultibandAcquisition.get_preconditioner" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.multiacquisition.QubicMultibandPlanckAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.multiacquisition.</span></span><span class="sig-name descname"><span class="pre">QubicMultibandPlanckAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planck</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/multiacquisition.html#QubicMultibandPlanckAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition" title="qubic.polyacquisition.QubicPolyPlanckAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubicPolyPlanckAcquisition</span></code></a></p>
<p>The QubicMultibandPlanckAcquisition class, which combines the QubicMultiband and Planck
acquisitions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.multiacquisition.QubicMultibandPlanckAcquisition.get_observation">
<span class="sig-name descname"><span class="pre">get_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/multiacquisition.html#QubicMultibandPlanckAcquisition.get_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition.get_observation" title="Link to this definition"></a></dt>
<dd><p>Return the fused observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maps</strong> (<em>numpy array</em><em> of </em><em>shape</em><em> (</em><em>nbands</em><em>, </em><em>npix</em><em>, </em><em>3</em><em>)</em>)  True input multiband maps</p></li>
<li><p><strong>noiseless</strong> (<em>boolean</em><em>, </em><em>optional</em>)  If set, return a noiseless observation</p></li>
<li><p><strong>convolution</strong> (<em>boolean</em><em>, </em><em>optional</em>)  If set,</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.multiacquisition.QubicMultibandPlanckAcquisition.get_preconditioner">
<span class="sig-name descname"><span class="pre">get_preconditioner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/multiacquisition.html#QubicMultibandPlanckAcquisition.get_preconditioner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition.get_preconditioner" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.multiacquisition.QubicMultibandPlanckAcquisition.tod2map">
<span class="sig-name descname"><span class="pre">tod2map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/multiacquisition.html#QubicMultibandPlanckAcquisition.tod2map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.multiacquisition.QubicMultibandPlanckAcquisition.tod2map" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.plotters">
<span id="qubic-plotters-module"></span><h2>qubic.plotters module<a class="headerlink" href="#module-qubic.plotters" title="Link to this heading"></a></h2>
<p>Created on Tue Jan 29 09:44:35 2019</p>
<p>&#64;author: james, louise, JCH</p>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.plotters.Allplots">
<span class="sig-prename descclassname"><span class="pre">qubic.plotters.</span></span><span class="sig-name descname"><span class="pre">Allplots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allparams1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allparams2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">okfinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">okfinal1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">okfinal2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">med</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/plotters.html#Allplots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.plotters.Allplots" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.plotters.FiltFreqResp">
<span class="sig-prename descclassname"><span class="pre">qubic.plotters.</span></span><span class="sig-name descname"><span class="pre">FiltFreqResp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FREQ_SAMPLING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/plotters.html#FiltFreqResp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.plotters.FiltFreqResp" title="Link to this definition"></a></dt>
<dd><p>Plot original and notch filtered frequency.
sigfilt requires you select for which TES you would like to
apply the notch filter - single TES analysis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.plotters.FoldedFiltTES">
<span class="sig-prename descclassname"><span class="pre">qubic.plotters.</span></span><span class="sig-name descname"><span class="pre">FoldedFiltTES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded_notch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/plotters.html#FoldedFiltTES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.plotters.FoldedFiltTES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.plotters.FoldedTESFreeFit">
<span class="sig-prename descclassname"><span class="pre">qubic.plotters.</span></span><span class="sig-name descname"><span class="pre">FoldedTESFreeFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bla</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/plotters.html#FoldedTESFreeFit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.plotters.FoldedTESFreeFit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.plotters.FreqResp">
<span class="sig-prename descclassname"><span class="pre">qubic.plotters.</span></span><span class="sig-name descname"><span class="pre">FreqResp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theTES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/plotters.html#FreqResp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.plotters.FreqResp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.plotters.TESvsThermo">
<span class="sig-prename descclassname"><span class="pre">qubic.plotters.</span></span><span class="sig-name descname"><span class="pre">TESvsThermo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">okfinal1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">okfinal2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/plotters.html#TESvsThermo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.plotters.TESvsThermo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.plotters.TimeSigPlot">
<span class="sig-prename descclassname"><span class="pre">qubic.plotters.</span></span><span class="sig-name descname"><span class="pre">TimeSigPlot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theTES</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/plotters.html#TimeSigPlot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.plotters.TimeSigPlot" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-qubic.polyacquisition">
<span id="qubic-polyacquisition-module"></span><h2>qubic.polyacquisition module<a class="headerlink" href="#module-qubic.polyacquisition" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.polyacquisition.</span></span><span class="sig-name descname"><span class="pre">QubicPolyAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiinstrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_coverage">
<span class="sig-name descname"><span class="pre">get_coverage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_coverage" title="Link to this definition"></a></dt>
<dd><p>Return an array of monochromatic coverage maps, one for each of subacquisitions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_coverage_mask">
<span class="sig-name descname"><span class="pre">get_coverage_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coverages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_coverage_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_coverage_mask" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Return a healpix boolean map with True on the pixels where ALL the</dt><dd><p>subcoverages are above covlim * subcoverage.max()</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_invntt_operator">
<span class="sig-name descname"><span class="pre">get_invntt_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_invntt_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_invntt_operator" title="Link to this definition"></a></dt>
<dd><p>Return the inverse noise covariance matrix as operator</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_noise" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_observation">
<span class="sig-name descname"><span class="pre">get_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_observation" title="Link to this definition"></a></dt>
<dd><p>Return TOD for polychromatic synthesised beam,
just the same way as QubicPolyAcquisition.get_observation does</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>np.array</em><em>(</em><em>(</em><em>N</em><em>, </em><em>npix</em><em>, </em><em>3</em><em>)</em><em>) </em><em>if self.scene.kind == 'IQU'</em><em>, </em><em>else np.array</em><em>(</em><em>(</em><em>npix</em><em>)</em><em>)</em>)  <dl class="simple">
<dt>where N = len(self) if convolution == True or</dt><dd><p>N = len(self.bands) if convolution == False</p>
</dd>
</dl>
<p>Helpix map of CMB for all the frequencies</p>
</p></li>
<li><p><strong>convolution</strong> (<em>boolean</em><em>, </em><em>optional</em><em> [</em><em>default and recommended = True</em><em>]</em>)  <ul>
<li><p>if True, convolve the input map with gaussian kernel</p></li>
</ul>
<p>with width specific for each subfrequency and
return TOD, convolved map,
(for example, we use 4 monochromatic frequencies and divide them</p>
<blockquote>
<div><p>to 2 subbands)</p>
</div></blockquote>
<p>where TOD = [H1, H2, H3, H4] * [m_conv1, m_conv2, m_conv3, m_conv4].T
and convolved map = [average([m_conv1, m_conv2]), average([m_conv3, m_conv4])]
- if False, the input map is considered as already convolved
and the return is just TOD, which is equal to
[sum(H1, H2, H3, )] * input_map</p>
</p></li>
<li><p><strong>noiseless</strong> (<em>boolean</em><em>, </em><em>optional</em><em> [</em><em>default=False</em><em>]</em>)  if False, add noise to the TOD due to the model</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_operator">
<span class="sig-name descname"><span class="pre">get_operator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_operator" title="Link to this definition"></a></dt>
<dd><p>Return an sum of operators for subacquisitions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_operator_to_make_TOD">
<span class="sig-name descname"><span class="pre">get_operator_to_make_TOD</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_operator_to_make_TOD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_operator_to_make_TOD" title="Link to this definition"></a></dt>
<dd><p>Return a BlockRowOperator of subacquisition operators
In polychromatic mode it is only applied to produce the TOD
To reconstruct maps one should use the get_operator function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.get_preconditioner">
<span class="sig-name descname"><span class="pre">get_preconditioner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.get_preconditioner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.get_preconditioner" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.tod2map">
<span class="sig-name descname"><span class="pre">tod2map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.tod2map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.tod2map" title="Link to this definition"></a></dt>
<dd><p>Reconstruct map from tod</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyAcquisition.warnings">
<span class="sig-name descname"><span class="pre">warnings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyAcquisition.warnings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyAcquisition.warnings" title="Link to this definition"></a></dt>
<dd><p>This method prevent to you that beam is not a good
approximation in the 220 GHz band.
Also can be used to add new warnings when acquisition is created in
specific configuration.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyPlanckAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.polyacquisition.</span></span><span class="sig-name descname"><span class="pre">QubicPolyPlanckAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planck</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyPlanckAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qubic.acquisition.QubicPlanckAcquisition" title="qubic.acquisition.QubicPlanckAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubicPlanckAcquisition</span></code></a></p>
<p>The QubicPolyAcquisition class, which combines the QubicPoly and Planck
acquisitions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyPlanckAcquisition.get_observation">
<span class="sig-name descname"><span class="pre">get_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyPlanckAcquisition.get_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition.get_observation" title="Link to this definition"></a></dt>
<dd><p>Return fusion observation as a sum of monochromatic fusion TODs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyPlanckAcquisition.get_preconditioner">
<span class="sig-name descname"><span class="pre">get_preconditioner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyPlanckAcquisition.get_preconditioner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition.get_preconditioner" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.polyacquisition.QubicPolyPlanckAcquisition.tod2map">
<span class="sig-name descname"><span class="pre">tod2map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#QubicPolyPlanckAcquisition.tod2map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.QubicPolyPlanckAcquisition.tod2map" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.polyacquisition.compute_freq">
<span class="sig-prename descclassname"><span class="pre">qubic.polyacquisition.</span></span><span class="sig-name descname"><span class="pre">compute_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/polyacquisition.html#compute_freq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.polyacquisition.compute_freq" title="Link to this definition"></a></dt>
<dd><p>Prepare frequency bands parameters
band  int,</p>
<blockquote>
<div><p>QUBIC frequency band, in GHz.
Typical values: 150, 220</p>
</div></blockquote>
<dl class="simple">
<dt>relative_bandwidth  float, optional</dt><dd><p>Ratio of the difference between the edges of the
frequency band over the average frequency of the band:
2 * (nu_max - nu_min) / (nu_max + nu_min)
Typical value: 0.25</p>
</dd>
<dt>Nfreq  int, optional</dt><dd><p>Number of frequencies within the wide band.
If not specified, then Nfreq = 15 if band == 150
and Nfreq = 20 if band = 220</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-qubic.qubicdict">
<span id="qubic-qubicdict-module"></span><h2>qubic.qubicdict module<a class="headerlink" href="#module-qubic.qubicdict" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.qubicdict.ask_for">
<span class="sig-prename descclassname"><span class="pre">qubic.qubicdict.</span></span><span class="sig-name descname"><span class="pre">ask_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/qubicdict.html#ask_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.qubicdict.ask_for" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.qubicdict.qubicDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.qubicdict.</span></span><span class="sig-name descname"><span class="pre">qubicDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/qubicdict.html#qubicDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.qubicdict.qubicDict" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.qubicdict.qubicDict.cmp">
<span class="sig-name descname"><span class="pre">cmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">otherDict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/qubicdict.html#qubicDict.cmp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.qubicdict.qubicDict.cmp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.qubicdict.qubicDict.dicts_dir">
<span class="sig-name descname"><span class="pre">dicts_dir</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/home/donnachao/miniconda3/envs/venv-qubic/lib/python3.9/site-packages/qubic/dicts'</span></em><a class="headerlink" href="#qubic.qubicdict.qubicDict.dicts_dir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.qubicdict.qubicDict.readFromFile">
<span class="sig-name descname"><span class="pre">readFromFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qubic.qubicdict.qubicDict.readFromFile" title="Link to this definition"></a></dt>
<dd><p>read a given dictionary file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.qubicdict.qubicDict.read_from_file">
<span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/qubicdict.html#qubicDict.read_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.qubicdict.qubicDict.read_from_file" title="Link to this definition"></a></dt>
<dd><p>read a given dictionary file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.qubicdict.qubicDict.writeToFile">
<span class="sig-name descname"><span class="pre">writeToFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qubic.qubicdict.qubicDict.writeToFile" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.qubicdict.qubicDict.write_to_file">
<span class="sig-name descname"><span class="pre">write_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/qubicdict.html#qubicDict.write_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.qubicdict.qubicDict.write_to_file" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.ripples">
<span id="qubic-ripples-module"></span><h2>qubic.ripples module<a class="headerlink" href="#module-qubic.ripples" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.ripples.BeamGaussianRippled">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.ripples.</span></span><span class="sig-name descname"><span class="pre">BeamGaussianRippled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nripples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ripples.html#BeamGaussianRippled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ripples.BeamGaussianRippled" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BeamGaussian</span></code></p>
<p>Axisymmetric gaussian beam with ripples.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.ripples.ConvolutionRippledGaussianOperator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.ripples.</span></span><span class="sig-name descname"><span class="pre">ConvolutionRippledGaussianOperator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nripples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ripples.html#ConvolutionRippledGaussianOperator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ripples.ConvolutionRippledGaussianOperator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">HealpixConvolutionGaussianOperator</span></code></p>
<p>Convolve a Healpix map by a gaussian kernel, modulated by ripples.</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.ripples.ConvolutionRippledGaussianOperator.direct">
<span class="sig-name descname"><span class="pre">direct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/ripples.html#ConvolutionRippledGaussianOperator.direct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.ripples.ConvolutionRippledGaussianOperator.direct" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qubic.samplings">
<span id="qubic-samplings-module"></span><h2>qubic.samplings module<a class="headerlink" href="#module-qubic.samplings" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">QubicSampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/samplings.html#QubicSampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.QubicSampling" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SamplingHorizontal</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.azimuth">
<span class="sig-name descname"><span class="pre">azimuth</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.azimuth" title="Link to this definition"></a></dt>
<dd><p>The pointing azimuth [degrees].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.elevation">
<span class="sig-name descname"><span class="pre">elevation</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.elevation" title="Link to this definition"></a></dt>
<dd><p>The pointing elevation [degrees].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.pitch">
<span class="sig-name descname"><span class="pre">pitch</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.pitch" title="Link to this definition"></a></dt>
<dd><p>The instrument pitch angle [degrees].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.angle_hwp">
<span class="sig-name descname"><span class="pre">angle_hwp</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.angle_hwp" title="Link to this definition"></a></dt>
<dd><p>The half-wave plate angle [degrees].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.time">
<span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.time" title="Link to this definition"></a></dt>
<dd><p>Elapsed time for each pointing since the observation start date,
in seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.date_obs">
<span class="sig-name descname"><span class="pre">date_obs</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.date_obs" title="Link to this definition"></a></dt>
<dd><p>The observation start date.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string or astropy.time.Time</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.period">
<span class="sig-name descname"><span class="pre">period</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.period" title="Link to this definition"></a></dt>
<dd><p>The sampling period [s].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.latitude">
<span class="sig-name descname"><span class="pre">latitude</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.latitude" title="Link to this definition"></a></dt>
<dd><p>Telescope latitude [degrees].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.longitude">
<span class="sig-name descname"><span class="pre">longitude</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.longitude" title="Link to this definition"></a></dt>
<dd><p>Telescope longitude [degrees].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<dl class="simple">
<dt>pointing = QubicSampling(azimuth=azimuth, elevation=elevation,</dt><dd><p>angle_hwp=angle_hwp, period=)</p>
</dd>
</dl>
<p>pointing = QubicSampling(azimuth, elevation, pitch, angle_hwp, period=)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.DEFAULT_DATE_OBS">
<span class="sig-name descname"><span class="pre">DEFAULT_DATE_OBS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'2016-01-01</span> <span class="pre">00:00:00'</span></em><a class="headerlink" href="#qubic.samplings.QubicSampling.DEFAULT_DATE_OBS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.DEFAULT_LATITUDE">
<span class="sig-name descname"><span class="pre">DEFAULT_LATITUDE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-24.183333333333334</span></em><a class="headerlink" href="#qubic.samplings.QubicSampling.DEFAULT_LATITUDE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.DEFAULT_LONGITUDE">
<span class="sig-name descname"><span class="pre">DEFAULT_LONGITUDE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-66.46666666666667</span></em><a class="headerlink" href="#qubic.samplings.QubicSampling.DEFAULT_LONGITUDE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.DEFAULT_PERIOD">
<span class="sig-name descname"><span class="pre">DEFAULT_PERIOD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#qubic.samplings.QubicSampling.DEFAULT_PERIOD" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.cartesian_galactic2instrument">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cartesian_galactic2instrument</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.cartesian_galactic2instrument" title="Link to this definition"></a></dt>
<dd><p>Return the galactic-to-instrument transform.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.cartesian_horizontal2instrument">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cartesian_horizontal2instrument</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.cartesian_horizontal2instrument" title="Link to this definition"></a></dt>
<dd><p>Return the galactic-to-instrument transform.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.cartesian_instrument2galactic">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cartesian_instrument2galactic</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.cartesian_instrument2galactic" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.cartesian_instrument2horizontal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cartesian_instrument2horizontal</span></span><a class="headerlink" href="#qubic.samplings.QubicSampling.cartesian_instrument2horizontal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.samplings.QubicSampling.healpix">
<span class="sig-name descname"><span class="pre">healpix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nside</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/samplings.html#QubicSampling.healpix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.QubicSampling.healpix" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.create_random_pointings">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">create_random_pointings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npointings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwp_stepsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/samplings.html#create_random_pointings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.create_random_pointings" title="Link to this definition"></a></dt>
<dd><p>Return pointings randomly and uniformly distributed in a spherical cap.</p>
<p>1) Creates random coordinates theta, phi. Range: 0 &lt; theta &lt; dtheta, 0 &lt; phi &lt; 360
(then are converted from spherical to cartesian coordinates),
2) It rotates the points to center them in direction (RA, DEC) using Rotation3dOperator
(equatorial reference system)
3) Convertion: Equatorial to Horizontal reference system
(using CartesianEquatorial2HorizontalOperators operator)
4) Back to cartesian coordinates (using Cartesian2SphericalOperator)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>2-tuple</em>)  The R.A. and declination of the center of the FOV, in degrees.</p></li>
<li><p><strong>npointings</strong> (<em>int</em>)  The number of requested pointings</p></li>
<li><p><strong>dtheta</strong> (<em>float</em>)  The maximum angular distance to the center.</p></li>
<li><p><strong>hwp_stepsize</strong> (<em>float</em>)  Step angle size for the HWP.</p></li>
<li><p><strong>date_obs</strong> (<em>str</em><em> or </em><em>astropy.time.Time</em><em>, </em><em>optional</em>)  The starting date of the observation (UTC).</p></li>
<li><p><strong>period</strong> (<em>float</em><em>, </em><em>optional</em>)  The sampling period of the pointings, in seconds.</p></li>
<li><p><strong>latitude</strong> (<em>float</em><em>, </em><em>optional</em>)  The observers latitude [degrees]. Default is DOMECs.</p></li>
<li><p><strong>longitude</strong> (<em>float</em><em>, </em><em>optional</em>)  The observers longitude [degrees]. Default is DOMECs.</p></li>
<li><p><strong>seed</strong> (<em>int</em>)  Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.create_repeat_pointings">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">create_repeat_pointings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npointings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhwp_angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/samplings.html#create_repeat_pointings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.create_repeat_pointings" title="Link to this definition"></a></dt>
<dd><p>Return pointings randomly and uniformly distributed in a spherical cap.
The same pointing is repeated nhwp_angles times with a different
hwp angle each time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>2-tuple</em>)  The R.A. and declination of the center of the FOV, in degrees.</p></li>
<li><p><strong>npointings</strong> (<em>int</em>)  The number of requested pointings</p></li>
<li><p><strong>dtheta</strong> (<em>float</em>)  The maximum angular distance to the center.</p></li>
<li><p><strong>nhwp_angles</strong> (<em>int</em>)  The number of HWP angles used.</p></li>
<li><p><strong>date_obs</strong> (<em>str</em><em> or </em><em>astropy.time.Time</em><em>, </em><em>optional</em>)  The starting date of the observation (UTC).</p></li>
<li><p><strong>period</strong> (<em>float</em><em>, </em><em>optional</em>)  The sampling period of the pointings, in seconds.</p></li>
<li><p><strong>latitude</strong> (<em>float</em><em>, </em><em>optional</em>)  The observers latitude [degrees]. Default is DOMECs.</p></li>
<li><p><strong>longitude</strong> (<em>float</em><em>, </em><em>optional</em>)  The observers longitude [degrees]. Default is DOMECs.</p></li>
<li><p><strong>seed</strong> (<em>int</em>)  Random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.create_sweeping_pointings">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">create_sweeping_pointings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angspeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsweeps_per_elevation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angspeed_psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxpsi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwp_stepsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_azimuth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_hwp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/samplings.html#create_sweeping_pointings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.create_sweeping_pointings" title="Link to this definition"></a></dt>
<dd><p>Return pointings according to the sweeping strategy:
Sweep around the tracked FOV center azimuth at a fixed elevation, and
update elevation towards the FOV center at discrete times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>array-like</em><em> of </em><em>size 2</em>)  The R.A. and Declination of the center of the FOV.</p></li>
<li><p><strong>duration</strong> (<em>float</em>)  The duration of the observation, in hours.</p></li>
<li><p><strong>period</strong> (<em>float</em>)  The sampling period of the pointings, in seconds.</p></li>
<li><p><strong>angspeed</strong> (<em>float</em>)  The pointing angular speed, in deg / s.</p></li>
<li><p><strong>delta_az</strong> (<em>float</em>)  The sweeping extent in degrees.</p></li>
<li><p><strong>nsweeps_per_elevation</strong> (<em>int</em>)  The number of sweeps during a phase of constant elevation.</p></li>
<li><p><strong>angspeed_psi</strong> (<em>float</em>)  The pitch angular speed, in deg / s.</p></li>
<li><p><strong>maxpsi</strong> (<em>float</em>)  The maximum pitch angle, in degrees.</p></li>
<li><p><strong>latitude</strong> (<em>float</em><em>, </em><em>optional</em>)  The observers latitude [degrees]. Default is DOMECs.</p></li>
<li><p><strong>longitude</strong> (<em>float</em><em>, </em><em>optional</em>)  The observers longitude [degrees]. Default is DOMECs.</p></li>
<li><p><strong>fix_azimuth</strong> (<em>bool</em>)  </p></li>
<li><p><strong>hwp_stepsize</strong> (<em>float</em>)  Step angle size for the HWP.</p></li>
<li><p><strong>date_obs</strong> (<em>str</em><em> or </em><em>astropy.time.Time</em><em>, </em><em>optional</em>)  The starting date of the observation (UTC).</p></li>
<li><p><strong>random_hwp</strong> (<em>bool</em>)  </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pointings</strong>  Structured array containing the azimuth, elevation and pitch angles,
in degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qubic.samplings.QubicSampling" title="qubic.samplings.QubicSampling">QubicSampling</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.equ2gal">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">equ2gal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">l</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">b</span></span></span><a class="reference internal" href="_modules/qubic/samplings.html#equ2gal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.equ2gal" title="Link to this definition"></a></dt>
<dd><p>Equatorial to galactic spherical conversion. Angles are in degrees.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.equ2hor">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">equ2hor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">az</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">el</span></span></span><a class="reference internal" href="_modules/qubic/samplings.html#equ2hor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.equ2hor" title="Link to this definition"></a></dt>
<dd><p>Equatorial to horizontal spherical conversion. Angles are in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra</strong> (<em>float</em>)  Right ascension in degrees.</p></li>
<li><p><strong>dec</strong> (<em>float</em>)  Declination in degrees.</p></li>
<li><p><strong>time</strong> (<em>array-like</em>)  Elapsed time in seconds since date_obs.</p></li>
<li><p><strong>date_obs</strong> (<em>string</em>)  The starting date, UTC.</p></li>
<li><p><strong>latitude</strong> (<em>float</em>)  The observers latitude geolocation. Default is Dome C.</p></li>
<li><p><strong>longitude</strong> (<em>float</em>)  The observers longitude geolocation. Default is Dome C.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">equ2hor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">date_obs</span><span class="o">=</span><span class="s1">&#39;2000-01-01 00:00:00&#39;</span><span class="p">)</span>
<span class="go">(array(135.71997181016644), array(-10.785386358099927))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.gal2equ">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">gal2equ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ra</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dec</span></span></span><a class="reference internal" href="_modules/qubic/samplings.html#gal2equ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.gal2equ" title="Link to this definition"></a></dt>
<dd><p>Galactic to equatorial spherical conversion. Angles are in degrees.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.gal2hor">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">gal2hor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">az</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">el</span></span></span><a class="reference internal" href="_modules/qubic/samplings.html#gal2hor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.gal2hor" title="Link to this definition"></a></dt>
<dd><p>Galactic to horizontal spherical conversion. Angles are in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>array-like</em>)  Elapsed time in seconds since date_obs.</p></li>
<li><p><strong>date_obs</strong> (<em>string</em>)  The starting date, UTC.</p></li>
<li><p><strong>latitude</strong> (<em>float</em>)  The observers latitude geolocation. Default is Dome C.</p></li>
<li><p><strong>longitude</strong> (<em>float</em>)  The observers longitude geolocation. Default is Dome C.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gal2hor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(array(50.35837815921487), array(39.212362279976155))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.get_pointing">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">get_pointing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/samplings.html#get_pointing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.get_pointing" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.hor2equ">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">hor2equ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ra</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dec</span></span></span><a class="reference internal" href="_modules/qubic/samplings.html#hor2equ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.hor2equ" title="Link to this definition"></a></dt>
<dd><p>Horizontal to equatorial spherical conversion. Angles are in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>azimuth</strong> (<em>float</em>)  </p></li>
<li><p><strong>elevation</strong> (<em>float</em>)  </p></li>
<li><p><strong>time</strong> (<em>array-like</em>)  Elapsed time in seconds since date_obs.</p></li>
<li><p><strong>date_obs</strong> (<em>string</em>)  The starting date, UTC.</p></li>
<li><p><strong>latitude</strong> (<em>float</em>)  The observers latitude geolocation. Default is Dome C.</p></li>
<li><p><strong>longitude</strong> (<em>float</em>)  The observers longitude geolocation. Default is Dome C.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hor2equ</span><span class="p">(</span><span class="mf">135.71997181016644</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.785386358099927</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">date_obs</span><span class="o">=</span><span class="s1">&#39;2000-01-01 00:00:00&#39;</span><span class="p">)</span>
<span class="go">(array(1.1927080055488187e-14), array(-1.2722218725854067e-14))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.samplings.hor2gal">
<span class="sig-prename descclassname"><span class="pre">qubic.samplings.</span></span><span class="sig-name descname"><span class="pre">hor2gal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">date_obs</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">l</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">b</span></span></span><a class="reference internal" href="_modules/qubic/samplings.html#hor2gal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.samplings.hor2gal" title="Link to this definition"></a></dt>
<dd><p>Horizontal to galactic spherical conversion. Angles are in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>azimuth</strong> (<em>float</em>)  </p></li>
<li><p><strong>elevation</strong> (<em>float</em>)  </p></li>
<li><p><strong>time</strong> (<em>array-like</em>)  Elapsed time in seconds since date_obs.</p></li>
<li><p><strong>date_obs</strong> (<em>string</em>)  The starting date, UTC.</p></li>
<li><p><strong>latitude</strong> (<em>float</em>)  The observers latitude geolocation. Default is Dome C.</p></li>
<li><p><strong>longitude</strong> (<em>float</em>)  The observers longitude geolocation. Default is Dome C.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hor2gal</span><span class="p">(</span><span class="mf">50.35837815921487</span><span class="p">,</span> <span class="mf">39.212362279976155</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(array(4.452776554048925e-14), array(-7.63333123551244e-14))</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-qubic.sb_fitting">
<span id="qubic-sb-fitting-module"></span><h2>qubic.sb_fitting module<a class="headerlink" href="#module-qubic.sb_fitting" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.sb_fitting.SbModelIndepPeaks">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">SbModelIndepPeaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">startpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_xy_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distortion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#SbModelIndepPeaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.SbModelIndepPeaks" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining the simplest Synthesized Beam model for QUBIC:
- A square grid of n Gaussian Peaks with the same symmetric FWHM.
- n is defined by nrings (1=&gt;1 peak, 2=&gt;9 peaks, )
- The square grid has a rotation angle
- The amplitude of the peaks are independent
- The FWHM of the peaks can be all the same or different depending on the keyword common_fwhm</p>
<blockquote>
<div><p>If common_fwhm is True then this model is equivalent to SbModelIndepPeaksAmp</p>
</div></blockquote>
<ul class="simple">
<li><p>A global distorsion to the position of the peaks is allowed</p></li>
<li><p>A small shift of each peak position is allowed around the initial position</p></li>
</ul>
<p>So if common_fwhm=True and no_xy_shift=True and distrotion=True this model is equivalent to SbModelIndepPeaksAmp
So if common_fwhm=False and no_xy_shift=True and distortion=True this model is equivalent to SbModelIndepPeaksAmpFWHM</p>
<p>So Finally parameters are:
[0]: Az center of the square [deg]
[1]: El center of the square [deg]
[2]: Interpeak distance [deg]
[3]: Orientation angle [deg]
[4]: X distorsion magnitude
[5]: X distosion power
[6]: Y distorsion magnitude
[7]: Y distorsion power
[8]: Average FWHM of the peaks
[9+4*ipeak]: Amplitudes of the peaks
[9+4*ipeak+1]: Delta FWHM of each peak to be added to the average one [deg]
[9+4*ipeak+2]: X shift of the peak [deg]
[9+4*ipeak+3]: Y shift of the peak [deg]</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.sb_fitting.SbModelIndepPeaks.print_start">
<span class="sig-name descname"><span class="pre">print_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#SbModelIndepPeaks.print_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.SbModelIndepPeaks.print_start" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.sb_fitting.SbModelIndepPeaksAmpFWHM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">SbModelIndepPeaksAmpFWHM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">startpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#SbModelIndepPeaksAmpFWHM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.SbModelIndepPeaksAmpFWHM" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining the simplest Synthesized Beam model for QUBIC:
- A square grid of n Gaussian Peaks with the same symmetric FWHM.
- n is defined by nrings (1=&gt;1 peak, 2=&gt;9 peaks, )
- The square grid has a rotation angle
- The amplitude of the peaks are independent
- The FWHM of the peaks can be all the same or different depending on the keyword common_fwhm</p>
<blockquote>
<div><p>If common_fwhm is True then this model is equivalent to SbModelIndepPeaksAmp</p>
</div></blockquote>
<ul class="simple">
<li><p>A distorsion to the position of the peaks is allowed</p></li>
</ul>
<p>So Finally parameters are:
[0]: Az center of the square [deg]
[1]: El center of the square [deg]
[2]: Interpeak distance [deg]
[3]: Orientation angle [deg]
[4]: X distorsion magnitude
[5]: X distosion power
[6]: Y distorsion magnitude
[7]: Y distorsion power
[8]: Average FWHM of the peaks
[9+2*ipeak]: Amplitudes of the peaks
[9+2*ipeak+1]: Delta FWHM of each peak to be added to the average one [deg]</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.sb_fitting.SbModelIndepPeaksAmpFWHM.print_start">
<span class="sig-name descname"><span class="pre">print_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#SbModelIndepPeaksAmpFWHM.print_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.SbModelIndepPeaksAmpFWHM.print_start" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.sb_fitting.SimpleSbModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">SimpleSbModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">startpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixpars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#SimpleSbModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.SimpleSbModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining the simplest Synthesized Beam model for QUBIC:
- A square grid of n Gaussian Peaks with the same symmetric FWHM.
- n is defined by nrings (1=&gt;1 peak, 2=&gt;9 peaks, )
- The square grid has a rotation angle
- The amplitude of the peaks is given by a common Primary Gaussian Beam whose FWHM and center is fit
- A distorsion to the position of the peaks is allowed</p>
<p>So Finally parameters are:
[0]: Az center of the square [deg]
[1]: El center of the square [deg]
[2]: Interpeak distance [deg]
[3]: Orientation angle [deg]
[4]: X distorsion magnitude
[5]: X distosion power
[6]: Y distorsion magnitude
[7]: Y distorsion power
[8]: FWHM of the peaks [deg]
[9]: Amplitude of primary beam
[10]: Az center of primary beam [deg]
[11]: El center of primary beam [deg]
[12]: FWHM of primary beam [deg]</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.sb_fitting.SimpleSbModel.print_start">
<span class="sig-name descname"><span class="pre">print_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#SimpleSbModel.print_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.SimpleSbModel.print_start" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.ang_dist">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">ang_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thph0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thph1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#ang_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.ang_dist" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.beeps">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">beeps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbeeps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#beeps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.beeps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.fit_sb">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">fit_sb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flatmap_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fitted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsiglo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsighi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#fit_sb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.fit_sb" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.get_flatmap">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">get_flatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TESNum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitted_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#get_flatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.get_flatmap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.get_hpmap">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">get_hpmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TESNum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#get_hpmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.get_hpmap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.get_lines">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">get_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#get_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.get_lines" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.rotate_q2m">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">rotate_q2m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">1.57079633,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#rotate_q2m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.rotate_q2m" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.rotmatX">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">rotmatX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">th</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#rotmatX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.rotmatX" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.rotmatY">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">rotmatY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">th</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#rotmatY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.rotmatY" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.rotmatZ">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">rotmatZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">th</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#rotmatZ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.rotmatZ" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.show_flatmap">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">show_flatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TESNum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#show_flatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.show_flatmap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.show_flatmaps_list">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">show_flatmaps_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TESNums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#show_flatmaps_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.show_flatmaps_list" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.show_lines">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">show_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#show_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.show_lines" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.thph2uv">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">thph2uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#thph2uv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.thph2uv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qubic.sb_fitting.uv2thph">
<span class="sig-prename descclassname"><span class="pre">qubic.sb_fitting.</span></span><span class="sig-name descname"><span class="pre">uv2thph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/sb_fitting.html#uv2thph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.sb_fitting.uv2thph" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-qubic.scene">
<span id="qubic-scene-module"></span><h2>qubic.scene module<a class="headerlink" href="#module-qubic.scene" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.scene.QubicScene">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.scene.</span></span><span class="sig-name descname"><span class="pre">QubicScene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/scene.html#QubicScene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.scene.QubicScene" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SceneHealpixCMB</span></code></p>
</dd></dl>

</section>
<section id="module-qubic.selfcal_lib">
<span id="qubic-selfcal-lib-module"></span><h2>qubic.selfcal_lib module<a class="headerlink" href="#module-qubic.selfcal_lib" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.selfcal_lib.Model_Fringes_Maynooth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.selfcal_lib.</span></span><span class="sig-name descname"><span class="pre">Model_Fringes_Maynooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ONAFP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/selfcal_lib.html#Model_Fringes_Maynooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.selfcal_lib.Model_Fringes_Maynooth" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.selfcal_lib.Model_Fringes_Maynooth.get_fringes">
<span class="sig-name descname"><span class="pre">get_fringes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/selfcal_lib.html#Model_Fringes_Maynooth.get_fringes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.selfcal_lib.Model_Fringes_Maynooth.get_fringes" title="Link to this definition"></a></dt>
<dd><p>Compute fringes on the focal plane from Maynooth simulations.
:rtype: x, y coordinates on the FP in the ONAFP frame and the corresponding power.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.selfcal_lib.Model_Fringes_Maynooth.get_fringes_from_combination">
<span class="sig-name descname"><span class="pre">get_fringes_from_combination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measured_comb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/selfcal_lib.html#Model_Fringes_Maynooth.get_fringes_from_combination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.selfcal_lib.Model_Fringes_Maynooth.get_fringes_from_combination" title="Link to this definition"></a></dt>
<dd><p>Compute fringes on the focal plane from Maynooth simulations doing the combination with
S_tot, Cminus_i, Cminus_j, Sminus_ij, Ci and Cj.
:param measured_comb: If True, returns the measured combination: S_tot - Cminus_i - Cminus_j + Sminus_ij.</p>
<blockquote>
<div><p>If False, returns the complete combination: S_tot - Cminus_i - Cminus_j + Sminus_ij + Ci + Cj.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>)  </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>x, y coordinates on the FP in the ONAFP frame and the corresponding power.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qubic.selfcal_lib.Model_Fringes_QubicSoft">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.selfcal_lib.</span></span><span class="sig-name descname"><span class="pre">Model_Fringes_QubicSoft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_irrad_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ONAFP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwp_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/selfcal_lib.html#Model_Fringes_QubicSoft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.selfcal_lib.Model_Fringes_QubicSoft.get_all_combinations_power">
<span class="sig-name descname"><span class="pre">get_all_combinations_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/selfcal_lib.html#Model_Fringes_QubicSoft.get_all_combinations_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft.get_all_combinations_power" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Returns the power on the focal plane at each pointing (each position of the source),
for different configurations of the horn array: all open, all open except i, except j,
except i and j, only i open, only j open, only i and j open.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>x, y</strong> (<em>The coordinates on the FP.</em>)</p></li>
<li><p><strong>S, Cminus_i, Cminus_j, Sminus_ij, Ci, Cj, Sij</strong> (<em>arrays</em>)  Power on the focal plane for each configuration, at each pointing.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.selfcal_lib.Model_Fringes_QubicSoft.get_fringes">
<span class="sig-name descname"><span class="pre">get_fringes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/selfcal_lib.html#Model_Fringes_QubicSoft.get_fringes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft.get_fringes" title="Link to this definition"></a></dt>
<dd><p>Compute the fringes on the focal plane directly opening the baseline.
see get_response_power() for the arguments.
Returns (x, y) coordinates and the power.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.selfcal_lib.Model_Fringes_QubicSoft.get_fringes_from_combination">
<span class="sig-name descname"><span class="pre">get_fringes_from_combination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measured_comb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/selfcal_lib.html#Model_Fringes_QubicSoft.get_fringes_from_combination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.selfcal_lib.Model_Fringes_QubicSoft.get_fringes_from_combination" title="Link to this definition"></a></dt>
<dd><p>Return the fringes on the FP by making the combination</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>x, y</strong> (<em>The coordinates on the FP.</em>)</p></li>
<li><p><strong>fringes</strong> (<em>Fringes on the FP, for each coordinate, at each pointing.</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qubic.utils">
<span id="qubic-utils-module"></span><h2>qubic.utils module<a class="headerlink" href="#module-qubic.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="qubic.utils.progress_bar">
<span class="sig-prename descclassname"><span class="pre">qubic.utils.</span></span><span class="sig-name descname"><span class="pre">progress_bar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/utils.html#progress_bar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.utils.progress_bar" title="Link to this definition"></a></dt>
<dd><p>Return a default progress bar.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bar</span> <span class="o">=</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;LOOP&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">bar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-qubic.warnings">
<span id="qubic-warnings-module"></span><h2>qubic.warnings module<a class="headerlink" href="#module-qubic.warnings" title="Link to this heading"></a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="qubic.warnings.QubicDeprecationWarning">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.warnings.</span></span><span class="sig-name descname"><span class="pre">QubicDeprecationWarning</span></span><a class="reference internal" href="_modules/qubic/warnings.html#QubicDeprecationWarning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.warnings.QubicDeprecationWarning" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="qubic.warnings.QubicWarning">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.warnings.</span></span><span class="sig-name descname"><span class="pre">QubicWarning</span></span><a class="reference internal" href="_modules/qubic/warnings.html#QubicWarning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.warnings.QubicWarning" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UserWarning</span></code></p>
</dd></dl>

</section>
<section id="module-qubic.xpol">
<span id="qubic-xpol-module"></span><h2>qubic.xpol module<a class="headerlink" href="#module-qubic.xpol" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qubic.xpol.Xpol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qubic.xpol.</span></span><span class="sig-name descname"><span class="pre">Xpol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_ell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/xpol.html#Xpol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.xpol.Xpol" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>(Cross-) power spectra estimation using the Xpol method.
Hinshaw et al. 2003, Tristram 2005.</p>
<p class="rubric">Example</p>
<p>xpol = Xpol(mask, lmin, lmax, delta_ell)
ell_binned = xpol.ell_binned
biased, unbiased = xpol.get_spectra(map)
biased, unbiased = xpol.get_spectra(map1, map2)</p>
<dl class="py method">
<dt class="sig sig-object py" id="qubic.xpol.Xpol.bin_spectra">
<span class="sig-name descname"><span class="pre">bin_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectra</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/xpol.html#Xpol.bin_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.xpol.Xpol.bin_spectra" title="Link to this definition"></a></dt>
<dd><p>Average spectra in bins specified by lmin, lmax and delta_ell,
weighted by <cite>l(l+1)</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qubic.xpol.Xpol.get_spectra">
<span class="sig-name descname"><span class="pre">get_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qubic/xpol.html#Xpol.get_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubic.xpol.Xpol.get_spectra" title="Link to this definition"></a></dt>
<dd><p>Return biased and Xpol-debiased estimations of the power spectra of
a Healpix map or of the cross-power spectra if <em>map2</em> is provided.</p>
<p>xpol = Xpol(mask, lmin, lmax, delta_ell)
biased, unbiased = xpol.get_spectra(map1, [map2])</p>
<p>The unbiased Cls are binned. The number of bins is given by
(lmax - lmin) // delta_ell, using the values specified in the Xpols
object initialisation. As a consequence, the upper bound of the highest
l bin may be less than lmax. The central value of the bins can be
obtained through the attribute <cite>xpol.ell_binned</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map1</strong> (<em>Nx3</em><em> or </em><em>3xN array</em>)  The I, Q, U Healpix maps.</p></li>
<li><p><strong>map2</strong> (<em>Nx3</em><em> or </em><em>3xN array</em><em>, </em><em>optional</em>)  The I, Q, U Healpix maps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>biased</strong> (<em>float array of shape (6, lmax+1)</em>)  The anafasts pseudo (cross-) power spectra for TT, EE, BB, TE, EB,
TB. The corresponding l values are given by <cite>np.arange(lmax + 1)</cite>.</p></li>
<li><p><strong>unbiased</strong> (<em>float array of shape (6, nbins)</em>)  The Xpols (cross-) power spectra for TT, EE, BB, TE, EB, TB.
The corresponding l values are given by <cite>xpol.ell_binned</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qubic">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-qubic" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, QUBIC Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>