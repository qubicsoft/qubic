<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>lib.QskySim module &#8212; qubicsoft  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-lib.QskySim">
<span id="lib-qskysim-module"></span><h1>lib.QskySim module<a class="headerlink" href="#module-lib.QskySim" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="lib.QskySim.Qubic_sky">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lib.QskySim.</span></span><span class="sig-name descname"><span class="pre">Qubic_sky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skyconfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'qubic_sky'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.Qubic_sky" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lib.QskySim.sky" title="lib.QskySim.sky"><code class="xref py py-class docutils literal notranslate"><span class="pre">sky</span></code></a></p>
<p>Define a sky object as seen by Qubic</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lib.QskySim.Qubic_sky.create_noise_maps" title="lib.QskySim.Qubic_sky.create_noise_maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_noise_maps</span></code></a>(sigma_sec, coverage[, ...])</p></td>
<td><p>This returns a realization of noise maps for I, Q and U with no correlation between them, according to a noise RMS map built according to the coverage specified as an attribute to the class The optional effective_variance_invcov keyword is a modification law to be applied to the coverage in order to obtain more realistic noise profile.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lib.QskySim.Qubic_sky.get_fullsky_convolved_maps" title="lib.QskySim.Qubic_sky.get_fullsky_convolved_maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fullsky_convolved_maps</span></code></a>([FWHMdeg, verbose])</p></td>
<td><p>This returns full sky maps at each subfrequency convolved by the beam of  the  instrument at each frequency or with another beam if FWHMdeg is provided.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lib.QskySim.Qubic_sky.get_partial_sky_maps_withnoise" title="lib.QskySim.Qubic_sky.get_partial_sky_maps_withnoise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_partial_sky_maps_withnoise</span></code></a>([coverage, ...])</p></td>
<td><p>This returns maps in the same way as with get_simple_sky_map but cut according to the coverage and with noise added according to this coverage and the RMS in muK.sqrt(sec) given by sigma_sec The default integration time is 4 years but can be modified with optional variable Nyears Note that the maps are convolved with the instrument beam by default, or with FWHMdeg (can be an array) if provided.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_simple_sky_map</span></code>()</p></td>
<td><p>Create as many skies as the number of input frequencies.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lib.QskySim.Qubic_sky.smoothing" title="lib.QskySim.Qubic_sky.smoothing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing</span></code></a>(maps, FWHMdeg, Nf, central_nus[, ...])</p></td>
<td><p>Convolve the maps to the FWHM at each sub-frequency or to a common beam if FWHMdeg is given.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lib.QskySim.Qubic_sky.theoretical_noise_maps" title="lib.QskySim.Qubic_sky.theoretical_noise_maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">theoretical_noise_maps</span></code></a>(sigma_sec, coverage)</p></td>
<td><p>This returns a map of the RMS noise (not an actual realization, just the expected RMS - No covariance)</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="lib.QskySim.Qubic_sky.create_noise_maps">
<span class="sig-name descname"><span class="pre">create_noise_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_sec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effective_variance_invcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_bands_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.Qubic_sky.create_noise_maps" title="Link to this definition">¶</a></dt>
<dd><p>This returns a realization of noise maps for I, Q and U with no correlation between them, according to a
noise RMS map built according to the coverage specified as an attribute to the class
The optional effective_variance_invcov keyword is a modification law to be applied to the coverage in order to obtain
more realistic noise profile. It is a law for effective RMS as a function of inverse coverage and is 2D array
with the first one being (nx samples) inverse coverage and the second being the corresponding effective variance to be
used through interpolation when generating the noise.
The clnoise option is used to apply a convolution to the noise to obtain spatially correlated noise. This cl should be
calculated from the c(theta) of the noise that can be measured using the function ctheta_parts() below. The transformation
of this C9theta) into Cl has to be done using wrappers on camb function found in camb_interface.py of the QUBIC software:
the functions to back and forth from ctheta to cl are: cl_2_ctheta and ctheta_2_cell. The simulation of the noise itself
calls a function of camb_interface called simulate_correlated_map().
:type sigma_sec: 
:param sigma_sec:
:type coverage: 
:param coverage:
:type Nyears: 
:param Nyears:
:type verbose: 
:param verbose:
:type seed: 
:param seed:
:type effective_variance_invcov: 
:param effective_variance_invcov:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lib.QskySim.Qubic_sky.get_fullsky_convolved_maps">
<span class="sig-name descname"><span class="pre">get_fullsky_convolved_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FWHMdeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.Qubic_sky.get_fullsky_convolved_maps" title="Link to this definition">¶</a></dt>
<dd><p>This returns full sky maps at each subfrequency convolved by the beam of  the  instrument at
each frequency or with another beam if FWHMdeg is provided.
when FWHMdeg is 0, the maps are not convolved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FWHMdeg</strong> (<em>float</em>)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lib.QskySim.Qubic_sky.get_partial_sky_maps_withnoise">
<span class="sig-name descname"><span class="pre">get_partial_sky_maps_withnoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_FastSim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FWHMdeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nunu_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrate_into_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_covcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.Qubic_sky.get_partial_sky_maps_withnoise" title="Link to this definition">¶</a></dt>
<dd><p>This returns maps in the same way as with get_simple_sky_map but cut according to the coverage
and with noise added according to this coverage and the RMS in muK.sqrt(sec) given by sigma_sec
The default integration time is 4 years but can be modified with optional variable Nyears
Note that the maps are convolved with the instrument beam by default, or with FWHMdeg (can be an array)
if provided.
If seed is provided, it will be used for the noise realization. If not it will be a new realization at
each call.
The optional effective_variance_invcov keyword is a modification law to be applied to the coverage in order to obtain
more realistic noise profile. It is a law for effective RMS as a function of inverse coverage and is 2D array
with the first one being (nx samples) inverse coverage and the second being the corresponding effective variance to be
used through interpolation when generating the noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coverage</strong> (<em>array</em>) – Coverage map of the sky.
By default, we load a coverage centered on the galactic center with 10000 pointings.</p></li>
<li><p><strong>version_FastSim</strong> (<em>str</em>) – Version of the FastSimulator files: 01, 02, 03… For now, only 01 exists.</p></li>
<li><p><strong>sigma_sec</strong> (<em>float</em>)</p></li>
<li><p><strong>Nyears</strong> (<em>float</em>) – Integration time for observation to scale the noise, by default it is 4.</p></li>
<li><p><strong>FWHMdeg</strong></p></li>
<li><p><strong>seed</strong></p></li>
<li><p><strong>noise_profile</strong></p></li>
<li><p><strong>spatial_noise</strong> (<em>bool</em>) – If True, spatial noise correlations are added. True by default.</p></li>
<li><p><strong>nunu_correlation</strong> (<em>bool</em>) – If True, correlations between frequency sub-bands are added. True by default.</p></li>
<li><p><strong>noise_only</strong> (<em>bool</em>) – If True, only returns the noise maps and the coverage (without the sky signal).</p></li>
<li><p><strong>integrate_into_band</strong> (<em>bool</em>) – If True, averaging input sub-band maps into reconstruction sub-bands. True by default.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>maps + noisemaps, maps, noisemaps, coverage</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lib.QskySim.Qubic_sky.smoothing">
<span class="sig-name descname"><span class="pre">smoothing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FWHMdeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_nus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.Qubic_sky.smoothing" title="Link to this definition">¶</a></dt>
<dd><p>Convolve the maps to the FWHM at each sub-frequency or to a common beam if FWHMdeg is given.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lib.QskySim.Qubic_sky.theoretical_noise_maps">
<span class="sig-name descname"><span class="pre">theoretical_noise_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_sec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.Qubic_sky.theoretical_noise_maps" title="Link to this definition">¶</a></dt>
<dd><p>This returns a map of the RMS noise (not an actual realization, just the expected RMS - No covariance)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_sec</strong> (<em>float</em>) – Noise level.</p></li>
<li><p><strong>coverage</strong> (<em>array</em>) – The coverage map.</p></li>
<li><p><strong>Nyears</strong> (<em>int</em>)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lib.QskySim.sky">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lib.QskySim.</span></span><span class="sig-name descname"><span class="pre">sky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skyconfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.sky" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Define a sky object as seen by an instrument.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lib.QskySim.sky.get_simple_sky_map" title="lib.QskySim.sky.get_simple_sky_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_simple_sky_map</span></code></a>()</p></td>
<td><p>Create as many skies as the number of input frequencies.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="lib.QskySim.sky.get_simple_sky_map">
<span class="sig-name descname"><span class="pre">get_simple_sky_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lib.QskySim.sky.get_simple_sky_map" title="Link to this definition">¶</a></dt>
<dd><p>Create as many skies as the number of input frequencies.
Instrumental effects are not considered.
Return a vector of shape (number_of_input_subfrequencies, npix, 3)</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">qubicsoft</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, QUBIC Collaboration.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/lib.QskySim.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>