---
jupyter:
  jupytext:
    formats: ipynb,Rmd
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.11.1
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import sys, os
import numpy as np
import matplotlib.pyplot as plt
```

```{python}
OUTDIR_LOCAL = "/home/simon/PycharmProjects/qubic_comp_sep/output/"
DATADIR_LOCAL = "/home/simon/PycharmProjects/qubic_comp_sep/data/"
```

```{python}
# Data for 400 years with different noise characteristics
outputs_400y = {}
outputs_400y['150_3_00'] = np.load("output/FgBuster_SingleBand150_Nsub3_Nyears400_spatialFalse_nunuFalse.npy")
outputs_400y['150_3_01'] = np.load("output/FgBuster_SingleBand150_Nsub3_Nyears400_spatialFalse_nunuTrue.npy")
outputs_400y['150_3_10'] = np.load("output/FgBuster_SingleBand150_Nsub3_Nyears400_spatialTrue_nunuFalse.npy")
outputs_400y['150_3_11'] = np.load("output/FgBuster_SingleBand150_Nsub3_Nyears400_spatialTrue_nunuTrue.npy")
outputs_400y['150_4_00'] = np.load("output/FgBuster_SingleBand150_Nsub4_Nyears400_spatialFalse_nunuFalse.npy")
outputs_400y['150_4_01'] = np.load("output/FgBuster_SingleBand150_Nsub4_Nyears400_spatialFalse_nunuTrue.npy")
outputs_400y['150_4_10'] = np.load("output/FgBuster_SingleBand150_Nsub4_Nyears400_spatialTrue_nunuFalse.npy")
outputs_400y['150_4_11'] = np.load("output/FgBuster_SingleBand150_Nsub4_Nyears400_spatialTrue_nunuTrue.npy")
outputs_400y['150_5_00'] = np.load("output/FgBuster_SingleBand150_Nsub5_Nyears400_spatialFalse_nunuFalse.npy")
outputs_400y['150_5_01'] = np.load("output/FgBuster_SingleBand150_Nsub5_Nyears400_spatialFalse_nunuTrue.npy")
outputs_400y['150_5_10'] = np.load("output/FgBuster_SingleBand150_Nsub5_Nyears400_spatialTrue_nunuFalse.npy")
outputs_400y['150_5_11'] = np.load("output/FgBuster_SingleBand150_Nsub5_Nyears400_spatialTrue_nunuTrue.npy")
outputs_400y['220_3_00'] = np.load("output/FgBuster_SingleBand220_Nsub3_Nyears400_spatialFalse_nunuFalse.npy")
outputs_400y['220_3_01'] = np.load("output/FgBuster_SingleBand220_Nsub3_Nyears400_spatialFalse_nunuTrue.npy")
outputs_400y['220_3_10'] = np.load("output/FgBuster_SingleBand220_Nsub3_Nyears400_spatialTrue_nunuFalse.npy")
outputs_400y['220_3_11'] = np.load("output/FgBuster_SingleBand220_Nsub3_Nyears400_spatialTrue_nunuTrue.npy")
outputs_400y['220_4_00'] = np.load("output/FgBuster_SingleBand220_Nsub4_Nyears400_spatialFalse_nunuFalse.npy")
outputs_400y['220_4_01'] = np.load("output/FgBuster_SingleBand220_Nsub4_Nyears400_spatialFalse_nunuTrue.npy")
outputs_400y['220_4_10'] = np.load("output/FgBuster_SingleBand220_Nsub4_Nyears400_spatialTrue_nunuFalse.npy")
outputs_400y['220_4_11'] = np.load("output/FgBuster_SingleBand220_Nsub4_Nyears400_spatialTrue_nunuTrue.npy")
outputs_400y['220_5_00'] = np.load("output/FgBuster_SingleBand220_Nsub5_Nyears400_spatialFalse_nunuFalse.npy")
outputs_400y['220_5_01'] = np.load("output/FgBuster_SingleBand220_Nsub5_Nyears400_spatialFalse_nunuTrue.npy")
outputs_400y['220_5_10'] = np.load("output/FgBuster_SingleBand220_Nsub5_Nyears400_spatialTrue_nunuFalse.npy")
outputs_400y['220_5_11'] = np.load("output/FgBuster_SingleBand220_Nsub5_Nyears400_spatialTrue_nunuTrue.npy")
```

```{python}
# 150 GHz results
fig, axes = plt.subplots(3, 4, figsize=(16, 10))
for i in range(3):
    for j in range(4):
        noise_properties = np.binary_repr(j, width=2)
        spatial = bool(int(noise_properties[0]))
        nunu = bool(int(noise_properties[1]))
        data = outputs_400y['150_'+str(i+3)+'_'+noise_properties]
        mean, std = np.mean(data), np.std(data)
        axe = axes[i, j]
        axe.hist(data, bins='auto', histtype='step', density=False)
        axe.axvline(x=mean, color='blue')
        axe.axvline(x=1.55, color='red')
        # axe.set_title("#bands = {} | (spatial, nunu) = ({}, {})".format(i+3, bool(spatial), bool(nunu)))

fig.suptitle("150 GHz histograms of fitted beta_dust for different noise properties", fontsize='xx-large')

axes[0, 0].text(-0.3, 0.5, "#bands = 3", transform=axes[0, 0].transAxes, fontsize=18, fontweight='bold', va='center', rotation=90)
axes[1, 0].text(-0.3, 0.5, "#bands = 4", transform=axes[1, 0].transAxes, fontsize=18, fontweight='bold', va='center', rotation=90)
axes[2, 0].text(-0.3, 0.5, "#bands = 5", transform=axes[2, 0].transAxes, fontsize=18, fontweight='bold', va='center', rotation=90)

axes[0, 0].text(0.5, 1.1, "white noise", transform=axes[0, 0].transAxes, fontsize=18, fontweight='bold', ha='center')
axes[0, 1].text(0.5, 1.1, "spatial correlations", transform=axes[0, 1].transAxes, fontsize=18, fontweight='bold', ha='center')
axes[0, 2].text(0.5, 1.1, "nunu correlations", transform=axes[0, 2].transAxes, fontsize=18, fontweight='bold', ha='center')
axes[0, 3].text(0.5, 1.1, "all correlations", transform=axes[0, 3].transAxes, fontsize=18, fontweight='bold', ha='center')

plt.show()
```

```{python}
# 220 GHz results
fig, axes = plt.subplots(3, 4, figsize=(16, 10))
for i in range(3):
    for j in range(4):
        data = outputs_400y['220_'+str(i+3)+'_'+np.binary_repr(j, width=2)]
        mean, std = np.mean(data), np.std(data)
        axe = axes[i, j]
        axe.hist(data, bins='auto', histtype='step', density=True)
        axe.axvline(x=mean, color='blue')
        axe.axvline(x=1.55, color='red')
        axe.set_xlim([1.30, 1.6])

fig.suptitle("220 GHz histograms of fitted beta_dust for different noise properties", fontsize='xx-large')

axes[0, 0].text(-0.3, 0.5, "#bands = 3", transform=axes[0, 0].transAxes, fontsize=18, fontweight='bold', va='center', rotation=90)
axes[1, 0].text(-0.3, 0.5, "#bands = 4", transform=axes[1, 0].transAxes, fontsize=18, fontweight='bold', va='center', rotation=90)
axes[2, 0].text(-0.3, 0.5, "#bands = 5", transform=axes[2, 0].transAxes, fontsize=18, fontweight='bold', va='center', rotation=90)

axes[0, 0].text(0.5, 1.1, "white noise", transform=axes[0, 0].transAxes, fontsize=18, fontweight='bold', ha='center')
axes[0, 1].text(0.5, 1.1, "spatial correlations", transform=axes[0, 1].transAxes, fontsize=18, fontweight='bold', ha='center')
axes[0, 2].text(0.5, 1.1, "nunu correlations", transform=axes[0, 2].transAxes, fontsize=18, fontweight='bold', ha='center')
axes[0, 3].text(0.5, 1.1, "all correlations", transform=axes[0, 3].transAxes, fontsize=18, fontweight='bold', ha='center')

plt.show()
```
